import{aT as S,r as Q,o as O,a0 as Y,y as V,z as D,A as o,j as e,P as R,R as M,B as l,aU as T,bw as Z,W as j,aV as W,aW as E,X as I,S as C,Y as N,H as c,C as m,aR as F,aZ as G,L as g,D as f,U as K,aS as L,x as H,v as X,c as J,bx as k,a1 as ee,by as h,aY as ae,bz as oe,bA as z,K as le,M as ne,_ as B,O as $}from"./index.40f7776e.js";import{Q as te,a as p}from"./QTable.2e86c172.js";import{Q as w}from"./QTooltip.7f204747.js";import{Q as se}from"./QTr.0f77265a.js";import{Q as ie}from"./QPagination.6f37d9fa.js";import{Q as re}from"./QPage.d47664ee.js";const de=l("div",{class:"q-px-sm dialog-name"},"\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD",-1),ue={class:"q-px-md"},ce={class:"q-px-sm"},me={__name:"DialogSelectZones",props:["zones"],emits:[...S.emits],setup(U,{emit:q}){const{dialogRef:_,onDialogOK:x,onDialogCancel:A}=S(),v=U,i=Q(null),n=Q([]),u=(y,r,d)=>{r(()=>{n.value=Y.value.filter(P=>P.name.indexOf(y)>-1)})};return O(()=>{n.value=Y.value,v.zones&&v.zones.length>0&&(i.value=v.zones)}),(y,r)=>(V(),D(K,{ref_key:"dialogRef",ref:_,persistent:""},{default:o(()=>[e(R,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"0.6rem"}},{default:o(()=>[e(M,null,{default:o(()=>[de]),_:1}),e(M,null,{default:o(()=>[l("div",ue,[e(T,{modelValue:i.value,"onUpdate:modelValue":r[1]||(r[1]=d=>i.value=d),options:n.value,filled:"",dense:"",multiple:"",label:"\uBC29\uC1A1\uC9C0\uC5ED\uC120\uD0DD","option-value":"deviceId","option-label":"name","use-chips":"","stack-label":"","use-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:u},Z({option:o(d=>[e(j,W(E(d.itemProps)),{default:o(()=>[e(I,{avatar:""},{default:o(()=>[e(C,{name:"storage"})]),_:1}),e(I,null,{default:o(()=>[e(N,null,{default:o(()=>[c(m(d.opt.name),1)]),_:2},1024),e(N,{caption:""},{default:o(()=>[c(m(d.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},[i.value?{name:"append",fn:o(()=>[e(C,{name:"cancel",size:"18px",onClick:r[0]||(r[0]=F(d=>i.value=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"])])]),_:1}),e(G,{align:"right"},{default:o(()=>[l("div",ce,[e(g,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:f(A)},null,8,["onClick"]),e(g,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:r[2]||(r[2]=d=>f(x)(i.value))})])]),_:1})]),_:1})]),_:1},512))}},fe={class:"borderd"},pe={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},ge={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},_e=l("div",{class:"font-main"},"\uC0AC\uC6A9\uC790 \uAD00\uB9AC",-1),ve={class:"row items-center q-gutter-x-xs"},we={style:{"font-size":"0.7rem"}},ye={style:{"font-size":"0.7rem"}},be={class:"row justify-center q-py-md",style:{position:"relative"}},ke={class:"row items-center q-px-md",style:{position:"absolute",right:"0",top:"1px","font-size":"0.8rem"}},he=l("span",null,"\uD398\uC774\uC9C0\uB2F9 \uD45C\uC2DC",-1),$e={__name:"UsersPage",setup(U){const{fnNotiWarn:q,fnNotiError:_}=L(),{fnUserInfo:x,fnDeleteUser:A}=H(),v=[{name:"email",label:"\uC774\uBA54\uC77C",align:"center",field:"email",sortable:!0},{name:"name",label:"\uC774\uB984",align:"center",field:"name",sortable:!0},{name:"isAdmin",label:"\uAD00\uB9AC\uC790",align:"center",field:"isAdmin",sortable:!0},{name:"em",label:"\uAE34\uAE09\uBC29\uC1A1",align:"center",field:"em",sortable:!0},{name:"zones",label:"\uC9C0\uC5ED",align:"center",field:"zones",sortable:!0},{name:"loginAt",label:"\uB9C8\uC9C0\uB9C9 \uB85C\uADF8\uC778",align:"center",field:"loginAt",sortable:!0},{name:"createdAt",label:"\uAC00\uC785\uC77C",align:"center",field:"createdAt",sortable:!0},{name:"actions",label:"\uC124\uC815",align:"center"}],i=Q(""),n=X(),u=Q({sortBy:"",descending:!1,page:1,rowsPerPage:10}),y=J(()=>k.value&&k.value.length>0?Math.ceil(k.value.length/u.value.rowsPerPage):1),r=t=>{if(t.email==="superuser@superuser.com")return q("\uCD5C\uACE0 \uAD00\uB9AC\uC790\uB294 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4");n.dialog({component:B,componentProps:{title:"\uAD00\uB9AC\uC790 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${t.email} \uAD00\uB9AC\uC790 \uAD8C\uD55C ${t.isAdmin?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await $.put("/users/admin",{...t}),await h()}catch{_("\uAD00\uB9AC\uC790 \uAD8C\uD55C \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4")}finally{n.loading.hide()}})},d=t=>{n.dialog({component:B,componentProps:{title:"\uAE34\uAE09\uBC29\uC1A1 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${t.email} \uAE34\uAE09\uBC29\uC1A1 \uAD8C\uD55C ${t.em?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await $.put("/users",{user:t,update:{em:!t.em}}),await h()}catch{_("\uAE34\uAE09\uBC29\uC1A1 \uAD8C\uD55C \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4")}finally{n.loading.hide()}})},P=t=>{n.dialog({component:me,componentProps:{zones:t.zones}}).onOk(async s=>{try{n.loading.show(),await $.put("/users",{user:t,update:{zones:s}}),await h()}catch{_("\uC9C0\uC5ED \uC124\uC815\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4")}finally{n.loading.hide()}})};return O(async()=>{n.loading.show(),await ee(),await h(),n.loading.hide()}),(t,s)=>(V(),D(re,{class:"page"},{default:o(()=>[l("div",fe,[l("div",pe,[l("div",ge,[e(C,{name:"group",color:"primary",size:"md"}),_e]),e(ae,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:o(()=>[e(C,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"])]),e(te,{columns:v,rows:f(k),filter:i.value,pagination:u.value,"onUpdate:pagination":s[1]||(s[1]=a=>u.value=a),"hide-pagination":"",flat:""},{body:o(a=>[e(se,{props:a},{default:o(()=>[e(p,{key:"email",props:a},{default:o(()=>[c(m(a.row.email),1)]),_:2},1032,["props"]),e(p,{key:"name",props:a},{default:o(()=>[c(m(a.row.name),1)]),_:2},1032,["props"]),e(p,{key:"isAdmin",props:a},{default:o(()=>[e(g,{round:"",flat:"",size:"sm",icon:a.row.isAdmin?"check_circle":"block",color:a.row.isAdmin?"primary":"red-10",onClick:b=>r(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[c(m(a.row.isAdmin?"\uC0AC\uC6A9\uC790":"\uAD00\uB9AC\uC790")+"\uB85C \uBCC0\uACBD",1)]),_:2},1024)]),_:2},1032,["icon","color","onClick"])]),_:2},1032,["props"]),e(p,{key:"em",props:a},{default:o(()=>[e(g,{round:"",flat:"",size:"sm",icon:a.row.em?"check_circle":"block",color:a.row.em?"primary":"red-10",onClick:b=>d(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[c(" '\uAE34\uAE09\uBC29\uC1A1' ")]),_:1})]),_:2},1032,["icon","color","onClick"])]),_:2},1032,["props"]),e(p,{key:"zones",props:a},{default:o(()=>[l("div",ve,[e(oe,{zones:a.row.zones},null,8,["zones"]),e(g,{round:"",flat:"",size:"sm",icon:"edit",color:"primary",onClick:b=>P(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[c("Zone \uC124\uC815")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"]),e(p,{key:"loginAt",props:a},{default:o(()=>[l("div",we,[l("div",null,m(f(z).formatDate(a.row.loginAt,"YYYY-MM-DD")),1),l("div",null,m(f(z).formatDate(a.row.loginAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(p,{key:"createdAt",props:a},{default:o(()=>[l("div",ye,[l("div",null,m(f(z).formatDate(a.row.createdAt,"YYYY-MM-DD")),1),l("div",null,m(f(z).formatDate(a.row.createdAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(p,{key:"actions",props:a},{default:o(()=>[l("div",null,[e(g,{flat:"",round:"",color:"primary",icon:"info",size:"sm",onClick:b=>f(x)(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[c("\uC0C1\uC138\uC815\uBCF4")]),_:1})]),_:2},1032,["onClick"]),a.row.email!=="superuser@superuser.com"?(V(),D(g,{key:0,flat:"",round:"",icon:"delete",color:"red-10",size:"sm",onClick:b=>f(A)(a.row)},{default:o(()=>[e(w,null,{default:o(()=>[c("\uC0AD\uC81C")]),_:1})]),_:2},1032,["onClick"])):le("",!0)])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter","pagination"]),e(ne),l("div",be,[e(ie,{modelValue:u.value.page,"onUpdate:modelValue":s[2]||(s[2]=a=>u.value.page=a),max:y.value,"max-pages":8,size:"12px",flat:"","active-design":"outline","direction-links":"","boundary-links":""},null,8,["modelValue","max"]),l("div",ke,[he,e(T,{style:{"font-size":"0.8rem"},borderless:"","item-aligned":"",dense:"","hide-bottom-space":"","map-options":"",modelValue:u.value.rowsPerPage,"onUpdate:modelValue":s[3]||(s[3]=a=>u.value.rowsPerPage=a),options:[5,10,15,20,25,30,40,50]},null,8,["modelValue"])])])])]),_:1}))}};export{$e as default};

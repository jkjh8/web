import{h as z,a1 as te,y as r,z as h,A as s,B as t,j as e,P as l,C as v,aO as ne,D as k,G as _,J as C,b0 as ie,r as Q,bP as le,aU as R,ay as A,o as O,bQ as L,N as U,O as x,aY as ce,I as f,bR as de,F as T,a$ as V,bS as D,az as Z,K as M,R as se,aZ as F,a_ as E,bT as ue,bU as me,bV as Y,bW as _e,v as oe,k as pe,c as fe,U as H,aQ as J,aR as X,V as j,W as ee,H as ve,bp as ge,aP as ye}from"./index.17e721b0.js";import{Q as he,a as we}from"./useFiles.5620be00.js";import{Q as xe}from"./QPage.442f4971.js";import{Q as N}from"./QTooltip.88a93751.js";import{Q as G}from"./QBadge.c6602fc1.js";import{u as ke}from"./useQsysFunc.daf5f93f.js";import{Q as B}from"./QSelect.2196a31a.js";import{_ as be,f as qe,a as Ce,D as Pe}from"./useZones.717a489f.js";import{u as K}from"./useNotify.f37af5e0.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import{u as $e}from"./usePlayer.d801ce40.js";import{u as Se}from"./useTts.37257a21.js";import"./position-engine.1e516b6f.js";import"./QSlideTransition.83d1541f.js";import"./DialogInput.a0a0beb7.js";import"./DialogConfirm.35f64ac2.js";import"./QMenu.cc4df5b2.js";import"./QTable.32483141.js";import"./QExpansionItem.e8bd9b9d.js";import"./QTr.f15a7489.js";import"./QBanner.3e5ecdb2.js";import"./useRules.779a940e.js";const ze=z("div",{class:"q-space"});var Qe=te({name:"QSpace",setup(){return()=>ze}});const Ie={class:"row fit items-center q-gutter-x-sm"},Me={style:{"font-size":"1rem","font-weight":"500"}},je={class:"text-grey-8"},Te={class:"row items-center q-gutter-x-sm text-grey-7"},Ve={__name:"statusTree",setup(n){const{fnBroadcastCancel:d}=ke(),u=c=>{let g=0;for(let a=0;a<c.length;a++)c[a].Active&&(g+=1);return g};return(c,g)=>(r(),h(he,{class:"custom-q-tree",nodes:k(ie),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":s(a=>[t("div",Ie,[e(l,{color:a.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),t("div",Me,v(a.node.name),1),e(Qe),t("div",je,v(u(a.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),u(a.node.ZoneStatus)?(r(),h(l,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:ne(o=>k(d)(a.node),["prevent","stop"])},{default:s(()=>[e(N,null,{default:s(()=>[_("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):C("",!0)])]),"default-header":s(a=>[t("div",Te,[t("div",null,[_(v(a.node.name?a.node.name:"no name")+" ",1),a.node.Active?(r(),h(G,{key:0,color:"green"},{default:s(()=>[_(" ONAIR ")]),_:1})):C("",!0)])])]),_:1},8,["nodes"]))}};Q("");const ae=n=>new Promise(async(d,u)=>{try{const c=await le(n);(await R.put("/broadcast/active",{devices:c.map(o=>({deviceId:o.deviceId,Zones:o.params.Zones}))})).data.active.length&&u("active");let{data:a}=await R.put("/broadcast/live",{...n,devices:c,zones:n.zones});d(a.idx)}catch(c){u(c)}});const re=n=>(F("data-v-01faf0df"),n=n(),E(),n),De={class:"q-dialog-plugin bg-trans broadcast-popup"},Ne={key:0},Be={class:"row justify-center q-pt-md text-grey"},Re={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ae={style:{"text-align":"right"}},Le=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Oe={style:{"text-align":"right"}},Ue=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Ze={class:"fit row justify-end"},Fe={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},Ee={__name:"DialogPageLive",props:["live"],emits:[...A.emits],setup(n,{emit:d}){const u=n,{dialogRef:c,onDialogCancel:g,onDialogOK:a}=A(),{fnNotiError:o}=K(),y=Q(!1),q=Q(0);let w=null;const $=Q(""),S=async()=>{L();try{$.value=await ae(u.live)}catch(p){if(p==="active")return console.log(p),o("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4.")}w=setInterval(()=>{q.value++},1e3),y.value=!0},P=async()=>{if($.value)try{await R.get("/broadcast/stop",{params:{idx:$.value}})}catch(p){console.error(p)}y.value=!1,clearInterval(w),w=null,q.value=0,setTimeout(()=>{a()},1e3)};return O(()=>{y.value=!1,L()}),(p,m)=>(r(),h(se,{ref_key:"dialogRef",ref:c,persistent:""},{default:s(()=>[t("div",De,[e(l,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red-13",size:"md",onClick:k(g)},{default:s(()=>[e(N,null,{default:s(()=>[_("Close")]),_:1})]),_:1},8,["onClick"]),e(U,{class:"transBG"},{default:s(()=>[e(x,null,{default:s(()=>[t("div",{class:ce(["q-pa-md row no-wrap text-grey-2",y.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[y.value?(r(),f("div",Ne,[e(de,{color:"primary",size:"14rem",thickness:8}),t("div",Be," \uBC29\uC1A1\uC911 "+v(q.value)+"\uCD08 \uACBD\uACFC ",1)])):C("",!0),t("div",Re,[t("div",Ae,[Le,t("div",null,v(n.live.Mode),1)]),t("div",Oe,[Ue,t("div",Ze,[(r(!0),f(T,null,V(n.live.zones,(i,I)=>(r(),h(G,{key:I,class:"q-ml-xs"},{default:s(()=>[_(v(i),1)]),_:2},1024))),128))])]),t("div",null,[(r(!0),f(T,null,V(k(D),(i,I)=>(r(),f("div",{key:I,style:{"text-align":"right"}},v(k(D)[I]),1))),128))])])],2)]),_:1}),e(Z,null,{default:s(()=>[t("div",Fe,[e(M,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:S},{default:s(()=>[_("\uC2DC\uC791")]),_:1}),e(M,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:P},{default:s(()=>[_("\uC911\uC9C0")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var Ge=W(Ee,[["__scopeId","data-v-01faf0df"]]);const Ke=[z("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),z("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[z("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),z("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[z("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var We=te({name:"QSpinnerClock",props:ue,setup(n){const{cSize:d,classes:u}=me(n);return()=>z("svg",{class:u.value,width:d.value,height:d.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Ke)}});const Ye=n=>(F("data-v-a84eee86"),n=n(),E(),n),He={class:"q-dialog-plugin bg-trans broadcast-popup"},Je={class:"row no-wrap justify-start items-center q-gutter-x-sm"},Xe=Ye(()=>t("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),et={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},tt={style:{"font-size":"2rem"}},st={class:"text-white description q-pa-md"},ot={class:"fit row no-wrap justify-center q-gutter-x-sm"},at={__name:"DialogPageMessage",props:["live"],setup(n){const d=n,u=new AbortController,{fnNotiError:c}=K(),{dialogRef:g,onDialogCancel:a,onDialogOK:o}=A(),y=Q(3),q=Q(!1);let w=null;const $=()=>{w&&clearInterval(w),u.abort(),a()},S=async()=>{try{await ae(d.live),o()}catch(P){P==="active"&&c("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),a()}};return O(async()=>{try{L(),Y({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${d.live.file.base}`}),await _e(d.live,u)}catch(P){console.error(P)}q.value=!0,Y({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),w=setInterval(async()=>{y.value>0?y.value-=1:(clearInterval(w),S())},1e3)}),(P,p)=>(r(),h(se,{ref_key:"dialogRef",ref:g,persistent:""},{default:s(()=>[t("div",He,[e(U,{class:"transBG"},{default:s(()=>[e(x,null,{default:s(()=>[t("div",Je,[e(l,{name:"mic",color:"primary",size:"md"}),Xe])]),_:1}),e(x,{style:{"min-height":"200px"}},{default:s(()=>[q.value?(r(),f("div",et,[e(We,{size:"md"}),t("span",tt,v(y.value),1)])):C("",!0),t("div",st,[(r(!0),f(T,null,V(k(D),(m,i)=>(r(),f("div",{key:i},v(k(D)[i]),1))),128))])]),_:1}),e(Z,null,{default:s(()=>[t("div",ot,[q.value?(r(),h(M,{key:0,style:{width:"8rem"},color:"primary",onClick:p[0]||(p[0]=m=>S())},{default:s(()=>[_("\uC2DC\uC791")]),_:1})):C("",!0),e(M,{style:{width:"8rem"},color:"red-10",onClick:$},{default:s(()=>[_("\uCDE8\uC18C")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var rt=W(at,[["__scopeId","data-v-a84eee86"]]);const b=n=>(F("data-v-5eefd08e"),n=n(),E(),n),nt={class:"q-pa-sm row justify-center"},it={class:"row no-wrap items-center q-gutter-x-xs"},lt=b(()=>t("div",null,"\uBC29\uC1A1\uBAA8\uB4DC",-1)),ct={class:"row no-wrap items-center q-gutter-x-sm"},dt=b(()=>t("div",null,"\uC6B0\uC120\uC21C\uC704",-1)),ut={class:"row no-wrap justify-between items-center"},mt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},_t=b(()=>t("div",null,"\uCC60\uC784",-1)),pt={class:"row no-wrap justify-between items-center"},ft={class:"row no-wrap items-center q-gutter-x-xs"},vt=b(()=>t("div",null,"\uBC29\uC1A1\uAD6C\uAC04",-1)),gt=b(()=>t("span",null," \uC120\uD0DD\uB41C \uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),yt=[gt],ht={class:"row no-wrap justify-start items-center q-gutter-x-sm"},wt=b(()=>t("div",null,"\uBC29\uC1A1\uC2DC\uAC04(\uCD08)",-1)),xt=b(()=>t("div",{class:"text-caption text-red",style:{"text-align":"right"}}," \uCD5C\uB300 \uBC29\uC1A1 \uC2DC\uAC04\uC740 4\uBD84(240\uCD08)\uC73C\uB85C \uC81C\uD55C \uB429\uB2C8\uB2E4. ",-1)),kt={class:"row no-wrap justify-between items-center"},bt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},qt=b(()=>t("div",null,"\uD30C\uC77C",-1)),Ct={key:0,class:"bg-grey-2 q-pa-sm q-gutter-x-sm row no-wrap justify-between items-center",style:{"border-radius":"2px","min-height":"40px"}},Pt={key:1,class:"bg-grey-2 q-pa-sm row justify-start items-center",style:{"border-radius":"2px",height:"40px"}},$t=b(()=>t("span",null," \uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),St=[$t],zt={class:"row no-wrap justify-between items-center"},Qt={class:"row no-wrap justify-between items-center q-gutter-x-xs"},It=b(()=>t("div",null,"TTS (Text to Speech)",-1)),Mt={class:"row no-wrap justify-between items-center"},jt={key:0,class:"row no-wrap justify-between items-center q-gutter-x-sm"},Tt={class:"full-width q-px-sm q-mb-md"},Vt={__name:"pageLive",setup(n){const{fnPlayStart:d,fnPlayerStopClose:u}=$e(),{fnNotiError:c}=K(),{fnDeleteFile:g}=Se(),a=oe(),o=pe({Mode:"message",Preamble:"",Priority:3,MaxPageTime:30,Station:1,Preamble:"",file:null,devices:[],zones:[]}),y=()=>{a.dialog({component:be,componentProps:{selected:o.devices}}).onOk(p=>{o.devices=p,o.zones=qe(p)})},q=()=>{a.dialog({component:Ce,componentProps:{file:o.file}}).onOk(p=>{o.file=p[0]})},w=()=>{a.dialog({component:Pe,componentProps:{file:o.file}}).onOk(p=>{o.file=p})},$=async()=>{await u(),await g(),o.file=null},S=fe({get(){return o.Preamble==="Chime ascending triple.wav"},set(){return o.Preamble?o.Preamble="":o.Preamble="Chime ascending triple.wav"}}),P=()=>{if(o.devices===null||o.devices.length===0)return c("\uBC29\uC1A1\uAD6C\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");if(o.Mode!=="live"&&(o.file===null||Object.keys(o.file).length===0))return c("\uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");o.Mode==="live"?a.dialog({component:Ge,componentProps:{live:o}}):a.dialog({component:rt,componentProps:{live:o}})};return(p,m)=>(r(),f("div",nt,[e(U,{flat:"",style:{width:"450px"}},{default:s(()=>[e(x,null,{default:s(()=>[t("div",it,[e(l,{name:"podcasts",color:"primary",size:"sm"}),lt]),e(B,{modelValue:o.Mode,"onUpdate:modelValue":m[0]||(m[0]=i=>o.Mode=i),options:[{value:"tts",label:"TTS",icon:"record_voice_over"},{value:"live",label:"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",icon:"live_tv"},{value:"message",label:"\uBA54\uC2DC\uC9C0 \uC1A1\uCD9C",icon:"message"}],dense:"",filled:"","map-options":"","emit-value":""},{option:s(i=>[e(H,J(X(i.itemProps)),{default:s(()=>[e(j,{avatar:""},{default:s(()=>[e(l,{name:i.opt.icon},null,8,["name"])]),_:2},1024),e(j,null,{default:s(()=>[e(ee,null,{default:s(()=>[_(v(i.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),k(ve).em?(r(),h(x,{key:0},{default:s(()=>[t("div",ct,[e(l,{name:"info",color:"lime-10",size:"sm"}),dt]),e(B,{modelValue:o.Priority,"onUpdate:modelValue":m[1]||(m[1]=i=>o.Priority=i),dense:"",filled:"",options:[{value:1,label:"\uAE34\uAE09\uBC29\uC1A1",icon:"priority_high"},{value:3,label:"\uC77C\uBC18\uBC29\uC1A1",icon:"low_priority"}],"emit-value":"","map-options":""},{option:s(i=>[e(H,J(X(i.itemProps)),{default:s(()=>[e(j,{avatar:""},{default:s(()=>[e(l,{name:i.opt.icon},null,8,["name"])]),_:2},1024),e(j,null,{default:s(()=>[e(ee,null,{default:s(()=>[_(v(i.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})):C("",!0),e(x,null,{default:s(()=>[t("div",ut,[t("div",mt,[e(l,{name:"notifications_none",color:"green-10",size:"sm"}),_t]),e(ge,{modelValue:S.value,"onUpdate:modelValue":m[2]||(m[2]=i=>S.value=i)},null,8,["modelValue"])])]),_:1}),e(x,{class:"q-gutter-y-sm"},{default:s(()=>[t("div",pt,[t("div",ft,[e(l,{name:"location_on",color:"primary",size:"sm"}),vt]),e(l,{class:"cursor-pointer q-mr-xs",name:"add_circle",color:"primary",size:"sm",onClick:y},{default:s(()=>[e(N,null,{default:s(()=>[_("\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD")]),_:1})]),_:1})]),o.zones&&o.zones.length?(r(),f("div",{key:0,class:"panel cursor-pointer q-py-sm q-px-sm q-gutter-x-sm row justify-start items-center",onClick:y},[(r(!0),f(T,null,V(o.zones,(i,I)=>(r(),h(G,{key:I},{default:s(()=>[_(v(i),1)]),_:2},1024))),128))])):(r(),f("div",{key:1,class:"panel cursor-pointer q-pa-sm row justify-start items-center",onClick:y},yt))]),_:1}),o.Mode==="live"?(r(),h(x,{key:1,class:"q-gutter-y-sm"},{default:s(()=>[t("div",ht,[e(l,{name:"timer",color:"pink-8",size:"sm"}),wt]),e(B,{modelValue:o.MaxPageTime,"onUpdate:modelValue":m[3]||(m[3]=i=>o.MaxPageTime=i),dense:"",filled:"",options:[30,60,90,120,150,180,210,240]},null,8,["modelValue"]),xt]),_:1})):C("",!0),o.Mode==="message"?(r(),h(x,{key:2,class:"q-gutter-y-sm"},{default:s(()=>[t("div",kt,[t("div",bt,[e(l,{name:"save",color:"primary",size:"sm"}),qt]),e(l,{class:"cursor-pointer",name:"add_circle",color:"primary",size:"sm",onClick:q})]),o.file?(r(),f("div",Ct,[t("div",null,[e(l,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"xs",onClick:m[4]||(m[4]=i=>k(d)(o.file))}),_(" "+v(o.file.base),1)]),e(l,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:m[5]||(m[5]=i=>o.file=null)})])):(r(),f("div",Pt,St))]),_:1})):C("",!0),o.Mode==="tts"?(r(),h(x,{key:3,class:"q-gutter-y-sm"},{default:s(()=>[t("div",zt,[t("div",Qt,[e(l,{name:"volume_up",color:"primary",size:"sm"}),It]),e(l,{class:"cursor-pointer",color:"primary",name:"mic",size:"sm",onClick:w},{default:s(()=>[e(N,null,{default:s(()=>[_("\uC74C\uC131\uD569\uC131")]),_:1})]),_:1})]),t("div",Mt,[o.file?(r(),f("div",jt,[t("div",null,[e(l,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"sm",onClick:m[6]||(m[6]=i=>k(d)(o.file))}),_(" "+v(o.file.base),1)]),e(l,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:$})])):(r(),f("div",{key:1,class:"bg-grey-2 q-pa-sm row justify-between items-center cursor-pointer",style:{"border-radius":"2px",height:"40px",width:"100%"},onClick:w},[t("div",null,[e(l,{name:"warning"}),_(" \uD569\uC131\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ")])]))])]),_:1})):C("",!0),e(Z,null,{default:s(()=>[t("div",Tt,[e(M,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:P})])]),_:1})]),_:1})]))}};var Dt=W(Vt,[["__scopeId","data-v-5eefd08e"]]);const Nt={class:"borderd"},Bt={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},Rt={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},At=t("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),Lt={class:"q-pa-xs"},ds={__name:"LivePage",setup(n){const d=oe(),u=Q(40);return O(async()=>{d.loading.show(),await ye(),d.loading.hide()}),(c,g)=>(r(),h(xe,{class:"page"},{default:s(()=>[t("div",Nt,[t("div",Bt,[t("div",Rt,[e(l,{name:"mic",color:"primary",size:"md"}),At])]),t("div",null,[e(we,{modelValue:u.value,"onUpdate:modelValue":g[0]||(g[0]=a=>u.value=a)},{before:s(()=>[t("div",Lt,[e(Ve)])]),after:s(()=>[e(Dt)]),_:1},8,["modelValue"])])])]),_:1}))}};export{ds as default};

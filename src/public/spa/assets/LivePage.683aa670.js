import{b5 as ce,y as o,z as h,A as a,B as t,j as e,R as c,C as f,aT as de,D as k,H as m,K as z,b8 as ue,aV as D,aU as U,r as P,o as Z,b$ as R,O as F,P as C,b7 as me,J as _,c0 as _e,F as N,b6 as B,c1 as A,a$ as E,L as j,S as le,c2 as ie,N as pe,b9 as G,ba as K,h as I,a9 as fe,c3 as ve,c4 as ge,c5 as Y,c6 as ye,bo as he,v as ne,k as we,c as H,aW as J,V as ee,aX as te,aY as se,W as V,X as ae,I as oe,aZ as xe,a_ as be,c7 as ke,a5 as qe,a1 as Ce}from"./index.d405afc6.js";import{Q as Pe,a as $e}from"./QTree.336bfa5c.js";import{Q as Se}from"./QPage.81bbcb10.js";import{Q as ze,_ as Me,a as Qe,D as Ie,b as Te}from"./DialogTtsVoiceware.fabd75be.js";import{Q as L}from"./QTooltip.258af5f1.js";import{Q as W}from"./QBadge.af73f51f.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{f as O}from"./useFiles.d3b63c00.js";import{u as je}from"./usePlayer.266497df.js";import"./QSlideTransition.7c8fb144.js";import"./QTable.e1c851b6.js";import"./QExpansionItem.b4581611.js";import"./QTr.eae43d47.js";import"./QBanner.b1906076.js";import"./QCircularProgress.8c826060.js";const Ve={class:"row fit items-center q-gutter-x-sm"},De={style:{"font-size":"1rem","font-weight":"500"}},Ne={class:"text-grey-8"},Be={class:"row items-center q-gutter-x-sm text-grey-7"},Ae={__name:"statusTree",setup(r){const{fnBroadcastCancel:w}=ce(),d=p=>{let v=0;for(let l=0;l<p.length;l++)p[l].Active&&(v+=1);return v};return(p,v)=>(o(),h(Pe,{class:"custom-q-tree",nodes:k(ue),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":a(l=>[t("div",Ve,[e(c,{color:l.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),t("div",De,f(l.node.name),1),e(ze),t("div",Ne,f(d(l.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),d(l.node.ZoneStatus)?(o(),h(c,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:de(s=>k(w)(l.node),["prevent","stop"])},{default:a(()=>[e(L,null,{default:a(()=>[m("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):z("",!0)])]),"default-header":a(l=>[t("div",Be,[t("div",null,[m(f(l.node.name?l.node.name:"no name")+" ",1),l.node.Active?(o(),h(W,{key:0,color:"green"},{default:a(()=>[m(" ONAIR ")]),_:1})):z("",!0)])])]),_:1},8,["nodes"]))}};const re=r=>(G("data-v-06dea602"),r=r(),K(),r),Le={class:"q-dialog-plugin bg-trans broadcast-popup"},Oe={key:0},Re={class:"row justify-center q-pt-md text-grey"},Ue={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ze={style:{"text-align":"right"}},Fe=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Ee={style:{"text-align":"right"}},Ge=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Ke={class:"fit row justify-end"},We={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},Xe={__name:"DialogPageLive",props:["live"],emits:[...D.emits],setup(r,{emit:w}){const d=r,{dialogRef:p,onDialogCancel:v,onDialogOK:l}=D(),{fnNotiError:s}=U(),q=P(!1),g=P(!1),x=P(0);let y=null;const S=P(""),b=P(!1),T=async()=>{b.value=!0,g.value=!0,R();try{S.value=await ie(d.live)}catch(i){if(g.value=!1,i==="active"&&d.live.Priority!==1)return s("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),v()}g.value=!1,y=setInterval(()=>{x.value++,x.value>d.live.MaxPageTime&&(clearInterval(y),l())},1e3),q.value=!0},u=async()=>{if(S.value)try{await pe.get("/broadcast/stop",{params:{idx:S.value}})}catch(i){console.error(i)}q.value=!1,clearInterval(y),y=null,x.value=0,setTimeout(()=>{l()},1e3)};return Z(()=>{b.value=!1,q.value=!1,R()}),(i,n)=>(o(),h(le,{ref_key:"dialogRef",ref:p,persistent:""},{default:a(()=>[t("div",Le,[e(c,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red-13",size:"md",onClick:k(v)},{default:a(()=>[e(L,null,{default:a(()=>[m("Close")]),_:1})]),_:1},8,["onClick"]),e(F,{class:"transBG"},{default:a(()=>[e(C,null,{default:a(()=>[t("div",{class:me(["q-pa-md row no-wrap text-grey-2",q.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[q.value?(o(),_("div",Oe,[e(_e,{color:"primary",size:"14rem",thickness:8}),t("div",Re," \uBC29\uC1A1\uC911 "+f(x.value)+"\uCD08 \uACBD\uACFC ",1)])):z("",!0),t("div",Ue,[t("div",Ze,[Fe,t("div",null,f(r.live.Mode),1)]),t("div",Ee,[Ge,t("div",Ke,[(o(!0),_(N,null,B(r.live.zones,(Q,M)=>(o(),h(W,{key:M,class:"q-ml-xs"},{default:a(()=>[m(f(Q),1)]),_:2},1024))),128))])]),t("div",null,[(o(!0),_(N,null,B(k(A),(Q,M)=>(o(),_("div",{key:M,style:{"text-align":"right"}},f(k(A)[M]),1))),128))])])],2)]),_:1}),e(E,null,{default:a(()=>[t("div",We,[e(j,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:T,disabled:b.value},{default:a(()=>[m("\uC2DC\uC791")]),_:1},8,["disabled"]),e(j,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:u,disabled:g.value},{default:a(()=>[m("\uC911\uC9C0")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var Ye=X(Xe,[["__scopeId","data-v-06dea602"]]);const He=[I("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),I("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[I("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),I("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[I("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var Je=fe({name:"QSpinnerClock",props:ve,setup(r){const{cSize:w,classes:d}=ge(r);return()=>I("svg",{class:d.value,width:w.value,height:w.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},He)}});const et=r=>(G("data-v-e1737596"),r=r(),K(),r),tt={class:"q-dialog-plugin bg-trans broadcast-popup"},st={class:"row no-wrap justify-start items-center q-gutter-x-sm"},at=et(()=>t("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),ot={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},lt={style:{"font-size":"2rem"}},it={class:"text-white description q-pa-md"},nt={class:"fit row no-wrap justify-center q-gutter-x-sm"},rt={__name:"DialogPageMessage",props:["live"],emits:[...D.emits],setup(r,{emit:w}){const d=r,p=new AbortController,{fnNotiError:v}=U(),{dialogRef:l,onDialogCancel:s,onDialogOK:q}=D(),g=P(3),x=P(!1);let y=null;const S=P(!1),b=P(!1),T=()=>{y&&clearInterval(y),p.abort(),s()},u=async()=>{try{g.value=0,clearInterval(y),S.value=!0,b.value=!0,await ie(d.live),q()}catch(i){b.value=!1,i==="active"&&d.live.Priority!==1&&v("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),s()}};return Z(async()=>{try{S.value=!1,b.value=!1,R(),Y({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${d.live.file.base}`}),await ye(d.live,p)}catch(i){console.error(i)}x.value=!0,Y({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),y=setInterval(async()=>{g.value>0?g.value-=1:(clearInterval(y),u())},1e3)}),(i,n)=>(o(),h(le,{ref_key:"dialogRef",ref:l,persistent:""},{default:a(()=>[t("div",tt,[e(F,{class:"transBG"},{default:a(()=>[e(C,null,{default:a(()=>[t("div",st,[e(c,{name:"mic",color:"primary",size:"md"}),at])]),_:1}),e(C,{style:{"min-height":"200px"}},{default:a(()=>[x.value?(o(),_("div",ot,[e(Je,{size:"md"}),t("span",lt,f(g.value),1)])):z("",!0),t("div",it,[(o(!0),_(N,null,B(k(A),(Q,M)=>(o(),_("div",{key:M},f(k(A)[M]),1))),128))])]),_:1}),e(E,null,{default:a(()=>[t("div",nt,[x.value?(o(),h(j,{key:0,style:{width:"8rem"},color:"primary",disabled:S.value,onClick:n[0]||(n[0]=Q=>u())},{default:a(()=>[m("\uC2DC\uC791")]),_:1},8,["disabled"])):z("",!0),e(j,{style:{width:"8rem"},color:"red-10",disabled:b.value,onClick:T},{default:a(()=>[m("\uCDE8\uC18C")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var ct=X(rt,[["__scopeId","data-v-e1737596"]]);const $=r=>(G("data-v-757127f0"),r=r(),K(),r),dt={class:"q-pa-sm row justify-center"},ut={class:"row no-wrap items-center q-gutter-x-xs"},mt=$(()=>t("div",null,"\uBC29\uC1A1\uBAA8\uB4DC",-1)),_t={class:"row no-wrap items-center q-gutter-x-sm"},pt=$(()=>t("div",null,"\uC6B0\uC120\uC21C\uC704",-1)),ft={class:"row no-wrap justify-between items-center"},vt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},gt=$(()=>t("div",null,"\uCC60\uC784",-1)),yt={class:"row no-wrap justify-between items-center"},ht={class:"row no-wrap items-center q-gutter-x-xs"},wt=$(()=>t("div",null,"\uBC29\uC1A1\uAD6C\uAC04",-1)),xt=$(()=>t("span",null," \uC120\uD0DD\uB41C \uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),bt=[xt],kt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},qt=$(()=>t("div",null,"\uBC29\uC1A1\uC2DC\uAC04(\uBD84)",-1)),Ct=$(()=>t("div",{class:"text-caption text-red",style:{"text-align":"right"}}," \uBC29\uC1A1\uC2DC\uAC04\uC740 \uCD5C\uB300 60\uBD84\uC785\uB2C8\uB2E4. ",-1)),Pt={class:"row no-wrap justify-between items-center"},$t={class:"row no-wrap justify-start items-center q-gutter-x-sm"},St=$(()=>t("div",null,"\uD30C\uC77C",-1)),zt={key:0,class:"bg-grey-3 q-pa-sm q-gutter-x-sm row no-wrap justify-between items-center",style:{"border-radius":"2px","min-height":"40px"}},Mt=$(()=>t("span",null," \uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),Qt=[Mt],It={class:"row no-wrap justify-between items-center"},Tt={class:"row no-wrap justify-between items-center q-gutter-x-xs"},jt=$(()=>t("div",null,"TTS (Text to Speech)",-1)),Vt={class:"row no-wrap justify-between items-center"},Dt={key:0,class:"row no-wrap justify-between items-center q-gutter-x-sm"},Nt={class:"full-width q-px-sm q-mb-md"},Bt={__name:"pageLive",setup(r){const{fnPlayStart:w,fnPlayerStopClose:d}=je(),{fnNotiError:p}=U(),{fnDeleteFile:v}=he(),l=ne(),s=we({Mode:"tts",Preamble:"",Priority:3,MaxPageTime:60,Station:1,Preamble:"",file:null,devices:[],zones:[],retry:0,MessageDelete:!0}),q=H({get(){return s.MaxPageTime/60},set(u){s.MaxPageTime=u*60}}),g=()=>{l.dialog({component:Me,componentProps:{selected:s.devices}}).onOk(async u=>{s.devices=u,s.zones=await ke(u)})},x=()=>{l.dialog({component:Qe,componentProps:{file:s.file}}).onOk(async u=>{s.file=u[0],s.MaxPageTime=await O(u[0].fullpath)})},y=()=>{qe.ttsMode==="sapi"?l.dialog({component:Ie,componentProps:{file:s.file}}).onOk(async u=>{s.file=u,s.MaxPageTime=await O(selected[0].fullpath)}):l.dialog({component:Te,componentProps:{file:s.file}}).onOk(async u=>{s.file=u,s.MaxPageTime=await O(selected[0].fullpath)})},S=async()=>{await d(),await v(),s.file=null},b=H({get(){return s.Preamble==="Chime ascending triple.wav"},set(){return s.Preamble?s.Preamble="":s.Preamble="Chime ascending triple.wav"}}),T=()=>{if(s.devices===null||s.devices.length===0)return p("\uBC29\uC1A1\uAD6C\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");if(s.Mode!=="live"&&(s.file===null||Object.keys(s.file).length===0))return p("\uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");s.Mode==="live"?l.dialog({component:Ye,componentProps:{live:s}}):l.dialog({component:ct,componentProps:{live:s}})};return(u,i)=>(o(),_("div",dt,[e(F,{flat:"",style:{width:"450px"}},{default:a(()=>[e(C,null,{default:a(()=>[t("div",ut,[e(c,{name:"podcasts",color:"primary",size:"sm"}),mt]),e(J,{modelValue:s.Mode,"onUpdate:modelValue":i[0]||(i[0]=n=>s.Mode=n),options:[{value:"tts",label:"TTS",icon:"record_voice_over"},{value:"message",label:"\uBA54\uC2DC\uC9C0 \uC1A1\uCD9C",icon:"message"},{value:"live",label:"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",icon:"live_tv"}],dense:"",filled:"","map-options":"","emit-value":""},{option:a(n=>[e(ee,te(se(n.itemProps)),{default:a(()=>[e(V,{avatar:""},{default:a(()=>[e(c,{name:n.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:a(()=>[e(ae,null,{default:a(()=>[m(f(n.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),k(oe).em||k(oe).isAdmin?(o(),h(C,{key:0},{default:a(()=>[t("div",_t,[e(c,{name:"info",color:"lime-10",size:"sm"}),pt]),e(J,{modelValue:s.Priority,"onUpdate:modelValue":i[1]||(i[1]=n=>s.Priority=n),dense:"",filled:"",options:[{value:1,label:"\uAE34\uAE09\uBC29\uC1A1",icon:"priority_high"},{value:3,label:"\uC77C\uBC18\uBC29\uC1A1",icon:"low_priority"}],"emit-value":"","map-options":""},{option:a(n=>[e(ee,te(se(n.itemProps)),{default:a(()=>[e(V,{avatar:""},{default:a(()=>[e(c,{name:n.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:a(()=>[e(ae,null,{default:a(()=>[m(f(n.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})):z("",!0),e(C,null,{default:a(()=>[t("div",ft,[t("div",vt,[e(c,{name:"notifications_none",color:"green-10",size:"sm"}),gt]),e(xe,{modelValue:b.value,"onUpdate:modelValue":i[2]||(i[2]=n=>b.value=n)},null,8,["modelValue"])])]),_:1}),e(C,{class:"q-gutter-y-sm"},{default:a(()=>[t("div",yt,[t("div",ht,[e(c,{name:"location_on",color:"primary",size:"sm"}),wt]),e(c,{class:"cursor-pointer q-mr-xs",name:"add_circle",color:"primary",size:"sm",onClick:g},{default:a(()=>[e(L,null,{default:a(()=>[m("\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD")]),_:1})]),_:1})]),s.zones&&s.zones.length?(o(),_("div",{key:0,class:"panel cursor-pointer q-py-sm q-px-sm q-gutter-x-sm row justify-start items-center",onClick:g},[(o(!0),_(N,null,B(s.zones,(n,Q)=>(o(),h(W,{key:Q},{default:a(()=>[m(f(n),1)]),_:2},1024))),128))])):(o(),_("div",{key:1,class:"panel cursor-pointer q-pa-sm row justify-start items-center",onClick:g},bt))]),_:1}),s.Mode==="live"?(o(),h(C,{key:1,class:"q-gutter-y-sm"},{default:a(()=>[t("div",kt,[e(c,{name:"timer",color:"pink-8",size:"sm"}),qt]),e(be,{modelValue:q.value,"onUpdate:modelValue":i[3]||(i[3]=n=>q.value=n),type:"number",filled:"",dense:"",label:"\uBC29\uC1A1\uC2DC\uAC04\uC81C\uD55C",min:"1",max:"60"},null,8,["modelValue"]),Ct]),_:1})):z("",!0),s.Mode==="message"?(o(),h(C,{key:2,class:"q-gutter-y-sm"},{default:a(()=>[t("div",Pt,[t("div",$t,[e(c,{name:"save",color:"primary",size:"sm"}),St]),e(c,{class:"cursor-pointer",name:"add_circle",color:"primary",size:"sm",onClick:x})]),s.file?(o(),_("div",zt,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"xs",onClick:i[4]||(i[4]=n=>k(w)(s.file))}),m(" "+f(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:i[5]||(i[5]=n=>s.file=null)})])):(o(),_("div",{key:1,class:"bg-grey-3 q-pa-sm row justify-start items-center",style:{"border-radius":"2px",height:"40px"},onClick:x},Qt))]),_:1})):z("",!0),s.Mode==="tts"?(o(),h(C,{key:3,class:"q-gutter-y-sm"},{default:a(()=>[t("div",It,[t("div",Tt,[e(c,{name:"volume_up",color:"primary",size:"sm"}),jt]),e(c,{class:"cursor-pointer",color:"primary",name:"mic",size:"sm",onClick:y},{default:a(()=>[e(L,null,{default:a(()=>[m("\uC74C\uC131\uD569\uC131")]),_:1})]),_:1})]),t("div",Vt,[s.file?(o(),_("div",Dt,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"sm",onClick:i[6]||(i[6]=n=>k(w)(s.file))}),m(" "+f(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:S})])):(o(),_("div",{key:1,class:"bg-grey-3 q-pa-sm row justify-between items-center cursor-pointer",style:{"border-radius":"2px",height:"40px",width:"100%"},onClick:y},[t("div",null,[e(c,{name:"warning"}),m(" \uD569\uC131\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ")])]))])]),_:1})):z("",!0),e(E,null,{default:a(()=>[t("div",Nt,[e(j,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:T})])]),_:1})]),_:1})]))}};var At=X(Bt,[["__scopeId","data-v-757127f0"]]);const Lt={class:"borderd"},Ot={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},Rt={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},Ut=t("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),Zt={class:"q-pa-xs"},is={__name:"LivePage",setup(r){const w=ne(),d=P(40);return Z(async()=>{w.loading.show(),await Ce(),w.loading.hide()}),(p,v)=>(o(),h(Se,{class:"page"},{default:a(()=>[t("div",Lt,[t("div",Ot,[t("div",Rt,[e(c,{name:"mic",color:"primary",size:"md"}),Ut])]),t("div",null,[e($e,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=l=>d.value=l)},{before:a(()=>[t("div",Zt,[e(Ae)])]),after:a(()=>[e(At)]),_:1},8,["modelValue"])])])]),_:1}))}};export{is as default};

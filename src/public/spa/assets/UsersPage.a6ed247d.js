import{ay as V,r as Q,o as O,bw as S,C,D as z,E as a,j as e,S as M,U as Y,G as l,bx as T,Y as G,aQ as R,aR as Z,Z as B,V as v,_ as I,K as d,H as m,aO as j,az as E,O as g,I as s,W as F,B as K,A as W,aP as H,N,aS as L,by as J,b6 as h,aU as k}from"./index.7f82ef12.js";import{Q as w}from"./QTooltip.65407910.js";import{Q as X,a as f}from"./QTable.c9fa95b5.js";import{Q as ee}from"./QTr.2b1ed518.js";import{Q as ae}from"./QPage.8aa1073f.js";import{u as oe}from"./useNotify.28e4b240.js";import{u as ne,b as te,d as le}from"./useBackup.48aa4072.js";import{Q as se}from"./QSelect.0930110b.js";import{_ as P}from"./DialogConfirm.54f0009e.js";import"./position-engine.9158a117.js";import"./QMenu.c6a52b6e.js";var ie=[{name:"email",label:"\uC774\uBA54\uC77C",align:"center",field:"email",sortable:!0},{name:"name",label:"\uC774\uB984",align:"center",field:"name",sortable:!0},{name:"isAdmin",label:"\uAD00\uB9AC\uC790",align:"center",field:"isAdmin",sortable:!0},{name:"em",label:"\uAE34\uAE09\uBC29\uC1A1",align:"center",field:"em",sortable:!0},{name:"zones",label:"\uC9C0\uC5ED",align:"center",field:"zones",sortable:!0},{name:"loginAt",label:"\uB9C8\uC9C0\uB9C9 \uB85C\uADF8\uC778",align:"center",field:"loginAt",sortable:!0},{name:"createdAt",label:"\uAC00\uC785\uC77C",align:"center",field:"createdAt",sortable:!0},{name:"actions",label:"\uC124\uC815",align:"center"}];const re=l("div",{class:"q-px-sm dialog-name"},"\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD",-1),ce={class:"q-px-md"},de={class:"q-px-sm"},ue={__name:"DialogSelectZones",props:["zones"],emits:[...V.emits],setup(U,{emit:q}){const{dialogRef:A,onDialogOK:$,onDialogCancel:x}=V(),p=U,u=Q(null),n=Q([]),D=(y,i,r)=>{i(()=>{n.value=S.value.filter(_=>_.name.indexOf(y)>-1)})};return O(()=>{n.value=S.value,p.zones&&p.zones.length>0&&(u.value=p.zones)}),(y,i)=>(C(),z(F,{ref_key:"dialogRef",ref:A,persistent:""},{default:a(()=>[e(M,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"0.6rem"}},{default:a(()=>[e(Y,null,{default:a(()=>[re]),_:1}),e(Y,null,{default:a(()=>[l("div",ce,[e(se,{modelValue:u.value,"onUpdate:modelValue":i[1]||(i[1]=r=>u.value=r),options:n.value,filled:"",dense:"",multiple:"",label:"\uBC29\uC1A1\uC9C0\uC5ED\uC120\uD0DD","option-value":"deviceId","option-label":"name","use-chips":"","stack-label":"","use-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:D},T({option:a(r=>[e(G,R(Z(r.itemProps)),{default:a(()=>[e(B,{avatar:""},{default:a(()=>[e(v,{name:"storage"})]),_:1}),e(B,null,{default:a(()=>[e(I,null,{default:a(()=>[d(m(r.opt.name),1)]),_:2},1024),e(I,{caption:""},{default:a(()=>[d(m(r.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},[u.value?{name:"append",fn:a(()=>[e(v,{name:"cancel",size:"18px",onClick:i[0]||(i[0]=j(r=>u.value=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"])])]),_:1}),e(E,{align:"right"},{default:a(()=>[l("div",de,[e(g,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:s(x)},null,8,["onClick"]),e(g,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:i[2]||(i[2]=r=>s($)(u.value))})])]),_:1})]),_:1})]),_:1},512))}},me={class:"borderd"},fe={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},pe={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},_e=l("div",{class:"font-main"},"\uC0AC\uC6A9\uC790 \uAD00\uB9AC",-1),ge={class:"row items-center q-gutter-x-xs"},we={style:{"font-size":"0.7rem"}},ke={style:{"font-size":"0.7rem"}},Pe={__name:"UsersPage",setup(U){const{fnNotiWarn:q}=oe(),{fnUserInfo:A}=K(),{fnGetBackupSettings:$,fnUserBackup:x}=ne(),p=Q(""),u=Q([]),n=W(),D=t=>{if(t.email==="superuser@superuser.com")return q("\uCD5C\uACE0 \uAD00\uB9AC\uC790\uB294 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4");n.dialog({component:P,componentProps:{title:"\uAD00\uB9AC\uC790 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${t.email} \uAD00\uB9AC\uC790 \uAD8C\uD55C ${t.isAdmin?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await k.put("/users/admin",{...t}),await _(),n.loading.hide()}catch(c){n.loading.hide(),console.error(c)}})},y=t=>{n.dialog({component:P,componentProps:{title:"\uAE34\uAE09\uBC29\uC1A1 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${t.email} \uAE34\uAE09\uBC29\uC1A1 \uAD8C\uD55C ${t.em?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await k.put("/users",{user:t,update:{em:!t.em}}),await _(),n.loading.hide()}catch(c){n.loading.hide(),console.error(c)}})},i=async t=>{n.dialog({component:P,componentProps:{title:"\uC0AC\uC6A9\uC790 \uC0AD\uC81C",icon:"error",iconColor:"red-10",message:`${t.email} \uC0AC\uC6A9\uC790\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await k.delete("/users",{data:{...t}}),await _(),n.loading.hide()}catch(c){n.loading.hide(),console.error(c)}})},r=t=>{n.dialog({component:ue,componentProps:{zones:t.zones}}).onOk(async c=>{try{n.loading.show(),await k.put("/users",{user:t,update:{zones:c}}),await _(),n.loading.hide()}catch(o){n.loading.hide(),console.error(o)}})},_=async()=>{const t=await k.get("/users");u.value=t.data.users};return O(async()=>{n.loading.show(),await H(),await _(),await $(),n.loading.hide()}),(t,c)=>(C(),z(ae,{class:"page"},{default:a(()=>[l("div",me,[l("div",fe,[l("div",pe,[e(v,{name:"group",color:"primary",size:"md"}),_e,s(te)==="Normal"&&s(le)?(C(),z(v,{key:0,class:"cursor-pointer q-mx-md",name:"backup",color:"blue-grey",size:"xs",onClick:s(x)},{default:a(()=>[e(w,null,{default:a(()=>[d("\uC0AC\uC6A9\uC790 \uBC31\uC5C5")]),_:1})]),_:1},8,["onClick"])):N("",!0)]),e(L,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=o=>p.value=o),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:a(()=>[e(v,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"])]),e(X,{columns:s(ie),rows:u.value,filter:p.value,pagination:{rowsPerPage:10}},{body:a(o=>[e(ee,{props:o},{default:a(()=>[e(f,{key:"email",props:o},{default:a(()=>[d(m(o.row.email),1)]),_:2},1032,["props"]),e(f,{key:"name",props:o},{default:a(()=>[d(m(o.row.name),1)]),_:2},1032,["props"]),e(f,{key:"isAdmin",props:o},{default:a(()=>[e(g,{round:"",flat:"",size:"sm",icon:o.row.isAdmin?"check_circle":"block",color:o.row.isAdmin?"primary":"red-10",onClick:b=>D(o.row)},{default:a(()=>[e(w,null,{default:a(()=>[d(m(o.row.isAdmin?"\uC0AC\uC6A9\uC790":"\uAD00\uB9AC\uC790")+"\uB85C \uBCC0\uACBD",1)]),_:2},1024)]),_:2},1032,["icon","color","onClick"])]),_:2},1032,["props"]),e(f,{key:"em",props:o},{default:a(()=>[e(g,{round:"",flat:"",size:"sm",icon:o.row.em?"check_circle":"block",color:o.row.em?"primary":"red-10",onClick:b=>y(o.row)},{default:a(()=>[e(w,null,{default:a(()=>[d(" '\uAE34\uAE09\uBC29\uC1A1' ")]),_:1})]),_:2},1032,["icon","color","onClick"])]),_:2},1032,["props"]),e(f,{key:"zones",props:o},{default:a(()=>[l("div",ge,[e(J,{zones:o.row.zones},null,8,["zones"]),e(g,{round:"",flat:"",size:"sm",icon:"edit",color:"primary",onClick:b=>r(o.row)},{default:a(()=>[e(w,null,{default:a(()=>[d("Zone \uC124\uC815")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"]),e(f,{key:"loginAt",props:o},{default:a(()=>[l("div",we,[l("div",null,m(s(h).formatDate(o.row.loginAt,"YYYY-MM-DD")),1),l("div",null,m(s(h).formatDate(o.row.loginAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(f,{key:"createdAt",props:o},{default:a(()=>[l("div",ke,[l("div",null,m(s(h).formatDate(o.row.createdAt,"YYYY-MM-DD")),1),l("div",null,m(s(h).formatDate(o.row.createdAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(f,{key:"actions",props:o},{default:a(()=>[l("div",null,[e(g,{flat:"",round:"",color:"primary",icon:"info",size:"sm",onClick:b=>s(A)(o.row)},{default:a(()=>[e(w,null,{default:a(()=>[d("\uC0C1\uC138\uC815\uBCF4")]),_:1})]),_:2},1032,["onClick"]),o.row.email!=="superuser@superuser.com"?(C(),z(g,{key:0,flat:"",round:"",icon:"delete",color:"red-10",size:"sm",onClick:b=>i(o.row)},{default:a(()=>[e(w,null,{default:a(()=>[d("\uC0AD\uC81C")]),_:1})]),_:2},1032,["onClick"])):N("",!0)])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter"])])]),_:1}))}};export{Pe as default};

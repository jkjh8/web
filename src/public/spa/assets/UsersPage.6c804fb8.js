import{aD as U,r as C,o as O,bP as V,y,z as h,A as a,j as e,N as T,O as N,B as l,bU as G,U as R,aL as Z,aM as F,V as P,R as v,W as B,G as u,C as m,aX as K,aE as L,K as _,D as i,P as j,x as E,v as W,aK as J,J as M,aN as X,bV as H,b2 as b,aQ as k}from"./index.a5e6215c.js";import{Q as g}from"./QTooltip.cc5706de.js";import{Q as ee,b as p}from"./QTd.d4b766ed.js";import{Q as ae}from"./QTr.4c513818.js";import{Q as oe}from"./QPage.e687fd29.js";import{u as ne}from"./useNotify.6007da9b.js";import{u as te,b as S,c as Y}from"./useBackup.05e517fc.js";import{Q as le}from"./QSelect.1c9d1a69.js";import{_ as I}from"./DialogConfirm.d0b71129.js";import"./QMenu.9922ec6a.js";import"./QLinearProgress.8cf9234b.js";var se=[{name:"email",label:"E-mail",align:"center",field:"email",sortable:!0},{name:"name",label:"Name",align:"center",field:"name",sortable:!0},{name:"isAdmin",label:"isAdmin",align:"center",field:"isAdmin",sortable:!0},{name:"zones",label:"Zones",align:"center",field:"zones",sortable:!0},{name:"loginAt",label:"Last login",align:"center",field:"loginAt",sortable:!0},{name:"createdAt",label:"Created at",align:"center",field:"createdAt",sortable:!0},{name:"actions",label:"FN",align:"center"}];const ie=l("div",{class:"q-px-sm dialog-name"},"\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD",-1),re={class:"q-px-md"},de={class:"q-px-sm"},ce={__name:"DialogSelectZones",props:["zones"],emits:[...U.emits],setup($,{emit:q}){const{dialogRef:z,onDialogOK:Q,onDialogCancel:A}=U(),f=$,d=C(null),n=C([]),x=(w,r,s)=>{r(()=>{n.value=V.value.filter(t=>t.name.indexOf(w)>-1)})};return O(()=>{n.value=V.value,f.zones&&f.zones.length>0&&(d.value=f.zones)}),(w,r)=>(y(),h(j,{ref_key:"dialogRef",ref:z,persistent:""},{default:a(()=>[e(T,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"0.6rem"}},{default:a(()=>[e(N,null,{default:a(()=>[ie]),_:1}),e(N,null,{default:a(()=>[l("div",re,[e(le,{modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=s=>d.value=s),options:n.value,filled:"",dense:"",multiple:"",label:"\uBC29\uC1A1\uC9C0\uC5ED\uC120\uD0DD","option-value":"deviceId","option-label":"name","use-chips":"","stack-label":"","use-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:x},G({option:a(s=>[e(R,Z(F(s.itemProps)),{default:a(()=>[e(P,{avatar:""},{default:a(()=>[e(v,{name:"storage"})]),_:1}),e(P,null,{default:a(()=>[e(B,null,{default:a(()=>[u(m(s.opt.name),1)]),_:2},1024),e(B,{caption:""},{default:a(()=>[u(m(s.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},[d.value?{name:"append",fn:a(()=>[e(v,{name:"cancel",size:"18px",onClick:r[0]||(r[0]=K(s=>d.value=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"])])]),_:1}),e(L,{align:"right"},{default:a(()=>[l("div",de,[e(_,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:i(A)},null,8,["onClick"]),e(_,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:r[2]||(r[2]=s=>i(Q)(d.value))})])]),_:1})]),_:1})]),_:1},512))}},ue={class:"borderd"},me={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},fe={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},pe=l("div",{class:"font-main"},"\uC0AC\uC6A9\uC790 \uAD00\uB9AC",-1),_e={class:"row items-center q-gutter-x-xs"},ge={style:{"font-size":"0.7rem"}},ve={style:{"font-size":"0.7rem"}},$e={__name:"UsersPage",setup($){const{fnNotiWarn:q}=ne(),{fnUserInfo:z}=E(),{fnGetBackupSettings:Q,fnUserBackup:A}=te(),f=C(""),d=C([]),n=W(),x=t=>{if(t.email==="superuser@superuser.com")return q("\uCD5C\uACE0 \uAD00\uB9AC\uC790\uB294 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4");n.dialog({component:I,componentProps:{title:"\uAD00\uB9AC\uC790 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${t.email} \uAD00\uB9AC\uC790 \uAD8C\uD55C ${t.isAdmin?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await k.put("/users/admin",{...t}),await s(),n.loading.hide()}catch(c){n.loading.hide(),console.error(c)}})},w=async t=>{n.dialog({component:I,componentProps:{title:"\uC0AC\uC6A9\uC790 \uC0AD\uC81C",icon:"error",iconColor:"red-10",message:`${t.email} \uC0AC\uC6A9\uC790\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await k.delete("/users",{data:{...t}}),await s(),n.loading.hide()}catch(c){n.loading.hide(),console.error(c)}})},r=t=>{n.dialog({component:ce,componentProps:{zones:t.zones}}).onOk(async c=>{try{n.loading.show(),await k.put("/users",{user:t,update:{zones:c}}),await s(),n.loading.hide()}catch(o){n.loading.hide(),console.error(o)}console.log(c)})},s=async()=>{const t=await k.get("/users");d.value=t.data.users};return O(async()=>{n.loading.show(),await J(),await s(),await Q(),console.log(S.value,Y.value),n.loading.hide()}),(t,c)=>(y(),h(oe,{class:"page"},{default:a(()=>[l("div",ue,[l("div",me,[l("div",fe,[e(v,{name:"group",color:"primary",size:"md"}),pe,i(S)==="Normal"&&i(Y)?(y(),h(v,{key:0,class:"cursor-pointer q-mx-md",name:"backup",color:"blue-grey",size:"xs",onClick:i(A)},{default:a(()=>[e(g,null,{default:a(()=>[u("\uC0AC\uC6A9\uC790 \uBC31\uC5C5")]),_:1})]),_:1},8,["onClick"])):M("",!0)]),e(X,{modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=o=>f.value=o),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:a(()=>[e(v,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"])]),e(ee,{columns:i(se),rows:d.value,filter:f.value},{body:a(o=>[e(ae,{props:o},{default:a(()=>[e(p,{key:"email",props:o},{default:a(()=>[u(m(o.row.email),1)]),_:2},1032,["props"]),e(p,{key:"name",props:o},{default:a(()=>[u(m(o.row.name),1)]),_:2},1032,["props"]),e(p,{key:"isAdmin",props:o},{default:a(()=>[e(_,{round:"",flat:"",size:"sm",icon:o.row.isAdmin?"check_circle":"block",color:o.row.isAdmin?"primary":"red-10",onClick:D=>x(o.row)},{default:a(()=>[e(g,null,{default:a(()=>[u(m(o.row.isAdmin?"\uC0AC\uC6A9\uC790":"\uAD00\uB9AC\uC790")+"\uB85C \uBCC0\uACBD",1)]),_:2},1024)]),_:2},1032,["icon","color","onClick"])]),_:2},1032,["props"]),e(p,{key:"zones",props:o},{default:a(()=>[l("div",_e,[e(H,{zones:o.row.zones},null,8,["zones"]),e(_,{round:"",flat:"",size:"sm",icon:"edit",color:"primary",onClick:D=>r(o.row)},{default:a(()=>[e(g,null,{default:a(()=>[u("Zone \uC124\uC815")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"]),e(p,{key:"loginAt",props:o},{default:a(()=>[l("div",ge,[l("div",null,m(i(b).formatDate(o.row.loginAt,"YYYY-MM-DD")),1),l("div",null,m(i(b).formatDate(o.row.loginAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(p,{key:"createdAt",props:o},{default:a(()=>[l("div",ve,[l("div",null,m(i(b).formatDate(o.row.createdAt,"YYYY-MM-DD")),1),l("div",null,m(i(b).formatDate(o.row.createdAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),e(p,{key:"actions",props:o},{default:a(()=>[l("div",null,[e(_,{flat:"",round:"",color:"primary",icon:"info",size:"sm",onClick:D=>i(z)(o.row)},{default:a(()=>[e(g,null,{default:a(()=>[u("\uC0C1\uC138\uC815\uBCF4")]),_:1})]),_:2},1032,["onClick"]),o.row.email!=="superuser@superuser.com"?(y(),h(_,{key:0,flat:"",round:"",icon:"delete",color:"red-10",size:"sm",onClick:D=>w(o.row)},{default:a(()=>[e(g,null,{default:a(()=>[u("\uC0AD\uC81C")]),_:1})]),_:2},1032,["onClick"])):M("",!0)])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter"])])]),_:1}))}};export{$e as default};

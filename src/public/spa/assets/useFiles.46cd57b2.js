import{aE as Ze,aN as ve,a5 as et,bX as tt,aK as be,bY as Se,aJ as Ne,bk as ge,as as Ae,aL as ze,ax as me,u as xe,v as Re,x as Oe,r as P,c as E,w as _e,n as Xe,h as y,y as Ee,bZ as lt,ag as at,g as we,l as rt,bm as it,bR as qe,V as Be,bp as nt,p as ot,b5 as ut,bF as Le,i as st,a7 as Ke,b_ as Ye,br as dt,b$ as je,aa as ct,m as ft,f as vt,bE as ht,O as ee,c0 as pt,bD as gt,ay as mt,A as He,C as te,D as le,E as V,j as W,I as Ue,bo as _t,G as pe,K as se,N as de,H as $e,P as yt,W as bt,k as Ft,aU as ae}from"./index.14c31bf1.js";import{e as kt}from"./position-engine.841fa4ba.js";import{Q as qt}from"./QSlideTransition.a26240f2.js";import{_ as Me}from"./DialogInput.aa9738f1.js";import{Q as ce}from"./QTooltip.64dc46fc.js";import{Q as xt}from"./usePlayer.d24327ee.js";import{_ as wt}from"./DialogConfirm.9f7f99ed.js";const De={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Ct=Object.keys(De);De.all=!0;function Qe(e){const n={};for(const o of Ct)e[o]===!0&&(n[o]=!0);return Object.keys(n).length===0?De:(n.horizontal===!0?n.left=n.right=!0:n.left===!0&&n.right===!0&&(n.horizontal=!0),n.vertical===!0?n.up=n.down=!0:n.up===!0&&n.down===!0&&(n.vertical=!0),n.horizontal===!0&&n.vertical===!0&&(n.all=!0),n)}const St=["INPUT","TEXTAREA"];function Ie(e,n){return n.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof n.handler=="function"&&St.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(n.uid)===-1)}function Te(e,n,o){const s=Ae(e);let t,i=s.left-n.event.x,g=s.top-n.event.y,h=Math.abs(i),f=Math.abs(g);const p=n.direction;p.horizontal===!0&&p.vertical!==!0?t=i<0?"left":"right":p.horizontal!==!0&&p.vertical===!0?t=g<0?"up":"down":p.up===!0&&g<0?(t="up",h>f&&(p.left===!0&&i<0?t="left":p.right===!0&&i>0&&(t="right"))):p.down===!0&&g>0?(t="down",h>f&&(p.left===!0&&i<0?t="left":p.right===!0&&i>0&&(t="right"))):p.left===!0&&i<0?(t="left",h<f&&(p.up===!0&&g<0?t="up":p.down===!0&&g>0&&(t="down"))):p.right===!0&&i>0&&(t="right",h<f&&(p.up===!0&&g<0?t="up":p.down===!0&&g>0&&(t="down")));let w=!1;if(t===void 0&&o===!1){if(n.event.isFirst===!0||n.event.lastDir===void 0)return{};t=n.event.lastDir,w=!0,t==="left"||t==="right"?(s.left-=i,h=0,i=0):(s.top-=g,f=0,g=0)}return{synthetic:w,payload:{evt:e,touch:n.event.mouse!==!0,mouse:n.event.mouse===!0,position:s,direction:t,isFirst:n.event.isFirst,isFinal:o===!0,duration:Date.now()-n.event.time,distance:{x:h,y:f},offset:{x:i,y:g},delta:{x:s.left-n.event.lastX,y:s.top-n.event.lastY}}}}let zt=0;var Et=Ze({name:"touch-pan",beforeMount(e,{value:n,modifiers:o}){if(o.mouse!==!0&&ve.has.touch!==!0)return;function s(i,g){o.mouse===!0&&g===!0?me(i):(o.stop===!0&&ge(i),o.prevent===!0&&Ne(i))}const t={uid:"qvtp_"+zt++,handler:n,modifiers:o,direction:Qe(o),noop:et,mouseStart(i){Ie(i,t)&&tt(i)&&(be(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(i,!0))},touchStart(i){if(Ie(i,t)){const g=i.target;be(t,"temp",[[g,"touchmove","move","notPassiveCapture"],[g,"touchcancel","end","passiveCapture"],[g,"touchend","end","passiveCapture"]]),t.start(i)}},start(i,g){if(ve.is.firefox===!0&&Se(e,!0),t.lastEvt=i,g===!0||o.stop===!0){if(t.direction.all!==!0&&(g!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const p=i.type.indexOf("mouse")!==-1?new MouseEvent(i.type,i):new TouchEvent(i.type,i);i.defaultPrevented===!0&&Ne(p),i.cancelBubble===!0&&ge(p),Object.assign(p,{qKeyEvent:i.qKeyEvent,qClickOutside:i.qClickOutside,qAnchorHandled:i.qAnchorHandled,qClonedBy:i.qClonedBy===void 0?[t.uid]:i.qClonedBy.concat(t.uid)}),t.initialEvent={target:i.target,event:p}}ge(i)}const{left:h,top:f}=Ae(i);t.event={x:h,y:f,time:Date.now(),mouse:g===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:h,lastY:f}},move(i){if(t.event===void 0)return;const g=Ae(i),h=g.left-t.event.x,f=g.top-t.event.y;if(h===0&&f===0)return;t.lastEvt=i;const p=t.event.mouse===!0,w=()=>{s(i,p);let A;o.preserveCursor!==!0&&o.preservecursor!==!0&&(A=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),p===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),kt(),t.styleCleanup=a=>{if(t.styleCleanup=void 0,A!==void 0&&(document.documentElement.style.cursor=A),document.body.classList.remove("non-selectable"),p===!0){const C=()=>{document.body.classList.remove("no-pointer-events--children")};a!==void 0?setTimeout(()=>{C(),a()},50):C()}else a!==void 0&&a()}};if(t.event.detected===!0){t.event.isFirst!==!0&&s(i,t.event.mouse);const{payload:A,synthetic:a}=Te(i,t,!1);A!==void 0&&(t.handler(A)===!1?t.end(i):(t.styleCleanup===void 0&&t.event.isFirst===!0&&w(),t.event.lastX=A.position.left,t.event.lastY=A.position.top,t.event.lastDir=a===!0?void 0:A.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||p===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){w(),t.event.detected=!0,t.move(i);return}const R=Math.abs(h),O=Math.abs(f);R!==O&&(t.direction.horizontal===!0&&R>O||t.direction.vertical===!0&&R<O||t.direction.up===!0&&R<O&&f<0||t.direction.down===!0&&R<O&&f>0||t.direction.left===!0&&R>O&&h<0||t.direction.right===!0&&R>O&&h>0?(t.event.detected=!0,t.move(i)):t.end(i,!0))},end(i,g){if(t.event!==void 0){if(ze(t,"temp"),ve.is.firefox===!0&&Se(e,!1),g===!0)t.styleCleanup!==void 0&&t.styleCleanup(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(Te(i===void 0?t.lastEvt:i,t).payload);const{payload:h}=Te(i===void 0?t.lastEvt:i,t,!0),f=()=>{t.handler(h)};t.styleCleanup!==void 0?t.styleCleanup(f):f()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(e.__qtouchpan=t,o.mouse===!0){const i=o.mouseCapture===!0||o.mousecapture===!0?"Capture":"";be(t,"main",[[e,"mousedown","mouseStart",`passive${i}`]])}ve.has.touch===!0&&be(t,"main",[[e,"touchstart","touchStart",`passive${o.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,n){const o=e.__qtouchpan;o!==void 0&&(n.oldValue!==n.value&&(typeof value!="function"&&o.end(),o.handler=n.value),o.direction=Qe(n.modifiers))},beforeUnmount(e){const n=e.__qtouchpan;n!==void 0&&(n.event!==void 0&&n.end(),ze(n,"main"),ze(n,"temp"),ve.is.firefox===!0&&Se(e,!1),n.styleCleanup!==void 0&&n.styleCleanup(),delete e.__qtouchpan)}}),al=xe({name:"QSplitter",props:{...Re,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:n,emit:o}){const{proxy:{$q:s}}=we(),t=Oe(e,s),i=P(null),g={before:P(null),after:P(null)},h=E(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(t.value===!0?" q-splitter--dark":"")),f=E(()=>e.horizontal===!0?"height":"width"),p=E(()=>e.reverse!==!0?"before":"after"),w=E(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function R(T){return(e.unit==="%"?T:Math.round(T))+e.unit}const O=E(()=>({[p.value]:{[f.value]:R(e.modelValue)}}));let A,a,C,$,m;function d(T){if(T.isFirst===!0){const S=i.value.getBoundingClientRect()[f.value];A=e.horizontal===!0?"up":"left",a=e.unit==="%"?100:S,C=Math.min(a,w.value[1],Math.max(w.value[0],e.modelValue)),$=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:s.lang.rtl===!0?-1:1)*(e.unit==="%"?S===0?0:100/S:1),i.value.classList.add("q-splitter--active");return}if(T.isFinal===!0){m!==e.modelValue&&o("update:modelValue",m),i.value.classList.remove("q-splitter--active");return}const F=C+$*(T.direction===A?-1:1)*T.distance[e.horizontal===!0?"y":"x"];m=Math.min(a,w.value[1],Math.max(w.value[0],F)),g[p.value].value.style[f.value]=R(m),e.emitImmediately===!0&&e.modelValue!==m&&o("update:modelValue",m)}const N=E(()=>[[Et,d,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function X(T,F){T<F[0]?o("update:modelValue",F[0]):T>F[1]&&o("update:modelValue",F[1])}return _e(()=>e.modelValue,T=>{X(T,w.value)}),_e(()=>e.limits,()=>{Xe(()=>{X(e.modelValue,w.value)})}),()=>{const T=[y("div",{ref:g.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:O.value.before},Ee(n.before)),y("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[lt("div",{class:"q-splitter__separator-area absolute-full"},Ee(n.separator),"sep",e.disable!==!0,()=>N.value)]),y("div",{ref:g.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:O.value.after},Ee(n.after))];return y("div",{class:h.value,ref:i},at(n.default,T))}}});const Ut=["none","strict","leaf","leaf-filtered"];var rl=xe({name:"QTree",props:{...Re,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Ut.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:n,emit:o}){const{proxy:s}=we(),{$q:t}=s,i=Oe(e,t),g=P({}),h=P(e.ticked||[]),f=P(e.expanded||[]);let p={};rt(()=>{p={}});const w=E(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(i.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),R=E(()=>e.selected!==void 0),O=E(()=>e.icon||t.iconSet.tree.icon),A=E(()=>e.controlColor||e.color),a=E(()=>e.textColor!==void 0?` text-${e.textColor}`:""),C=E(()=>{const r=e.selectedColor||e.color;return r?` text-${r}`:""}),$=E(()=>e.filterMethod!==void 0?e.filterMethod:(r,c)=>{const l=c.toLowerCase();return r[e.labelKey]&&r[e.labelKey].toLowerCase().indexOf(l)!==-1}),m=E(()=>{const r={},c=(l,b)=>{const v=l.tickStrategy||(b?b.tickStrategy:e.tickStrategy),z=l[e.nodeKey],U=l[e.childrenKey]&&Array.isArray(l[e.childrenKey])&&l[e.childrenKey].length!==0,u=l.disabled!==!0&&R.value===!0&&l.selectable!==!1,_=l.disabled!==!0&&l.expandable!==!1,K=v!=="none",I=v==="strict",j=v==="leaf-filtered",oe=v==="leaf"||v==="leaf-filtered";let Ce=l.disabled!==!0&&l.tickable!==!1;oe===!0&&Ce===!0&&b&&b.tickable!==!0&&(Ce=!1);let ue=l.lazy;ue===!0&&g.value[z]!==void 0&&Array.isArray(l[e.childrenKey])===!0&&(ue=g.value[z]);const x={key:z,parent:b,isParent:U,lazy:ue,disabled:l.disabled,link:l.disabled!==!0&&(u===!0||_===!0&&(U===!0||ue===!0)),children:[],matchesFilter:e.filter?$.value(l,e.filter):!0,selected:z===e.selected&&u===!0,selectable:u,expanded:U===!0?f.value.includes(z):!1,expandable:_,noTick:l.noTick===!0||I!==!0&&ue&&ue!=="loaded",tickable:Ce,tickStrategy:v,hasTicking:K,strictTicking:I,leafFilteredTicking:j,leafTicking:oe,ticked:I===!0?h.value.includes(z):U===!0?!1:h.value.includes(z)};if(r[z]=x,U===!0&&(x.children=l[e.childrenKey].map(D=>c(D,x)),e.filter&&(x.matchesFilter!==!0?x.matchesFilter=x.children.some(D=>D.matchesFilter):x.noTick!==!0&&x.disabled!==!0&&x.tickable===!0&&j===!0&&x.children.every(D=>D.matchesFilter!==!0||D.noTick===!0||D.tickable!==!0)===!0&&(x.tickable=!1)),x.matchesFilter===!0&&(x.noTick!==!0&&I!==!0&&x.children.every(D=>D.noTick)===!0&&(x.noTick=!0),oe))){if(x.ticked=!1,x.indeterminate=x.children.some(D=>D.indeterminate===!0),x.tickable=x.tickable===!0&&x.children.some(D=>D.tickable),x.indeterminate!==!0){const D=x.children.reduce((Pe,Je)=>Je.ticked===!0?Pe+1:Pe,0);D===x.children.length?x.ticked=!0:D>0&&(x.indeterminate=!0)}x.indeterminate===!0&&(x.indeterminateNextState=x.children.every(D=>D.tickable!==!0||D.ticked!==!0))}return x};return e.nodes.forEach(l=>c(l,null)),r});_e(()=>e.ticked,r=>{h.value=r}),_e(()=>e.expanded,r=>{f.value=r});function d(r){const c=[].reduce,l=(b,v)=>{if(b||!v)return b;if(Array.isArray(v)===!0)return c.call(Object(v),l,b);if(v[e.nodeKey]===r)return v;if(v[e.childrenKey])return l(null,v[e.childrenKey])};return l(null,e.nodes)}function N(){return h.value.map(r=>d(r))}function X(){return f.value.map(r=>d(r))}function T(r){return r&&m.value[r]?m.value[r].expanded:!1}function F(){e.expanded!==void 0?o("update:expanded",[]):f.value=[]}function S(){const r=[],c=l=>{l[e.childrenKey]&&l[e.childrenKey].length!==0&&l.expandable!==!1&&l.disabled!==!0&&(r.push(l[e.nodeKey]),l[e.childrenKey].forEach(c))};e.nodes.forEach(c),e.expanded!==void 0?o("update:expanded",r):f.value=r}function M(r,c,l=d(r),b=m.value[r]){if(b.lazy&&b.lazy!=="loaded"){if(b.lazy==="loading")return;g.value[r]="loading",Array.isArray(l[e.childrenKey])!==!0&&(l[e.childrenKey]=[]),o("lazyLoad",{node:l,key:r,done:v=>{g.value[r]="loaded",l[e.childrenKey]=Array.isArray(v)===!0?v:[],Xe(()=>{const z=m.value[r];z&&z.isParent===!0&&q(r,!0)})},fail:()=>{delete g.value[r],l[e.childrenKey].length===0&&delete l[e.childrenKey]}})}else b.isParent===!0&&b.expandable===!0&&q(r,c)}function q(r,c){let l=f.value;const b=e.expanded!==void 0;if(b===!0&&(l=l.slice()),c){if(e.accordion&&m.value[r]){const v=[];m.value[r].parent?m.value[r].parent.children.forEach(z=>{z.key!==r&&z.expandable===!0&&v.push(z.key)}):e.nodes.forEach(z=>{const U=z[e.nodeKey];U!==r&&v.push(U)}),v.length!==0&&(l=l.filter(z=>v.includes(z)===!1))}l=l.concat([r]).filter((v,z,U)=>U.indexOf(v)===z)}else l=l.filter(v=>v!==r);b===!0?o("update:expanded",l):f.value=l}function B(r){return r&&m.value[r]?m.value[r].ticked:!1}function Q(r,c){let l=h.value;const b=e.ticked!==void 0;b===!0&&(l=l.slice()),c?l=l.concat(r).filter((v,z,U)=>U.indexOf(v)===z):l=l.filter(v=>r.includes(v)===!1),b===!0&&o("update:ticked",l)}function k(r,c,l){const b={tree:s,node:r,key:l,color:e.color,dark:i.value};return Le(b,"expanded",()=>c.expanded,v=>{v!==c.expanded&&M(l,v)}),Le(b,"ticked",()=>c.ticked,v=>{v!==c.ticked&&Q([l],v)}),b}function H(r){return(e.filter?r.filter(c=>m.value[c[e.nodeKey]].matchesFilter):r).map(c=>re(c))}function J(r){if(r.icon!==void 0)return y(Be,{class:"q-tree__icon q-mr-sm",name:r.icon,color:r.iconColor});const c=r.img||r.avatar;if(c)return y("img",{class:`q-tree__${r.img?"img":"avatar"} q-mr-sm`,src:c})}function Z(){o("afterShow")}function Y(){o("afterHide")}function re(r){const c=r[e.nodeKey],l=m.value[c],b=r.header&&n[`header-${r.header}`]||n["default-header"],v=l.isParent===!0?H(r[e.childrenKey]):[],z=v.length!==0||l.lazy&&l.lazy!=="loaded";let U=r.body&&n[`body-${r.body}`]||n["default-body"];const u=b!==void 0||U!==void 0?k(r,l,c):null;return U!==void 0&&(U=y("div",{class:"q-tree__node-body relative-position"},[y("div",{class:a.value},[U(u)])])),y("div",{key:c,class:`q-tree__node relative-position q-tree__node--${z===!0?"parent":"child"}`},[y("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(l.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(l.selected===!0?" q-tree__node--selected":"")+(l.disabled===!0?" q-tree__node--disabled":""),tabindex:l.link===!0?0:-1,ariaExpanded:v.length>0?l.expanded:null,role:"treeitem",onClick:_=>{ie(r,l,_)},onKeypress(_){it(_)!==!0&&(_.keyCode===13?ie(r,l,_,!0):_.keyCode===32&&ne(r,l,_,!0))}},[y("div",{class:"q-focus-helper",tabindex:-1,ref:_=>{p[l.key]=_}}),l.lazy==="loading"?y(qe,{class:"q-tree__spinner",color:A.value}):z===!0?y(Be,{class:"q-tree__arrow"+(l.expanded===!0?" q-tree__arrow--rotate":""),name:O.value,onClick(_){ne(r,l,_)}}):null,l.hasTicking===!0&&l.noTick!==!0?y(nt,{class:"q-tree__tickbox",modelValue:l.indeterminate===!0?null:l.ticked,color:A.value,dark:i.value,dense:!0,keepColor:!0,disable:l.tickable!==!0,onKeydown:me,"onUpdate:modelValue":_=>{ye(l,_)}}):null,y("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(l.selected===!0?C.value:a.value)},[b?b(u):[J(r),y("div",r[e.labelKey])]])]),z===!0?e.noTransition===!0?l.expanded===!0?y("div",{class:"q-tree__node-collapsible"+a.value,key:`${c}__q`},[U,y("div",{class:"q-tree__children"+(l.disabled===!0?" q-tree__node--disabled":""),role:"group"},v)]):null:y(qt,{duration:e.duration,onShow:Z,onHide:Y},()=>ot(y("div",{class:"q-tree__node-collapsible"+a.value,key:`${c}__q`},[U,y("div",{class:"q-tree__children"+(l.disabled===!0?" q-tree__node--disabled":""),role:"group"},v)]),[[ut,l.expanded]])):U])}function he(r){const c=p[r];c&&c.focus()}function ie(r,c,l,b){b!==!0&&c.selectable!==!1&&he(c.key),R.value&&c.selectable?e.noSelectionUnset===!1?o("update:selected",c.key!==e.selected?c.key:null):c.key!==e.selected&&o("update:selected",c.key===void 0?null:c.key):ne(r,c,l,b),typeof r.handler=="function"&&r.handler(r)}function ne(r,c,l,b){l!==void 0&&me(l),b!==!0&&c.selectable!==!1&&he(c.key),M(c.key,!c.expanded,r,c)}function ye(r,c){if(r.indeterminate===!0&&(c=r.indeterminateNextState),r.strictTicking)Q([r.key],c);else if(r.leafTicking){const l=[],b=v=>{v.isParent?(c!==!0&&v.noTick!==!0&&v.tickable===!0&&l.push(v.key),v.leafTicking===!0&&v.children.forEach(b)):v.noTick!==!0&&v.tickable===!0&&(v.leafFilteredTicking!==!0||v.matchesFilter===!0)&&l.push(v.key)};b(r),Q(l,c)}}return e.defaultExpandAll===!0&&S(),Object.assign(s,{getNodeByKey:d,getTickedNodes:N,getExpandedNodes:X,isExpanded:T,collapseAll:F,expandAll:S,setExpanded:M,isTicked:B,setTicked:Q}),()=>{const r=H(e.nodes);return y("div",{class:w.value,role:"tree"},r.length===0?e.filter?e.noResultsLabel||t.lang.tree.noResults:e.noNodesLabel||t.lang.tree.noNodes:r)}}}),Tt=xe({name:"QUploaderAddTrigger",setup(){const e=st(Ye,Ke);return e===Ke&&console.error("QUploaderAddTrigger needs to be child of QUploader"),e}});function fe(e,n,o,s){const t=[];return e.forEach(i=>{s(i)===!0?t.push(i):n.push({failedPropValidation:o,file:i})}),t}function Fe(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),me(e)}const At={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Bt=["rejected"];function Lt({editable:e,dnd:n,getFileInput:o,addFilesToQueue:s}){const{props:t,emit:i,proxy:g}=we(),h=P(null),f=E(()=>t.accept!==void 0?t.accept.split(",").map(d=>(d=d.trim(),d==="*"?"*/":(d.endsWith("/*")&&(d=d.slice(0,d.length-1)),d.toUpperCase()))):null),p=E(()=>parseInt(t.maxFiles,10)),w=E(()=>parseInt(t.maxTotalSize,10));function R(d){if(e.value)if(d!==Object(d)&&(d={target:null}),d.target!==null&&d.target.matches('input[type="file"]')===!0)d.clientX===0&&d.clientY===0&&ge(d);else{const N=o();N&&N!==d.target&&N.click(d)}}function O(d){e.value&&d&&s(null,d)}function A(d,N,X,T){let F=Array.from(N||d.target.files);const S=[],M=()=>{S.length!==0&&i("rejected",S)};if(t.accept!==void 0&&f.value.indexOf("*/")===-1&&(F=fe(F,S,"accept",q=>f.value.some(B=>q.type.toUpperCase().startsWith(B)||q.name.toUpperCase().endsWith(B))),F.length===0))return M();if(t.maxFileSize!==void 0){const q=parseInt(t.maxFileSize,10);if(F=fe(F,S,"max-file-size",B=>B.size<=q),F.length===0)return M()}if(t.multiple!==!0&&F.length!==0&&(F=[F[0]]),F.forEach(q=>{q.__key=q.webkitRelativePath+q.lastModified+q.name+q.size}),T===!0){const q=X.map(B=>B.__key);F=fe(F,S,"duplicate",B=>q.includes(B.__key)===!1)}if(F.length===0)return M();if(t.maxTotalSize!==void 0){let q=T===!0?X.reduce((B,Q)=>B+Q.size,0):0;if(F=fe(F,S,"max-total-size",B=>(q+=B.size,q<=w.value)),F.length===0)return M()}if(typeof t.filter=="function"){const q=t.filter(F);F=fe(F,S,"filter",B=>q.includes(B))}if(t.maxFiles!==void 0){let q=T===!0?X.length:0;if(F=fe(F,S,"max-files",()=>(q++,q<=p.value)),F.length===0)return M()}if(M(),F.length!==0)return F}function a(d){Fe(d),n.value!==!0&&(n.value=!0)}function C(d){me(d),(d.relatedTarget!==null||ve.is.safari!==!0?d.relatedTarget!==h.value:document.elementsFromPoint(d.clientX,d.clientY).includes(h.value)===!1)===!0&&(n.value=!1)}function $(d){Fe(d);const N=d.dataTransfer.files;N.length!==0&&s(null,N),n.value=!1}function m(d){if(n.value===!0)return y("div",{ref:h,class:`q-${d}__dnd absolute-full`,onDragenter:Fe,onDragover:Fe,onDragleave:C,onDrop:$})}return Object.assign(g,{pickFiles:R,addFiles:O}),{pickFiles:R,addFiles:O,onDragover:a,onDragleave:C,processFiles:A,getDndNode:m,maxFilesNumber:p,maxTotalSizeNumber:w}}function Ve(e){return(e*100).toFixed(2)+"%"}const Rt={...Re,...At,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},We=[...Bt,"start","finish","added","removed"];function Ot(e,n){const o=we(),{props:s,slots:t,emit:i,proxy:g}=o,{$q:h}=g,f=Oe(s,h);function p(u,_,K){if(u.__status=_,_==="idle"){u.__uploaded=0,u.__progress=0,u.__sizeLabel=je(u.size),u.__progressLabel="0.00%";return}if(_==="failed"){g.$forceUpdate();return}u.__uploaded=_==="uploaded"?u.size:K,u.__progress=_==="uploaded"?1:Math.min(.9999,u.__uploaded/u.size),u.__progressLabel=Ve(u.__progress),g.$forceUpdate()}const w=E(()=>s.disable!==!0&&s.readonly!==!0),R=P(!1),O=P(null),A=P(null),a={files:P([]),queuedFiles:P([]),uploadedFiles:P([]),uploadedSize:P(0),updateFileStatus:p,isAlive:()=>dt(o)===!1},{pickFiles:C,addFiles:$,onDragover:m,onDragleave:d,processFiles:N,getDndNode:X,maxFilesNumber:T,maxTotalSizeNumber:F}=Lt({editable:w,dnd:R,getFileInput:ye,addFilesToQueue:r});Object.assign(a,e({props:s,slots:t,emit:i,helpers:a,exposeApi:u=>{Object.assign(a,u)}})),a.isBusy===void 0&&(a.isBusy=P(!1));const S=P(0),M=E(()=>S.value===0?0:a.uploadedSize.value/S.value),q=E(()=>Ve(M.value)),B=E(()=>je(S.value)),Q=E(()=>w.value===!0&&a.isUploading.value!==!0&&(s.multiple===!0||a.queuedFiles.value.length===0)&&(s.maxFiles===void 0||a.files.value.length<T.value)&&(s.maxTotalSize===void 0||S.value<F.value)),k=E(()=>w.value===!0&&a.isBusy.value!==!0&&a.isUploading.value!==!0&&a.queuedFiles.value.length!==0);ct(Ye,b);const H=E(()=>"q-uploader column no-wrap"+(f.value===!0?" q-uploader--dark q-dark":"")+(s.bordered===!0?" q-uploader--bordered":"")+(s.square===!0?" q-uploader--square no-border-radius":"")+(s.flat===!0?" q-uploader--flat no-shadow":"")+(s.disable===!0?" disabled q-uploader--disable":"")+(R.value===!0?" q-uploader--dnd":"")),J=E(()=>"q-uploader__header"+(s.color!==void 0?` bg-${s.color}`:"")+(s.textColor!==void 0?` text-${s.textColor}`:""));_e(a.isUploading,(u,_)=>{_===!1&&u===!0?i("start"):_===!0&&u===!1&&i("finish")});function Z(){s.disable===!1&&(a.abort(),a.uploadedSize.value=0,S.value=0,ne(),a.files.value=[],a.queuedFiles.value=[],a.uploadedFiles.value=[])}function Y(){s.disable===!1&&he(["uploaded"],()=>{a.uploadedFiles.value=[]})}function re(){he(["idle","failed"],({size:u})=>{S.value-=u,a.queuedFiles.value=[]})}function he(u,_){if(s.disable===!0)return;const K={files:[],size:0},I=a.files.value.filter(j=>u.indexOf(j.__status)===-1?!0:(K.size+=j.size,K.files.push(j),j.__img!==void 0&&window.URL.revokeObjectURL(j.__img.src),!1));K.files.length!==0&&(a.files.value=I,_(K),i("removed",K.files))}function ie(u){s.disable||(u.__status==="uploaded"?a.uploadedFiles.value=a.uploadedFiles.value.filter(_=>_.__key!==u.__key):u.__status==="uploading"?u.__abort():S.value-=u.size,a.files.value=a.files.value.filter(_=>_.__key!==u.__key?!0:(_.__img!==void 0&&window.URL.revokeObjectURL(_.__img.src),!1)),a.queuedFiles.value=a.queuedFiles.value.filter(_=>_.__key!==u.__key),i("removed",[u]))}function ne(){a.files.value.forEach(u=>{u.__img!==void 0&&window.URL.revokeObjectURL(u.__img.src)})}function ye(){return A.value||O.value.getElementsByClassName("q-uploader__input")[0]}function r(u,_){const K=N(u,_,a.files.value,!0),I=ye();I!=null&&(I.value=""),K!==void 0&&(K.forEach(j=>{if(a.updateFileStatus(j,"idle"),S.value+=j.size,s.noThumbnails!==!0&&j.type.toUpperCase().startsWith("IMAGE")){const oe=new Image;oe.src=window.URL.createObjectURL(j),j.__img=oe}}),a.files.value=a.files.value.concat(K),a.queuedFiles.value=a.queuedFiles.value.concat(K),i("added",K),s.autoUpload===!0&&a.upload())}function c(){k.value===!0&&a.upload()}function l(u,_,K){if(u===!0){const I={type:"a",key:_,icon:h.iconSet.uploader[_],flat:!0,dense:!0};let j;return _==="add"?(I.onClick=C,j=b):I.onClick=K,y(ee,I,j)}}function b(){return y("input",{ref:A,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:s.accept,multiple:s.multiple===!0?"multiple":void 0,capture:s.capture,onMousedown:ge,onClick:C,onChange:r})}function v(){return t.header!==void 0?t.header(U):[y("div",{class:"q-uploader__header-content column"},[y("div",{class:"flex flex-center no-wrap q-gutter-xs"},[l(a.queuedFiles.value.length!==0,"removeQueue",re),l(a.uploadedFiles.value.length!==0,"removeUploaded",Y),a.isUploading.value===!0?y(qe,{class:"q-uploader__spinner"}):null,y("div",{class:"col column justify-center"},[s.label!==void 0?y("div",{class:"q-uploader__title"},[s.label]):null,y("div",{class:"q-uploader__subtitle"},[B.value+" / "+q.value])]),l(Q.value,"add"),l(s.hideUploadBtn===!1&&k.value===!0,"upload",a.upload),l(a.isUploading.value,"clear",a.abort)])])]}function z(){return t.list!==void 0?t.list(U):a.files.value.map(u=>y("div",{key:u.__key,class:"q-uploader__file relative-position"+(s.noThumbnails!==!0&&u.__img!==void 0?" q-uploader__file--img":"")+(u.__status==="failed"?" q-uploader__file--failed":u.__status==="uploaded"?" q-uploader__file--uploaded":""),style:s.noThumbnails!==!0&&u.__img!==void 0?{backgroundImage:'url("'+u.__img.src+'")'}:null},[y("div",{class:"q-uploader__file-header row flex-center no-wrap"},[u.__status==="failed"?y(Be,{class:"q-uploader__file-status",name:h.iconSet.type.negative,color:"negative"}):null,y("div",{class:"q-uploader__file-header-content col"},[y("div",{class:"q-uploader__title"},[u.name]),y("div",{class:"q-uploader__subtitle row items-center no-wrap"},[u.__sizeLabel+" / "+u.__progressLabel])]),u.__status==="uploading"?y(xt,{value:u.__progress,min:0,max:1,indeterminate:u.__progress===0}):y(ee,{round:!0,dense:!0,flat:!0,icon:h.iconSet.uploader[u.__status==="uploaded"?"done":"clear"],onClick:()=>{ie(u)}})])]))}ft(()=>{a.isUploading.value===!0&&a.abort(),a.files.value.length!==0&&ne()});const U={};for(const u in a)vt(a[u])===!0?Le(U,u,()=>a[u].value):U[u]=a[u];return Object.assign(U,{upload:c,reset:Z,removeUploadedFiles:Y,removeQueuedFiles:re,removeFile:ie,pickFiles:C,addFiles:$}),ht(U,{canAddFiles:()=>Q.value,canUpload:()=>k.value,uploadSizeLabel:()=>B.value,uploadProgressLabel:()=>q.value}),n({...a,upload:c,reset:Z,removeUploadedFiles:Y,removeQueuedFiles:re,removeFile:ie,pickFiles:C,addFiles:$,canAddFiles:Q,canUpload:k,uploadSizeLabel:B,uploadProgressLabel:q}),()=>{const u=[y("div",{class:J.value},v()),y("div",{class:"q-uploader__list scroll"},z()),X("uploader")];a.isBusy.value===!0&&u.push(y("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[y(qe)]));const _={ref:O,class:H.value};return Q.value===!0&&Object.assign(_,{onDragover:m,onDragleave:d}),y("div",_,u)}}const Dt=pt(We);var Pt=({name:e,props:n,emits:o,injectPlugin:s})=>xe({name:e,props:{...Rt,...n},emits:gt(o)===!0?{...Dt,...o}:[...We,...o],setup(t,{expose:i}){return Ot(s,i)}});function G(e){return typeof e=="function"?e:()=>e}const Nt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Kt=["factoryFailed","uploaded","failed","uploading"];function jt({props:e,emit:n,helpers:o}){const s=P([]),t=P([]),i=P(0),g=E(()=>({url:G(e.url),method:G(e.method),headers:G(e.headers),formFields:G(e.formFields),fieldName:G(e.fieldName),withCredentials:G(e.withCredentials),sendRaw:G(e.sendRaw),batch:G(e.batch)})),h=E(()=>i.value>0),f=E(()=>t.value.length!==0);let p;function w(){s.value.forEach(a=>{a.abort()}),t.value.length!==0&&(p=!0)}function R(){const a=o.queuedFiles.value.slice(0);o.queuedFiles.value=[],g.value.batch(a)?O(a):a.forEach(C=>{O([C])})}function O(a){if(i.value++,typeof e.factory!="function"){A(a,{});return}const C=e.factory(a);if(!C)n("factoryFailed",new Error("QUploader: factory() does not return properly"),a),i.value--;else if(typeof C.catch=="function"&&typeof C.then=="function"){t.value.push(C);const $=m=>{o.isAlive()===!0&&(t.value=t.value.filter(d=>d!==C),t.value.length===0&&(p=!1),o.queuedFiles.value=o.queuedFiles.value.concat(a),a.forEach(d=>{o.updateFileStatus(d,"failed")}),n("factoryFailed",m,a),i.value--)};C.then(m=>{p===!0?$(new Error("Aborted")):o.isAlive()===!0&&(t.value=t.value.filter(d=>d!==C),A(a,m))}).catch($)}else A(a,C||{})}function A(a,C){const $=new FormData,m=new XMLHttpRequest,d=(k,H)=>C[k]!==void 0?G(C[k])(H):g.value[k](H),N=d("url",a);if(!N){console.error("q-uploader: invalid or no URL specified"),i.value--;return}const X=d("formFields",a);X!==void 0&&X.forEach(k=>{$.append(k.name,k.value)});let T=0,F=0,S=0,M=0,q;m.upload.addEventListener("progress",k=>{if(q===!0)return;const H=Math.min(M,k.loaded);o.uploadedSize.value+=H-S,S=H;let J=S-F;for(let Z=T;J>0&&Z<a.length;Z++){const Y=a[Z];if(J>Y.size)J-=Y.size,T++,F+=Y.size,o.updateFileStatus(Y,"uploading",Y.size);else{o.updateFileStatus(Y,"uploading",J);return}}},!1),m.onreadystatechange=()=>{m.readyState<4||(m.status&&m.status<400?(o.uploadedFiles.value=o.uploadedFiles.value.concat(a),a.forEach(k=>{o.updateFileStatus(k,"uploaded")}),n("uploaded",{files:a,xhr:m})):(q=!0,o.uploadedSize.value-=S,o.queuedFiles.value=o.queuedFiles.value.concat(a),a.forEach(k=>{o.updateFileStatus(k,"failed")}),n("failed",{files:a,xhr:m})),i.value--,s.value=s.value.filter(k=>k!==m))},m.open(d("method",a),N),d("withCredentials",a)===!0&&(m.withCredentials=!0);const B=d("headers",a);B!==void 0&&B.forEach(k=>{m.setRequestHeader(k.name,k.value)});const Q=d("sendRaw",a);a.forEach(k=>{o.updateFileStatus(k,"uploading",0),Q!==!0&&$.append(d("fieldName",k),k,k.name),k.xhr=m,k.__abort=()=>{m.abort()},M+=k.size}),n("uploading",{files:a,xhr:m}),s.value.push(m),Q===!0?m.send(new Blob(a)):m.send($)}return{isUploading:h,isBusy:f,abort:w,upload:R}}var $t={name:"QUploader",props:Nt,emits:Kt,injectPlugin:jt},Mt=Pt($t);const Qt={class:"row no-wrap items-center q-pa-sm q-gutter-x-xs bg-white text-black"},It={class:"col q-px-sm"},Vt=pe("div",{class:"q-uploader__title"},"\uD30C\uC77C \uC5C5\uB85C\uB4DC",-1),Xt={class:"q-uploader__subtitle"},Yt={__name:"dialogUpload",props:{folder:String},setup(e){const{dialogRef:n,onDialogCancel:o,onDialogOK:s}=mt(),t=He();function i(g){t.notify({type:"negative",message:`${g.length} file(s) did not pass validation constraints`})}return(g,h)=>(te(),le(bt,{ref_key:"dialogRef",ref:n,persistent:""},{default:V(()=>[W(Mt,{style:{"min-width":"350px","border-radius":"0.6rem"},label:"\uD30C\uC77C \uC5C5\uB85C\uB4DC",multiple:"",bordered:"","with-credentials":"",url:"/api/files",accept:"audio/*",headers:[{name:"folder",value:encodeURIComponent(e.folder)},{name:"Authorization",value:`Bearer ${Ue(_t).getItem("token")}`}],onRejected:i,onFinish:Ue(s)},{header:V(f=>[pe("div",Qt,[f.queuedFiles.length>0?(te(),le(ee,{key:0,round:"",flat:"",icon:"clear_all",color:"secondary",onClick:f.removeQueuedFiles},{default:V(()=>[W(ce,null,{default:V(()=>[se("Clear All")]),_:1})]),_:2},1032,["onClick"])):de("",!0),f.uploadedFiles.length>0?(te(),le(ee,{key:1,round:"",flat:"",color:"primary",icon:"done_all"},{default:V(()=>[W(ce,null,{default:V(()=>[se("Remove Uploaded Files")]),_:1})]),_:1})):de("",!0),f.isUploading?(te(),le(qe,{key:2,class:"q-uploader__spinner",color:"primary"})):de("",!0),pe("div",It,[Vt,pe("div",Xt,$e(f.uploadSizeLabel)+" / "+$e(f.uploadProgressLabel),1)]),f.canAddFiles?(te(),le(ee,{key:3,round:"",flat:"",type:"a",icon:"add_box",color:"primary",onClick:f.pickFiles},{default:V(()=>[W(Tt),W(ce,null,{default:V(()=>[se("\uD30C\uC77C\uC120\uD0DD")]),_:1})]),_:2},1032,["onClick"])):de("",!0),f.canUpload?(te(),le(ee,{key:4,round:"",dense:"",flat:"",icon:"cloud_upload",color:"primary",onClick:f.upload},{default:V(()=>[W(ce,null,{default:V(()=>[se("\uC5C5\uB85C\uB4DC")]),_:1})]),_:2},1032,["onClick"])):de("",!0),f.isUploading?(te(),le(ee,{key:5,round:"",flat:"",icon:"clear",color:"negative",onClick:f.abort},{default:V(()=>[W(ce,null,{default:V(()=>[se("\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):de("",!0),W(ee,{round:"",flat:"",icon:"cancel",color:"negative",onClick:Ue(s)},{default:V(()=>[W(ce,null,{default:V(()=>[se("Close")]),_:1})]),_:1},8,["onClick"])]),pe("div",null,[W(yt,{color:"grey-5"})])]),_:1},8,["headers","onFinish"])]),_:1},512))}},L=Ft({files:[],folders:[],selectedFile:"",selectedFiles:[],selectedFolder:"",globalFolder:"",userFolder:""}),Ht=async()=>{try{const e=await ae.get("/files/dir");L.folders=e.data.folders,L.globalFolder=e.data.globalFolder,L.userFolder=e.data.userFolder,L.selectedFolder||(L.selectedFolder=e.data.globalFolder)}catch(e){console.error(e)}},Ge=async e=>{try{L.selectedFiles=[];const{data:n}=await ae.get("/files",{params:{folder:e}});if(e===L.globalFolder||e===L.userFolder)L.files=[...n.files.filter(o=>o.type==="folder"),...n.files.filter(o=>o.type!=="folder")];else{const o=e.split("\\");o.pop(),L.files=[{name:"..",fullpath:o.join("\\"),type:"folder"},...n.files.filter(s=>s.type==="folder"),...n.files.filter(s=>s.type!=="folder")]}}catch(n){console.error(n)}},il=async e=>{L.selectedFolder=e,await Ge(e),L.selectedFiles=[]},ke=async()=>{await Ht(),await Ge(L.selectedFolder),L.selectedFiles=[]},nl=()=>{const e=He();return{fnMakeFolder:()=>{e.dialog({component:Me,componentProps:{icon:"create_new_folder",title:"\uD3F4\uB354 \uC0DD\uC131",caption:"\uC0DD\uC131\uD560 \uD3F4\uB354 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694.",label:"\uD3F4\uB354"}}).onOk(async h=>{try{e.loading.show(),await ae.post("/files/newfolder",{folder:L.selectedFolder,name:h}),await ke(),e.loading.hide()}catch(f){e.loading.hide(),console.error(f)}})},fnUploadFile:()=>{e.dialog({component:Yt,componentProps:{folder:L.selectedFolder}}).onOk(async()=>{try{e.loading.show(),await ke(),e.loading.hide()}catch(h){e.loading.hide(),console.error(h)}})},fnDeleteFiles:()=>{!L.selectedFiles||e.dialog({component:wt,componentProps:{icon:"delete",iconColor:"red-10",title:"\uC120\uD0DD\uD55C \uD30C\uC77C \uD639\uC740 \uD3F4\uB354\uB97C \uC0AD\uC81C \uD569\uB2C8\uB2E4.",caption:`\uCD1D ${L.selectedFiles.length}\uAC1C\uC758 \uD30C\uC77C\uC744 \uC0AD\uC81C \uD569\uB2C8\uB2E4.`}}).onOk(async()=>{try{e.loading.show(),await ae.delete("/files",{data:{files:L.selectedFiles}}),await ke(),e.loading.hide()}catch(h){console.error(h),e.loading.hide()}})},fnRenameFile:h=>{e.dialog({component:Me,componentProps:{icon:"edit",iconColor:"primary",title:"\uD30C\uC77C(\uD3F4\uB354)\uC774\uB984 \uBCC0\uACBD",inputValue:h.name}}).onOk(async f=>{try{e.loading.show(),await ae.put("/files/rename",{oldFile:h,newName:f}),await ke(),e.loading.hide()}catch(p){console.error(p),e.loading.hide()}})},fnDownloadFiles:async()=>{try{if(L.selectedFiles&&L.selectedFiles.length){e.loading.show();const h=await ae.get("/files/downloads",{params:{files:JSON.stringify(L.selectedFiles)},responseType:"blob"});e.loading.hide();const f=window.URL.createObjectURL(new Blob([h.data])),p=document.createElement("a");p.href=f,p.setAttribute("download","download.zip"),document.body.appendChild(p),p.click(),p.remove()}}catch(h){e.loading.hide(),console.error(h)}},fnDownloadFile:async h=>{try{e.loading.show();const f=await ae.get("/files/download",{params:{file:JSON.stringify(h)},responseType:"blob"});e.loading.hide();const p=window.URL.createObjectURL(new Blob([f.data])),w=document.createElement("a");w.href=p,w.setAttribute("download",h.base),document.body.appendChild(w),w.click(),w.remove()}catch(f){e.loading.hide(),console.error(f)}}}};export{rl as Q,Et as T,al as a,ke as b,il as c,L as f,nl as u};

import{aS as B,v as L,r as f,c as T,o as M,y as w,z as O,A as s,B as t,j as a,S as m,L as P,H as p,aY as C,J as b,C as i,K as Y,b5 as q,D as h,F as $,b4 as K,M as E,aU as F,bO as G,p as I,O as J}from"./index.9fbc72cd.js";import{Q as x}from"./QTooltip.997f9a12.js";import{Q as R,a as g}from"./QTable.7e6a138a.js";import{Q as j}from"./locale.767c42d9.js";import{Q as H}from"./QTr.3554b94a.js";import{Q as Z}from"./QPagination.530c5d55.js";import{f as W,a as X,Q as ee,_ as ae}from"./useLogs.153c88fa.js";import{Q as se}from"./QPage.adf6b65b.js";import{h as v,C as te}from"./ClosePopup.f9faca5e.js";const oe={class:"borderd"},le={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},ne={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},re=t("div",{class:"font-main"},"\uC2DC\uC2A4\uD15C \uB85C\uADF8",-1),ie={class:"row no-wrap items-center q-gutter-x-sm"},ue={key:0,class:"q-pa-sm bg-blue-grey-1 row justify-center items-center"},de={class:"q-gutter-x-sm row no-wrap items-center"},ce=t("span",{class:"text-bold"},"\uB0A0\uC9DC",-1),me=t("span",null,"~",-1),pe={style:{"font-size":"0.8rem"}},fe={class:"q-pa-md"},ge={class:"row justify-center q-py-md",style:{position:"relative"}},ve={class:"row items-center q-px-md",style:{position:"absolute",right:"0",top:"1px","font-size":"0.8rem"}},_e=t("span",null,"\uD398\uC774\uC9C0\uB2F9 \uD45C\uC2DC",-1),Ce={__name:"SystemLogPage",setup(we){const{fnNotiError:k}=B(),S=[{name:"createdAt",label:"Time",align:"center",field:"createdAt",sortable:!0},{name:"level",label:"Level",align:"center",field:"level",sortable:!0},{name:"source",label:"Source",align:"center",field:"source",sortable:!0},{name:"zones",label:"Zones",align:"center",field:"zones",sortable:!0},{name:"message",label:"Message",align:"left",field:"message",sortable:!0}],y=L(),_=f(""),u=f(""),d=f(""),Q=f([]),l=f({sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,rowsNumber:0}),A=T(()=>u.value||d.value),D=n=>{switch(n){case"error":return"bg-red-10 text-white";case"warn":return"bg-yellow-3";case"debug":return"bg-indigo-1";case"event":return"bg-teal-2";case"info":return""}},V=async n=>{try{y.loading.show();const o={...n,level:0,start:u.value,end:d.value},{data:e}=await J.get(`/logs?options=${JSON.stringify(o)}`);Q.value=e.current,l.value=e.pagination}catch(o){console.error(o)}finally{y.loading.hide()}},r=async()=>{await V({pagination:l.value,filter:_.value})},N=async()=>{u.value="",d.value="",await r()},U=()=>{y.dialog({component:ae,componentProps:{start:u.value,end:d.value}}).onOk(async n=>{if(v(new Date(n.start)).isAfter(v())){k("\uC2DC\uC791 \uC2DC\uAC04\uC774 \uC624\uB298\uBCF4\uB2E4 \uB2A6\uC2B5\uB2C8\uB2E4.");return}if(v(new Date(n.start)).isAfter(v(new Date(n.end)))){k("\uC2DC\uC791 \uC2DC\uAC04\uC774 \uC885\uB8CC \uC2DC\uAC04\uBCF4\uB2E4 \uB2A6\uC2B5\uB2C8\uB2E4.");return}u.value=n.start,d.value=n.end,l.value.page=1,await r()})};return M(async()=>{await r()}),(n,o)=>(w(),O(se,{class:"page"},{default:s(()=>[t("div",oe,[t("div",le,[t("div",ne,[a(m,{name:"list_alt",color:"primary",size:"md"}),re,a(P,{flat:"",dense:"",round:"",icon:"refresh",color:"primary",onClick:r},{default:s(()=>[a(x,null,{default:s(()=>[p("\uC0C8\uB85C\uACE0\uCE68")]),_:1})]),_:1})]),t("div",ie,[a(C,{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=e=>_.value=e),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:s(()=>[a(m,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"]),a(P,{flat:"",round:"",icon:"settings",size:"sm",color:"primary",onClick:U},{default:s(()=>[a(x,null,{default:s(()=>[p("\uAC80\uC0C9\uC635\uC158")]),_:1})]),_:1})])]),A.value?(w(),b("div",ue,[t("div",de,[a(m,{name:"calendar_month",color:"primary",size:"sm"}),ce,t("span",null,i(u.value),1),me,t("span",null,i(d.value),1),a(m,{class:"cursor-pointer",name:"cancel",color:"red-10",size:"xs",onClick:N},{default:s(()=>[a(x,null,{default:s(()=>[p("\uD574\uC81C")]),_:1})]),_:1})])])):Y("",!0),a(R,{flat:"",columns:S,rows:Q.value,filter:_.value,"row-key":"_id","wrap-cells":"","hide-pagination":"",pagination:l.value,"onUpdate:pagination":o[1]||(o[1]=e=>l.value=e),onRequest:V},{body:s(e=>[a(H,{props:e,class:q(D(e.row.level))},{default:s(()=>[a(g,{key:"createdAt",props:e},{default:s(()=>[t("div",pe,i(h(v)(e.row.createdAt).format("YYYY-MM-DD hh:mm:ss A")),1)]),_:2},1032,["props"]),a(g,{key:"level",props:e},{default:s(()=>[p(i(e.row.level.toUpperCase()),1)]),_:2},1032,["props"]),a(g,{key:"source",props:e},{default:s(()=>[p(i(e.row.source),1)]),_:2},1032,["props"]),a(g,{key:"zones",props:e},{default:s(()=>[p(i(e.row.zones&&e.row.zones.length?e.row.zones.join(","):""),1)]),_:2},1032,["props"]),a(g,{class:"message",key:"message",props:e},{default:s(()=>[(w(!0),b($,null,K(h(W)(e.row.message),(c,z)=>(w(),b("span",{key:z,class:q(["q-ml-xs",h(X)(c,z)])},i(c),3))),128)),a(j,null,{default:s(()=>[t("div",fe,i(e.row.message),1)]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props","class"])]),_:1},8,["rows","filter","pagination"]),a(E),t("div",ge,[a(Z,{modelValue:l.value.page,"onUpdate:modelValue":[o[2]||(o[2]=e=>l.value.page=e),r],max:l.value.rowsNumber/l.value.rowsPerPage,"max-pages":8,size:"12px",flat:"","active-design":"outline","direction-links":"","boundary-links":""},null,8,["modelValue","max"]),t("div",ve,[_e,a(F,{style:{"font-size":"0.8rem"},borderless:"","item-aligned":"",dense:"","hide-bottom-space":"","map-options":"",modelValue:l.value.rowsPerPage,"onUpdate:modelValue":[o[3]||(o[3]=e=>l.value.rowsPerPage=e),r],options:[5,10,15,20,25,30,40,50]},null,8,["modelValue"]),a(m,{name:"settings",size:"xs",color:"primary"},{default:s(()=>[a(ee,{modelValue:l.value.page,"onUpdate:modelValue":o[4]||(o[4]=e=>l.value.page=e),"max-width":"160px"},{default:s(e=>[a(C,{modelValue:e.value,"onUpdate:modelValue":c=>e.value=c,dense:"",autofocus:"","auto-save":"",type:"number",label:"\uD398\uC774\uC9C0 \uBC14\uB85C\uAC00\uAE30",onKeyup:G(c=>(e.set(),r()),["enter"])},{append:s(()=>[I(a(m,{class:"cursor-pointer",name:"send",color:"primary",size:"xs",onClick:c=>(e.set(),r())},null,8,["onClick"]),[[te]])]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}))}};export{Ce as default};

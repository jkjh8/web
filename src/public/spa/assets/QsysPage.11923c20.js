import{aE as V,x as I,y as A,z as a,j as e,N as F,O as z,S as w,A as s,B as r,U as L,V as g,W as m,X as l,E as t,C as h,b2 as E,aF as H,J as Q,P as M,r as O,o as R,H as Y,F as W,aW as j,aO as U,aM as G,aN as K,M as D,u as J,aR as q,br as X}from"./index.568a708f.js";import{Q as x}from"./QTooltip.68db7ee9.js";import{Q as ee}from"./QBadge.5582eafb.js";import{Q as ae,a as N}from"./QTable.d70111e5.js";import{Q as te}from"./QPage.f67a53cb.js";import{c as ne}from"./columns.1bbc92fa.js";import{_ as le}from"./DialogConfirm.923d0832.js";import{f as oe,b as Z,_ as ie,a as se}from"./useBarix.38b8f659.js";import{Q as de}from"./QSelect.7a7901d8.js";import{Q as re}from"./useRules.73a05877.js";import{u as T}from"./useNotify.2c7e2d4a.js";import"./QMenu.9f8c2a36.js";import"./QLinearProgress.3dc43b88.js";const ce=s("div",{class:"dialog-name"},"Q-SYS INFO",-1),ue={class:"caption font-sans"},fe={class:"q-px-md"},me=["href"],pe={__name:"infoQsys",props:["device"],emits:[...V.emits],setup(d,{emit:i}){const{dialogRef:p,onDialogHide:b,onDialogOK:k,onDialogCancel:S}=V();return(P,$)=>(I(),A(M,{ref_key:"dialogRef",ref:p,onHide:h(b)},{default:a(()=>[e(F,{class:"q-dialog-plugin",style:{"border-radius":"8px"}},{default:a(()=>[e(z,{class:"row no-wrap q-gutter-sm items-center"},{default:a(()=>[e(w,{style:{"margin-top":"10px"},name:"img:qsys.svg",size:"1.5rem"}),s("div",null,[ce,s("div",ue,r(d.device.deviceId),1)])]),_:1}),e(z,null,{default:a(()=>[s("div",fe,[e(L,{dense:""},{default:a(()=>[e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uC7A5\uCE58 \uC774\uB984")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.name),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("IP Address")]),_:1}),e(l,{caption:""},{default:a(()=>[s("a",{href:`http://${d.device.ipaddress}`,target:"_blank"},[t(r(d.device.ipaddress)+" ",1),e(w,{class:"cursor-pointer",name:"launch",color:"primary"})],8,me)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uC6B0\uC120\uC21C\uC704")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.idx),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uC5F0\uACB0 \uC0C1\uD0DC")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.connected),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uCF54\uC5B4 \uD50C\uB7AB\uD3FC")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.EngineStatus.Platform),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uCF54\uC5B4 \uC0C1\uD0DC")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.EngineStatus.State),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("PA \uC2E4\uC2DC\uAC04 \uB370\uC774\uD130 \uC5F0\uB3D9")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(d.device.ZoneStatusConfigure),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uB9C8\uC9C0\uB9C9 \uC5C5\uB370\uC774\uD2B8")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(h(E).formatDate(d.device.updatedAt,"YYYY-MM-DD hh:mm:ss A")),1)]),_:1})]),_:1})]),_:1}),e(g,{dense:""},{default:a(()=>[e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t("\uC7A5\uCE58 \uB4F1\uB85D \uC2DC\uAC04")]),_:1}),e(l,{caption:""},{default:a(()=>[t(r(h(E).formatDate(d.device.createdAt,"YYYY-MM-DD hh:mm:ss A")),1)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(H,{align:"right"},{default:a(()=>[e(Q,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:h(k)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},_e={class:"dialog-name row no-wrap items-center q-gutter-x-sm"},ve=s("div",null,"\uBC29\uC1A1\uAD6C\uAC04\uC774\uB984 \uC218\uC815",-1),ge={class:"text-caption"},ye={__name:"editZoneSettings",props:["device"],emits:[...V.emits],setup(d,{emit:i}){const p=d,{dialogRef:b,onDialogCancel:k,onDialogHide:S,onDialogOK:P}=V(),{fnNotiWarn:$,fnNotiError:B}=T(),n=O([]),f=O([]),o=(c,_,v)=>{_(()=>{f.value=Z.value.filter(y=>y.name.indexOf(c)>-1)})},C=async(c,_)=>{if(c===null)return n.value[_].destination="";const v=n.value.findIndex(u=>u.destination===c);if(_!==-1&&_!==v)return n.value[_].destination="",$("\uC774\uBBF8 \uC120\uD0DD\uB41C \uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30\uC785\uB2C8\uB2E4.");const y=await D.get("/devices/qsys/existszones",{params:{id:c,deviceId:p.device.deviceId}});if(y.data&&y.data.value&&y.data.value.length)return y.data.value.findIndex(u=>u.deviceId===p.device.deviceId),n.value[_].destination="",$("\uC774\uBBF8 \uC120\uD0DD\uB41C \uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30\uC785\uB2C8\uB2E4.")};return R(async()=>{await oe(),n.value=[...p.device.ZoneStatus.map(c=>({name:c.name?c.name:"",Zone:c.Zone,destination:c.destination&&c.destination._id?c.destination._id:""}))],f.value=Z.value}),(c,_)=>(I(),A(M,{ref_key:"dialogRef",ref:b,onHide:h(S),persistent:""},{default:a(()=>[e(F,{class:"q-dialog-plugin",style:{"border-radius":"8px","max-width":"1000px",width:"90%"}},{default:a(()=>[e(z,null,{default:a(()=>[s("div",_e,[e(w,{name:"add_circle",color:"primary",size:"sm"}),s("div",null,[ve,s("div",ge,r(d.device.name)+" "+r(d.device.ipaddress),1)])])]),_:1}),e(re,{onSubmit:_[0]||(_[0]=v=>h(P)(n.value))},{default:a(()=>[e(z,null,{default:a(()=>[(I(!0),Y(W,null,j(n.value,(v,y)=>(I(),Y("div",{key:y,class:"row no-wrap items-center q-gutter-sm q-pt-sm q-px-md"},[e(U,{filled:"",dense:"",modelValue:v.name,"onUpdate:modelValue":u=>v.name=u,style:{width:"50%"},label:`\uCC44\uB110 ${v.Zone}`},null,8,["modelValue","onUpdate:modelValue","label"]),e(de,{style:{width:"50%"},filled:"",dense:"",clearable:"",modelValue:v.destination,"onUpdate:modelValue":[u=>v.destination=u,u=>C(u,y)],options:f.value,label:`\uCC44\uB110 ${v.Zone} \uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30 \uC120\uD0DD`,"option-value":"_id","option-label":"name","hide-selected":"","use-input":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:o},{prepend:a(()=>[e(w,{name:"place"})]),option:a(u=>[e(g,G(K(u.itemProps)),{default:a(()=>[e(m,{avatar:""},{default:a(()=>[e(w,{name:"storage"})]),_:1}),e(m,null,{default:a(()=>[e(l,null,{default:a(()=>[t(r(u.opt.name),1)]),_:2},1024),e(l,{caption:""},{default:a(()=>[t(r(u.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","options","label"])]))),128))]),_:1}),e(H,{align:"right"},{default:a(()=>[e(Q,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:h(k)},null,8,["onClick"]),e(Q,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",type:"submit"})]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},he={class:"borderd"},we={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},be={class:"row no-wrap items-center q-gutter-x-sm"},Qe=s("div",{class:"font-main"},"\uC5C5\uBB34\uBC29\uC1A1 \uC8FC\uC7A5\uCE58",-1),ke=["href"],Be={__name:"QsysPage",setup(d){const i=J(),{fnNotiError:p}=T(),b=O(""),k=()=>{i.dialog({component:ie,componentProps:{title:"\uC5C5\uBB34\uBC29\uC1A1\uC8FC\uC7A5\uCE58 \uCD94\uAC00",type:"qsys"}}).onOk(async n=>{try{i.loading.show(),await D.post("/devices/qsys",{...n})}catch{p({message:"\uC5C5\uBB34\uBC29\uC1A1 \uC8FC\uC7A5\uCE58 \uCD94\uAC00 \uC624\uB958",caption:"\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694."})}finally{await q(),i.loading.hide()}})},S=n=>{i.dialog({component:pe,componentProps:{device:n}})},P=n=>{i.dialog({component:se,componentProps:{title:"\uC5C5\uBB34\uBC29\uC1A1\uC8FC\uC7A5\uCE58 \uC218\uC815",type:"qsys",device:n}}).onOk(async f=>{try{i.loading.show(),await D.put("/devices/qsys/edit",{...f})}catch{p({message:"\uC5C5\uBB34\uBC29\uC1A1 \uC8FC\uC7A5\uCE58 \uC218\uC815 \uC624\uB958",caption:"\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694."})}finally{q(),i.loading.hide()}})},$=n=>{i.dialog({component:ye,componentProps:{device:n}}).onOk(async f=>{try{i.loading.show(),await D.put("/devices/qsys/updatenames",{deviceId:n.deviceId,arr:f})}catch{p({message:"\uBC29\uC1A1\uAD6C\uAC04 \uC218\uC815 \uC624\uB958",caption:"\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694."})}finally{q(),i.loading.hide()}})},B=n=>{i.dialog({component:le,componentProps:{icon:"delete",iconColor:"red-10",title:"\uC5C5\uBB34\uBC29\uC1A1 \uC8FC\uC7A5\uCE58 \uC0AD\uC81C",message:`${n.name} ${n.ipaddress}`}}).onOk(async()=>{try{i.loading.show(),await D.delete("/devices/qsys",{data:{...n}}),i.loading.hide()}catch{p({message:"\uC5C5\uBB34\uBC29\uC1A1 \uC8FC\uC7A5\uCE58 \uC0AD\uC81C \uC624\uB958",caption:"\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694."})}finally{await q(),i.loading.hide()}})};return R(async()=>{try{i.loading.show(),await q()}catch{}finally{i.loading.hide()}}),(n,f)=>(I(),A(te,{class:"page"},{default:a(()=>[s("div",he,[s("div",we,[s("div",be,[e(w,{name:"img:qsys.svg",color:"primary",size:"sm"}),Qe,s("div",null,[e(w,{class:"cursor-pointer",name:"add_circle",size:"sm",color:"primary",onClick:k},{default:a(()=>[e(x,null,{default:a(()=>[t("\uC7A5\uCE58 \uCD94\uAC00")]),_:1})]),_:1})])]),e(U,{modelValue:b.value,"onUpdate:modelValue":f[0]||(f[0]=o=>b.value=o),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:a(()=>[e(w,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"])]),e(ae,{columns:h(ne),rows:h(X),filter:b.value},{"body-cell-name":a(o=>[e(N,{props:o},{default:a(()=>[s("div",null,[e(ee,{rounded:"",color:o.row.connected?"primary":"red-10"},null,8,["color"]),t(" "+r(o.value),1)])]),_:2},1032,["props"])]),"body-cell-ipaddress":a(o=>[e(N,{props:o},{default:a(()=>[s("a",{href:`http://${o.value}`,target:"_blank"},r(o.value),9,ke)]),_:2},1032,["props"])]),"body-cell-actions":a(o=>[e(N,{props:o},{default:a(()=>[s("div",null,[e(Q,{round:"",flat:"",color:"primary",icon:"info",size:"sm",onClick:C=>S(o.row)},{default:a(()=>[e(x,null,{default:a(()=>[t("\uC0C1\uC138\uC815\uBCF4")]),_:1})]),_:2},1032,["onClick"]),e(Q,{round:"",flat:"",color:"primary",icon:"edit",size:"sm",onClick:C=>P(o.row)},{default:a(()=>[e(x,null,{default:a(()=>[t("\uC218\uC815")]),_:1})]),_:2},1032,["onClick"]),e(Q,{round:"",flat:"",color:"blue",icon:"edit_note",size:"sm",onClick:C=>$(o.row)},{default:a(()=>[e(x,null,{default:a(()=>[t("\uBC29\uC1A1\uAD6C\uAC04\uC218\uC815")]),_:1})]),_:2},1032,["onClick"]),e(Q,{round:"",flat:"",color:"red-10",icon:"delete",size:"sm",onClick:C=>B(o.row)},{default:a(()=>[e(x,null,{default:a(()=>[t("\uC0AD\uC81C")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter"])])]),_:1}))}};export{Be as default};

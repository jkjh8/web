import{K as Q,r as T,x as n,y as _,z as o,A as u,k as l,J as t,aS as g,D as a,G as p,E as b,N as V,B as z,H as c,bB as N,i as q,u as A,v as B,c as E,o as D,I}from"./index.93de1c34.js";import{Q as m}from"./QTooltip.58f974ba.js";import{Q as M}from"./QPage.e108c776.js";import{Q as P,a as R}from"./QTree.f37fadc8.js";import{Q as j,b as h,a as v}from"./QTable.9b92951a.js";import{Q as x}from"./QTr.a7260de6.js";import{u as i}from"./file.6e1703c9.js";import{u as Z}from"./player.7b3f7c7b.js";import"./QSlideTransition.f0bcd4de.js";import"./QCircularProgress.09830e3e.js";const G={class:"q-pa-sm"},H={key:0},J=["onClick"],K={key:2},O={key:0},L={__name:"fileViewer",props:["selection","mode"],setup(C){const{files:s}=Q(i()),y=T(25);return(w,d)=>(n(),_(R,{modelValue:y.value,"onUpdate:modelValue":d[2]||(d[2]=e=>y.value=e)},{before:o(()=>[u("div",G,[l(P,{nodes:t(s).folders,selected:t(s).selectedFolder,"onUpdate:selected":[d[0]||(d[0]=e=>t(s).selectedFolder=e),t(i)().fnSelectFolder],"node-key":"path","no-selection-unset":"","selected-color":"primary"},null,8,["nodes","selected","onUpdate:selected"])])]),after:o(()=>[l(j,{columns:[{name:"name",label:"NAME",field:"name",align:"left",sortable:!0},{name:"size",label:"SIZE",field:"size",sortable:!0},{name:"actions",label:"ACTIONS"}],rows:t(s).files,flat:"","row-key":"name",selection:C.selection,selected:t(s).selectedFiles,"onUpdate:selected":d[1]||(d[1]=e=>t(s).selectedFiles=e),pagination:{rowsPerPage:0},"hide-bottom":""},{header:o(e=>[l(x,{props:e},{default:o(()=>[l(h,{style:{width:"2rem"}},{default:o(()=>[l(g,{size:"sm",modelValue:e.selected,"onUpdate:modelValue":r=>e.selected=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(h,{key:"name",props:e},{default:o(()=>[a(" NAME ")]),_:2},1032,["props"]),l(h,{key:"size",props:e,style:{width:"2.5rem"}},{default:o(()=>[a(" SIZE ")]),_:2},1032,["props"]),l(h,{key:"actions",props:e,style:{width:"3.5rem"}},{default:o(()=>[a(" Actions ")]),_:2},1032,["props"])]),_:2},1032,["props"])]),body:o(e=>[l(x,{props:e},{default:o(()=>[l(v,{style:{width:"2rem"}},{default:o(()=>[e.row.name!==".."?(n(),_(g,{key:0,size:"sm",modelValue:e.selected,"onUpdate:modelValue":r=>e.selected=r},null,8,["modelValue","onUpdate:modelValue"])):p("",!0)]),_:2},1024),l(v,{key:"name",props:e},{default:o(()=>[e.row.type==="folder"?(n(),b("span",H,[l(V,{name:"folder_open",color:"primary",size:"20px"})])):p("",!0),e.row.type==="folder"?(n(),b("span",{key:1,class:"q-ml-xs cursor-pointer",onClick:r=>t(i)().fnSelectFolder(e.row.fullpath)},z(e.row.name),9,J)):(n(),b("span",K,[a(z(e.row.name)+" ",1),C.mode!=="dialog"?(n(),_(c,{key:0,flat:"",round:"",size:"sm",color:"primary",icon:"play_arrow",onClick:r=>t(Z)().fnPlayStart(e.row)},null,8,["onClick"])):p("",!0)]))]),_:2},1032,["props"]),l(v,{key:"size",props:e,style:{width:"2.5rem"}},{default:o(()=>[a(z(e.row.type!=="folder"?t(N).humanStorageSize(e.row.size):""),1)]),_:2},1032,["props"]),l(v,{key:"actions",props:e,style:{width:"3.5rem"}},{default:o(()=>[e.row.name!==".."?(n(),b("div",O,[e.row.type!=="folder"?(n(),_(c,{key:0,round:"",flat:"",icon:"download",color:"primary",size:"sm",onClick:r=>t(i)().fnDownloadFile(e.row)},{default:o(()=>[l(m,null,{default:o(()=>[a("\uB2E4\uC6B4\uB85C\uB4DC")]),_:1})]),_:2},1032,["onClick"])):p("",!0),l(c,{round:"",flat:"",icon:"edit",color:"primary",size:"sm",onClick:r=>t(i)().fnRenameFile(e.row)},{default:o(()=>[l(m,null,{default:o(()=>[a("\uC774\uB984\uBC14\uAFB8\uAE30")]),_:1})]),_:2},1032,["onClick"])])):p("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","selection","selected"])]),_:1},8,["modelValue"]))}},W={class:"borderd"},X={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},Y={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},ee=u("div",{class:"font-main"},"\uD30C\uC77C \uAD00\uB9AC",-1),le={class:"row no-wrap"},me={__name:"Files",setup(C){q("api");const s=A(),{user:y}=Q(B()),{files:w}=Q(i()),{fnRefreshFF:d,fnMakeFolder:e,fnUploadFile:r,fnDeleteFiles:S,fnDownloadFiles:$}=i(),F=E(()=>{var f;return((f=w.selectedFolder)==null?void 0:f.includes("global"))&&!y.value.isAdmin});return D(async()=>{try{s.loading.show(),await d(),s.loading.hide()}catch(f){s.loading.hide(),console.error(f)}}),(f,k)=>(n(),_(M,{class:"page"},{default:o(()=>[u("div",W,[u("div",X,[u("div",Y,[l(V,{name:"folder_open",color:"primary",size:"md"}),ee]),u("div",le,[l(c,{disable:F.value,round:"",flat:"",icon:"create_new_folder",color:"primary",size:"12px",onClick:k[0]||(k[0]=U=>t(e)(t(w).selectedFolder))},{default:o(()=>[l(m,null,{default:o(()=>[a("\uC0C8\uD3F4\uB354")]),_:1})]),_:1},8,["disable"]),l(c,{disable:F.value,round:"",flat:"",icon:"upload",color:"primary",size:"12px",onClick:k[1]||(k[1]=U=>t(r)(t(w).selectedFolder))},{default:o(()=>[l(m,null,{default:o(()=>[a("\uD30C\uC77C\uC5C5\uB85C\uB4DC")]),_:1})]),_:1},8,["disable"]),l(c,{round:"",flat:"",icon:"download",color:"primary",size:"12px",onClick:t($)},{default:o(()=>[l(m,null,{default:o(()=>[a("\uB2E4\uC6B4\uB85C\uB4DC")]),_:1})]),_:1},8,["onClick"]),l(I,{vertical:"",spaced:"",inset:""}),l(c,{disable:F.value,round:"",flat:"",icon:"delete",color:"red",size:"12px",onClick:t(S)},{default:o(()=>[l(m,null,{default:o(()=>[a("\uC0AD\uC81C")]),_:1})]),_:1},8,["disable","onClick"])])]),l(L,{selection:"multiple",mode:"page"})])]),_:1}))}};export{me as default};

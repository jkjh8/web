import{c as M,br as x,u as y,E as A,F as Y,aT as B,j as a,x as o,C as v,z as c,aB as $,r as C,o as U,v as V,K as S,L as D,y as l,bs as T,aH as F,aI as L,aJ as N,aK as I,R as g,aL as q,aU as O,aC as R,I as Q,A as u,M as Z,bt as E,aG as G,aP as K,aM as j,b0 as k,J as z}from"./index.01937250.js";import{Q as J,a as p}from"./QTable.16097e4d.js";import{Q as H}from"./QTooltip.ded1ba0a.js";import{Q as W}from"./QTr.09d3396b.js";import{Q as X}from"./QPage.36d72cf3.js";import{a as ee,Q as ae}from"./QSelect.313a862b.js";import{_ as P}from"./dialogConfirm.73a5d41e.js";import"./QLinearProgress.702526ef.js";import"./QMenu.850075a6.js";var oe=[{name:"email",label:"E-mail",align:"center",field:"email",sortable:!0},{name:"name",label:"Name",align:"center",field:"name",sortable:!0},{name:"isAdmin",label:"isAdmin",align:"center",field:"isAdmin",sortable:!0},{name:"zones",label:"Zones",align:"center",field:"zones",sortable:!0},{name:"loginAt",label:"Last login",align:"center",field:"loginAt",sortable:!0},{name:"createdAt",label:"Created at",align:"center",field:"createdAt",sortable:!0},{name:"actions",label:"FN",align:"center"}];const ne={__name:"userZone",props:["zones"],setup(b){const f=b,m=M(()=>{if(f.zones&&f.zones.length){const d=[];for(let n of f.zones){const r=x.value.findIndex(i=>i.deviceId===n);r!==-1&&d.push(x.value[r])}return d}else return[]});return(d,n)=>(y(),A("div",null,[(y(!0),A(Y,null,B(m.value,(r,i)=>(y(),A("span",{key:i},[a(ee,{class:"font-main text-bold",icon:"location_on",size:"sm",color:"primary","text-color":"white"},{default:o(()=>[v(c(r.name),1)]),_:2},1024)]))),128))]))}},te=l("div",{class:"q-px-sm dialog-name"},"\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD",-1),se={class:"q-px-md"},le={class:"q-px-sm"},ie={__name:"selectZones",props:["zones"],emits:[...$.emits],setup(b,{emit:f}){const{dialogRef:m,onDialogOK:d,onDialogCancel:n}=$(),r=b,i=C(null),w=C([]),_=(s,t,e)=>{t(()=>{w.value=x.value.filter(h=>h.name.indexOf(s)>-1)})};return U(()=>{w.value=x.value,r.zones&&r.zones.length>0&&(i.value=r.zones)}),(s,t)=>(y(),V(Z,{ref_key:"dialogRef",ref:m,persistent:""},{default:o(()=>[a(S,{class:"q-dialog-plugin",style:{"border-radius":"0.6rem"}},{default:o(()=>[a(D,null,{default:o(()=>[te]),_:1}),a(D,null,{default:o(()=>[l("div",se,[a(ae,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),options:w.value,filled:"",dense:"",multiple:"",label:"\uBC29\uC1A1\uC9C0\uC5ED\uC120\uD0DD","option-value":"deviceId","option-label":"name","use-chips":"","stack-label":"","use-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:_},T({option:o(e=>[a(F,L(N(e.itemProps)),{default:o(()=>[a(I,{avatar:""},{default:o(()=>[a(g,{name:"storage"})]),_:1}),a(I,null,{default:o(()=>[a(q,null,{default:o(()=>[v(c(e.opt.name),1)]),_:2},1024),a(q,{caption:""},{default:o(()=>[v(c(e.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},[i.value?{name:"append",fn:o(()=>[a(g,{name:"cancel",size:"18px",onClick:t[0]||(t[0]=O(e=>i.value=null,["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","options"])])]),_:1}),a(R,{align:"right"},{default:o(()=>[l("div",le,[a(Q,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:u(n)},null,8,["onClick"]),a(Q,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:t[2]||(t[2]=e=>u(d)(i.value))})])]),_:1})]),_:1})]),_:1},512))}},re={class:"borderd"},ce={class:"q-px-lg row no-wrap justify-between items-center bg-grey-2"},de={class:"row no-wrap items-center q-gutter-x-sm"},ue=l("div",{class:"font-main",style:{"font-size":"16px","font-weight":"bold"}}," \uC0AC\uC6A9\uC790 \uAD00\uB9AC ",-1),me={class:"row items-center q-gutter-x-xs"},pe={style:{"font-size":"10px"}},fe={style:{"font-size":"10px"}},xe={__name:"UsersPage",setup(b){const{fnUserInfo:f}=E(),m=C(""),d=C([]),n=G(),r=s=>{n.dialog({component:P,componentProps:{title:"\uAD00\uB9AC\uC790 \uAD8C\uD55C \uBCC0\uACBD",icon:"warning",iconColor:"yellow",message:`${s.email} \uAD00\uB9AC\uC790 \uAD8C\uD55C ${s.isAdmin?"\uD68C\uC218":"\uBD80\uC5EC"} \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await z.put("/users/admin",{...s}),await _(),n.loading.hide()}catch(t){n.loading.hide(),console.error(t)}})},i=async s=>{n.dialog({component:P,componentProps:{title:"\uC0AC\uC6A9\uC790 \uC0AD\uC81C",icon:"error",iconColor:"red-10",message:`${s.email} \uC0AC\uC6A9\uC790\uB97C \uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{n.loading.show(),await z.delete("/users",{data:{...s}}),await _(),n.loading.hide()}catch(t){n.loading.hide(),console.error(t)}})},w=s=>{n.dialog({component:ie,componentProps:{zones:s.zones}}).onOk(async t=>{try{n.loading.show(),await z.put("/users",{user:s,update:{zones:t}}),await _(),n.loading.hide()}catch(e){n.loading.hide(),console.error(e)}console.log(t)})},_=async()=>{const s=await z.get("/users");d.value=s.data.users};return U(async()=>{n.loading.show(),await K(),await _(),n.loading.hide()}),(s,t)=>(y(),V(X,{class:"q-pa-md"},{default:o(()=>[l("div",re,[l("div",ce,[l("div",de,[a(g,{name:"group",color:"primary",size:"24px"}),ue]),a(j,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:o(()=>[a(g,{class:"cursor-pointer",name:"search"})]),_:1},8,["modelValue"])]),a(J,{columns:u(oe),rows:d.value,filter:m.value},{body:o(e=>[a(W,{props:e},{default:o(()=>[a(p,{key:"email",props:e},{default:o(()=>[v(c(e.row.email),1)]),_:2},1032,["props"]),a(p,{key:"name",props:e},{default:o(()=>[v(c(e.row.name),1)]),_:2},1032,["props"]),a(p,{key:"isAdmin",props:e},{default:o(()=>[a(g,{class:"cursor-pointer",size:"xs",name:e.row.isAdmin?"check_circle":"block",color:e.row.isAdmin?"primary":"red-10",onClick:h=>r(e.row)},null,8,["name","color","onClick"])]),_:2},1032,["props"]),a(p,{key:"zones",props:e},{default:o(()=>[l("div",me,[a(ne,{zones:e.row.zones},null,8,["zones"]),a(g,{class:"cursor-pointer",size:"14px",name:"edit",color:"primary",onClick:h=>w(e.row)},null,8,["onClick"])])]),_:2},1032,["props"]),a(p,{key:"loginAt",props:e},{default:o(()=>[l("div",pe,[l("div",null,c(u(k).formatDate(e.row.loginAt,"YYYY-MM-DD")),1),l("div",null,c(u(k).formatDate(e.row.loginAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),a(p,{key:"createdAt",props:e},{default:o(()=>[l("div",fe,[l("div",null,c(u(k).formatDate(e.row.createdAt,"YYYY-MM-DD")),1),l("div",null,c(u(k).formatDate(e.row.createdAt,"hh:mm:ss a")),1)])]),_:2},1032,["props"]),a(p,{key:"actions",props:e},{default:o(()=>[l("div",null,[a(Q,{round:"",flat:"",color:"primary",icon:"info",size:"sm",onClick:h=>u(f)(e.row)},{default:o(()=>[a(H,null,{default:o(()=>[v("\uC0C1\uC138\uC815\uBCF4")]),_:1})]),_:2},1032,["onClick"]),a(Q,{round:"",flat:"",icon:"delete",color:"red-10",size:"sm",onClick:h=>i(e.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter"])])]),_:1}))}};export{xe as default};

"use strict";(globalThis["webpackChunkbs_fe"]=globalThis["webpackChunkbs_fe"]||[]).push([[961],{9118:(e,n,a)=>{a.r(n),a.d(n,{default:()=>ce});var o=a(9835),s=a(499),t=a(6970),l=a(3878),r=a.n(l);const i={class:"time-font"},c={__name:"timeFormat2line",props:["time"],setup(e){return r().locale="ko-KR",(n,a)=>((0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",null,(0,t.zw)((0,s.SU)(r())(e.time).format("YYYY-MM-DD")),1),(0,o._)("div",null,(0,t.zw)((0,s.SU)(r())(e.time).format("hh:mm:ss A")),1)]))}};var u=a(1639);const p=(0,u.Z)(c,[["__scopeId","data-v-0d2bc061"]]),d=p;var m=a(9302),w=a(1569),f=a(8407),g=a(1957),v=a(4182),_=a(7799);const b=(0,o._)("div",{class:"q-px-sm"},[(0,o._)("div",{class:"dialogName"},"방송지역권한")],-1),k={class:"q-px-sm"},y={__name:"selectQsys",props:{zones:Array},emits:[...v.Z.emits],setup(e,{emit:n}){const a=e,{dialogRef:l,onDialogHide:r,onDialogOK:i,onDialogCancel:c}=(0,v.Z)(),u=((0,m.Z)(),(0,s.iH)([])),p=(0,s.iH)([]),d=(e,n,a)=>{n((()=>{p.value=_.Us.value.filter((n=>n.name.indexOf(e)>-1))}))},w=async()=>{console.log(u.value),i(u.value)};return(0,o.bv)((async()=>{await(0,_.l4)(),p.value=_.Us.value,u.value=a.zones})),(e,n)=>{const a=(0,o.up)("q-card-section"),r=(0,o.up)("q-icon"),i=(0,o.up)("q-item-section"),m=(0,o.up)("q-item-label"),f=(0,o.up)("q-item"),v=(0,o.up)("q-select"),_=(0,o.up)("q-btn"),y=(0,o.up)("q-card-actions"),W=(0,o.up)("q-card"),h=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(h,{ref_key:"dialogRef",ref:l,persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{class:"q-dialog-plugin",style:{"border-radius":"0.6rem"}},{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[b])),_:1}),(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o.Wm)(v,{filled:"",dense:"",modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=e=>u.value=e),options:p.value,multiple:"",label:"방송지역선택","option-value":"deviceId","option-label":"name","use-chips":"","stack-label":"","use-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:d},(0,o.Nv)({option:(0,o.w5)((e=>[(0,o.Wm)(f,(0,t.vs)((0,o.F4)(e.itemProps)),{default:(0,o.w5)((()=>[(0,o.Wm)(i,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{name:"storage"})])),_:1}),(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.opt.name),1)])),_:2},1024),(0,o.Wm)(m,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.opt.ipaddress),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:2},[u.value?{name:"append",fn:(0,o.w5)((()=>[(0,o.Wm)(r,{name:"cancel",size:"18px",onClick:n[0]||(n[0]=(0,g.iM)((e=>u.value=null),["stop","prevent"])),class:"cursor-pointer"})])),key:"0"}:void 0]),1032,["modelValue","options"])])])),_:1}),(0,o.Wm)(y,{align:"right"},{default:(0,o.w5)((()=>[(0,o._)("div",k,[(0,o.Wm)(_,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:(0,s.SU)(c)},null,8,["onClick"]),(0,o.Wm)(_,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:w})])])),_:1})])),_:1})])),_:1},512)}}};var W=a(3706),h=a(4458),Z=a(3190),q=a(6384),U=a(2857),z=a(490),A=a(1233),Q=a(3115),C=a(1821),D=a(4455),I=a(9984),S=a.n(I);const x=y,H=x;S()(y,"components",{QDialog:W.Z,QCard:h.Z,QCardSection:Z.Z,QSelect:q.Z,QIcon:U.Z,QItem:z.Z,QItemSection:A.Z,QItemLabel:Q.Z,QCardActions:C.Z,QBtn:D.Z});var F=a(8957);r().locale="ko-KR";const T=(0,s.iH)([]),V=()=>{const e=(0,m.Z)(),{fnNotiFB:n}=(0,F.Z)(),a=async()=>{try{const e=await w.api.get("/users");T.value=e.data.users}catch(e){n(err.response)}},o=o=>{e.dialog({component:f.Z,componentProps:{icon:"check",iconColor:"green",title:o.isAdmin?"관리자 권한 해제":"관리자 권한 설정",message:o.isAdmin?"관리자 권한을 해제하시겠습니까?":"관리자 권한을 설정하시겠습니까?"}}).onOk((async()=>{e.loading.show();try{await w.api.put("/users/admin",{user:o}),await a(),e.loading.hide()}catch(s){e.loading.hide(),n(s)}}))},s=async o=>{e.dialog({component:H,componentProps:{zones:o.zones}}).onOk((async s=>{e.loading.show();try{await w.api.put("/users",{user:o,update:{zones:s}}),await a(),e.loading.hide()}catch(t){e.loading.hide(),n(t)}}))},t=o=>{e.dialog({component:f.Z,componentProps:{icon:"delete",iconColor:"red-10",title:"사용자 삭제",message:`${o.name} - ${o.email} 사용자를 삭제 하시겠습니까?`}}).onOk((async()=>{e.loading.show();try{await w.api.delete("/users",{data:{user:o}}),await a(),e.loading.hide()}catch(s){e.loading.hide(),n(s)}}))};return{fnGetUsers:a,fnSetAdmin:o,fnUserZones:s,fnDeleteUser:t}},N={__name:"userActions",props:["user"],setup(e){const{fnDeleteUser:n}=V();return(a,t)=>{const l=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l,{round:"",flat:"",icon:"delete",size:"sm",color:"red",onClick:t[0]||(t[0]=a=>(0,s.SU)(n)(e.user))})])}}},O=N,P=O;S()(N,"components",{QBtn:D.Z});a(9665);const Y={class:"zones row justify-center items-center q-gutter-x-sm"},j={__name:"userZones",props:["user"],setup(e){const n=e,{fnUserZones:a}=V(),l=((0,s.iH)([]),(0,o.Fl)((()=>{const e=n.user.zones;if(e&&e.length){const n=[];for(let a of e){const e=_.Us.value.findIndex((e=>e.deviceId===a));-1!==e&&n.push(_.Us.value[e])}return n}return[]})));return(0,o.bv)((async()=>{await(0,_.l4)()})),(n,r)=>{const i=(0,o.up)("q-chip"),c=(0,o.up)("q-icon");return(0,o.wg)(),(0,o.iD)("div",Y,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.value,(e=>((0,o.wg)(),(0,o.iD)("span",{key:e.deviceId},[(0,o.Wm)(i,{outline:"",icon:"map",size:"sm",color:"primary","text-color":"white"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.name),1)])),_:2},1024)])))),128)),(0,o._)("span",null,[(0,o.Wm)(c,{class:"cursor-pointer",size:"xs",name:"edit",color:"primary",onClick:r[0]||(r[0]=n=>(0,s.SU)(a)(e.user))})])])}}};var K=a(7691);const M=(0,u.Z)(j,[["__scopeId","data-v-7f31c2ae"]]),R=M;S()(j,"components",{QChip:K.Z,QIcon:U.Z});const B={__name:"usersTable",props:["rows","filter"],emits:["update:admin"],setup(e,{emit:n}){const a=[{name:"email",label:"E-mail",align:"center",field:"email",sortable:!0},{name:"name",label:"Name",align:"center",field:"name",sortable:!0},{name:"isAdmin",label:"isAdmin",align:"center",field:"isAdmin",sortable:!0},{name:"zones",label:"Zones",align:"center",field:"zones",sortable:!0},{name:"loginAt",label:"Last login",align:"center",field:"loginAt",sortable:!0},{name:"createdAt",label:"Created at",align:"center",field:"createdAt",sortable:!0},{name:"actions",label:"FN",align:"center"}];return(s,l)=>{const r=(0,o.up)("q-td"),i=(0,o.up)("q-icon"),c=(0,o.up)("q-tr"),u=(0,o.up)("q-table");return(0,o.wg)(),(0,o.j4)(u,{flat:"",columns:a,rows:e.rows,filter:e.filter,"wrap-cells":"true"},{body:(0,o.w5)((e=>[(0,o.Wm)(c,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{key:"email",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.row.email),1)])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"name",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.row.name),1)])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"isAdmin",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{class:"cursor-pointer",name:e.row.isAdmin?"check_circle":"block",color:e.row.isAdmin?"primary":"red-10",size:"16px",onClick:a=>n("update:admin",e.row)},null,8,["name","color","onClick"])])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"zones",class:"row justify-center",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(R,{user:e.row},null,8,["user"])])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"loginAt",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{time:e.row.loginAt},null,8,["time"])])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"createdAt",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{time:e.row.createdAt},null,8,["time"])])),_:2},1032,["props"]),(0,o.Wm)(r,{key:"actions",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{user:e.row},null,8,["user"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows","filter"])}}};var G=a(8939),L=a(3532),$=a(7220);const E=B,J=E;S()(B,"components",{QTable:G.Z,QTr:L.Z,QTd:$.Z,QIcon:U.Z});const X=e=>((0,o.dD)("data-v-46d5304f"),e=e(),(0,o.Cn)(),e),ee={class:"q-pa-md"},ne={class:"borderd"},ae={class:"q-px-lg q-py-sm row no-wrap items-center bg-grey-2"},oe={class:"row no-wrap items-cetner q-gutter-x-sm"},se=X((()=>(0,o._)("div",{class:"text-h6"},"User Management",-1))),te={__name:"UsersPage",setup(e){const{fnGetUsers:n,fnSetAdmin:a}=V(),t=(0,s.iH)("");return(0,o.bv)((async()=>{await n()})),(e,n)=>{const l=(0,o.up)("q-icon"),r=(0,o.up)("q-space"),i=(0,o.up)("q-input");return(0,o.wg)(),(0,o.iD)("div",ee,[(0,o._)("div",ne,[(0,o._)("div",ae,[(0,o._)("div",oe,[(0,o.Wm)(l,{name:"group",size:"24px",color:"primary"}),se]),(0,o.Wm)(r),(0,o.Wm)(i,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),borderless:"",dense:"",debounce:"300",placeholder:"Search",clearable:""},{append:(0,o.w5)((()=>[(0,o.Wm)(l,{class:"cursor-pointer",name:"search"})])),_:1},8,["modelValue"])]),(0,o.Wm)(J,{rows:(0,s.SU)(T),filter:t.value,"onUpdate:admin":(0,s.SU)(a)},null,8,["rows","filter","onUpdate:admin"])])])}}};var le=a(136),re=a(6611);const ie=(0,u.Z)(te,[["__scopeId","data-v-46d5304f"]]),ce=ie;S()(te,"components",{QIcon:U.Z,QSpace:le.Z,QInput:re.Z})}}]);
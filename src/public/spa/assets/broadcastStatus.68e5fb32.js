import{aD as te,v as N,r as I,o as M,aK as S,y as u,z as $,A as t,j as n,N as ae,O as Z,B as a,R as m,G as f,C as c,U as oe,aL as se,aM as ie,V as C,W as q,aN as le,D as p,aO as re,aP as de,aE as ce,K as A,P as ue,aQ as R,aR as me,aS as B,I as _,J as D,aT as U,L as F,aU as j,aV as G,aW as L,aX as O,F as E,aY as fe,H as V}from"./index.221aab42.js";import{Q as K}from"./QTooltip.35ace030.js";import{Q as ve}from"./QExpansionItem.15c5ebed.js";import{Q as pe}from"./QSelect.d6395dea.js";import{_ as _e,u as ge}from"./useQsysFunc.c0bc3773.js";import{f as T,b,u as ze}from"./useBarix.8d09650c.js";import{u as W}from"./useNotify.37ca9f9e.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";const he={class:"row no-wrap justify-between items-center"},ye={class:"row no-wrap items-center q-gutter-x-md"},xe=a("div",{class:"dialog-name"},"\uBC29\uC1A1\uC9C0\uC5ED\uC124\uC815",-1),we={class:"dialog-caption row no-wrap items-center cursor-pointer"},ke={__name:"setSigleChannel",props:["device","zone"],setup(e){const{fnNotiWarn:x,fnNotiError:g}=W(),{dialogRef:z,onDialogCancel:w,onDialogOK:l}=te(),o=e,i=N(),h=I([]),v=I(null),y=I(0),k=I(""),J=(r,d,s)=>{d(()=>{h.value=b.value.filter(Q=>Q.name.indexOf(r)>-1)})},X=async()=>{try{const r=await i.dialog({component:_e,componentProps:{title:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD",caption:`${o.device.name} \uC9C0\uC5ED\uC758 ${k.value} \uC9C0\uC5ED \uC774\uB984\uC744 \uBCC0\uACBD\uD569\uB2C8\uB2E4.`,name:k}}).onOk();i.loading.show(),await R.put("/devices/qsys/modifiedzonename",{deviceId:o.device.deviceId,zone:o.zone.Zone,name:r}),k.value=r,await S()}catch{g("\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{i.loading.hide()}},Y=async r=>{if(r!==null){const d=b.value.findIndex(P=>P._id===r),{data:s}=await R.get("/devices/qsys/existszone",{params:{id:r}});if(s&&s.value&&s.value.length)return s.value[0].ZoneStatus.findIndex(ne=>ne.destination===r)===o.zone.Zone-1?void 0:(v.value=null,x("\uB2E4\uB978 \uBC29\uC1A1 \uAD6C\uAC04\uC5D0\uC11C \uC774\uBBF8 \uC0AC\uC6A9\uC911\uC785\uB2C8\uB2E4"));const Q=b.value[d].ipaddress;await me({deviceId:o.device.deviceId,zone:o.zone.Zone,destination:r,ipaddress:Q}),await S()}},ee=()=>{B("zone:set:channel",{deviceId:o.device.deviceId,...o.zone,gain:y.value})};return M(async()=>{await Promise.all([T(),S()]),h.value=b.value,y.value=o.zone.gain,k.value=o.zone.name,o.zone.destination&&o.zone.destination._id&&(v.value=o.zone.destination._id)}),(r,d)=>(u(),$(ue,{ref_key:"dialogRef",ref:z},{default:t(()=>[n(ae,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"8px"}},{default:t(()=>[n(Z,null,{default:t(()=>{var s;return[a("div",he,[a("div",ye,[n(m,{name:"location_on",color:"primary",size:"1.5rem"}),a("div",null,[xe,a("div",we,[f(c(`${e.device.name} ${e.zone.Zone}. ${(s=k.value)!=null?s:"\uC774\uB984\uC5C6\uC74C"} \uCC44\uB110 `)+" ",1),n(m,{name:"edit",color:"primary",onClick:X})])])]),n(m,{class:"cursor-pointer",name:"refresh",size:"sm",color:"primary",onClick:ee},{default:t(()=>[n(K,null,{default:t(()=>[f("\uC0C8\uB85C\uACE0\uCE68")]),_:1})]),_:1})])]}),_:1}),n(Z,null,{default:t(()=>[n(pe,{filled:"",dense:"",clearable:"",modelValue:v.value,"onUpdate:modelValue":[d[0]||(d[0]=s=>v.value=s),Y],options:h.value,label:"\uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30 \uC120\uD0DD","option-value":"_id","option-label":"name","hide-selected":"","use-input":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:J},{option:t(s=>[n(oe,se(ie(s.itemProps)),{default:t(()=>[n(C,{avatar:""},{default:t(()=>[n(m,{name:"storage"})]),_:1}),n(C,null,{default:t(()=>[n(q,null,{default:t(()=>[f(c(s.opt.name),1)]),_:2},1024),n(q,{caption:""},{default:t(()=>[f(c(s.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),_:1}),n(Z,null,{default:t(()=>[a("div",null,[n(le,{modelValue:y.value,"onUpdate:modelValue":[d[2]||(d[2]=s=>y.value=s),d[3]||(d[3]=s=>p(re)({deviceId:e.device.deviceId,zone:e.zone.Zone,volume:s}))],filled:"",dense:"",label:"\uBCFC\uB968",type:"number"},{append:t(()=>[n(m,{class:"cursor-pointer",name:e.zone.mute?"volume_off":"volume_up",color:e.zone.mute?"red-10":"primary",onClick:d[1]||(d[1]=s=>p(de)({deviceId:e.device.deviceId,zone:e.zone.Zone,mute:!e.zone.mute}))},null,8,["name","color"])]),_:1},8,["modelValue"])])]),_:1}),n(ce,{align:"right"},{default:t(()=>[n(A,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:p(w)},null,8,["onClick"]),n(A,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:p(l)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},512))}};const Ce=e=>(j("data-v-03443116"),e=e(),G(),e),Ie={class:"floating-position q-gutter-x-xs row no-wrap items-center"},be={class:"floating-font"},Se={class:""},$e={key:0},qe={class:"column items-end text-caption"},Qe={class:"row q-gutter-x-xs cursor-pointer"},Ze=["href"],Ve={key:1},Be={class:"column items-end text-caption"},De=Ce(()=>a("div",null,"Local",-1)),Ne={class:"row q-gutter-x-xs"},Pe={__name:"statusDevice",props:["zone","device"],setup(e){ze();const x=N(),g=l=>l&&l.status?l.streamurl?"green":"yellow":"red",z=l=>{switch(l){case 1:case 2:return"bg-red text-white";case 3:case 4:return"bg-green-2"}},w=(l,o)=>{x.dialog({component:ke,componentProps:{device:l,zone:o}})};return(l,o)=>{var i;return u(),_("div",{class:U(["borderd q-pt-md q-px-sm q-pb-sm q-gutter-sx",e.zone.Active?z(e.zone.Priority):""]),style:{position:"relative","min-width":"100px"}},[a("div",Ie,[a("span",be,c(e.zone.gain),1),e.zone.mute?(u(),$(m,{key:0,name:"volume_off",color:"red-10"})):D("",!0),n(m,{class:"cursor-pointer",name:"settings",color:"primary",onClick:o[0]||(o[0]=h=>w(e.device,e.zone))})]),a("div",Se,[a("span",null,c(e.zone.Zone)+". ",1),a("span",{class:U(e.zone.name?"text-black text-bold":"text-grey-5")},c((i=e.zone.name)!=null?i:"\uC774\uB984\uC5C6\uC74C"),3)]),e.zone.destination?(u(),_("div",$e,[a("div",null,[n(F,{class:"q-my-sm"})]),a("div",qe,[a("div",Qe,[f(c(e.zone.destination.name)+" ",1),n(m,{name:"circle",color:g(e.zone.destination)},null,8,["color"])]),a("a",{href:`http://${e.zone.destination.ipaddress}`,target:"_blank"},c(e.zone.destination.ipaddress),9,Ze)])])):(u(),_("div",Ve,[a("div",null,[n(F,{class:"q-my-sm"})]),a("div",Be,[De,a("div",Ne,"Channel "+c(e.zone.Zone),1)])]))],2)}}};var Ae=H(Pe,[["__scopeId","data-v-03443116"]]);const Re=e=>(j("data-v-3a39030b"),e=e(),G(),e),Ue={key:0,class:"row no-wrap justify-start items-center q-gutter-x-sm header-font text-red-10"},Fe=Re(()=>a("span",null,"\uC9C0\uC5ED \uBC29\uC1A1\uC911",-1)),Le={class:"row q-pa-md q-gutter-sm"},Oe={__name:"broadcastStatus",setup(e){W();const{fnBroadcastCancel:x}=ge(),g=N(),z=l=>l.filter(o=>o.Active).length,w=l=>!!(V.value.isAdmin||V.value.zones&&V.value.zones.includes(l));return M(async()=>{try{g.loading.show(),await S(),await T()}catch{B("\uB370\uC774\uD130 \uCD08\uAE30\uD654 \uC624\uB958","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694.")}finally{g.loading.hide()}}),(l,o)=>(u(!0),_(E,null,L(p(fe),(i,h)=>(u(),$(ve,{key:h,"header-class":"bg-grey-1"},{header:t(()=>[n(C,{avatar:""},{default:t(()=>[n(m,{color:i.connected?"primary":"red-10",name:"location_on",size:"md"},null,8,["color"])]),_:2},1024),n(C,null,{default:t(()=>[n(q,null,{default:t(()=>[a("div",null,[f(c(i.name)+" ",1),w(i.deviceId)?(u(),$(m,{key:0,class:"q-ml-sm cursor-pointer",color:"grey",name:"refresh",onClick:O(v=>p(B)("zone:set:device",i.deviceId),["prevent","stop"])},null,8,["onClick"])):D("",!0)])]),_:2},1024),n(q,{caption:""},{default:t(()=>[f(c(i.ipaddress),1)]),_:2},1024)]),_:2},1024),n(C,{side:""},{default:t(()=>[z(i.ZoneStatus)?(u(),_("div",Ue,[f(c(z(i.ZoneStatus))+" ",1),Fe,n(m,{class:"cursor-pointer",name:"cancel",size:"xs",color:"red-10",onClick:O(v=>p(x)(i),["prevent","stop"])},{default:t(()=>[n(K,null,{default:t(()=>[f("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])])):D("",!0)]),_:2},1024)]),default:t(()=>[a("div",Le,[(u(!0),_(E,null,L(i.ZoneStatus,(v,y)=>(u(),_("div",{key:y},[n(Ae,{zone:v,device:i},null,8,["zone","device"])]))),128))])]),_:2},1024))),128))}};var Xe=H(Oe,[["__scopeId","data-v-3a39030b"]]);export{Xe as B};

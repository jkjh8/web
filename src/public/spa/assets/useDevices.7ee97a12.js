import{aL as O,aM as se,v as E,r as C,o as oe,aN as j,y as f,z as D,A as a,j as e,P as le,R,B as t,S as p,H as v,C as u,aO as ie,W as re,aP as ce,aQ as de,X as z,Y as M,aR as ue,aS as me,D as b,aT as fe,aU as pe,L as W,U as ve,aV as P,O as U,I as $,aW as _e,aX as he,aY as Q,aZ as ge,a_ as ye,J as _,a$ as K,ap as X,K as G,F as Y,b0 as H,M as J,b1 as xe,b2 as ke,b3 as we,b4 as Ce,b5 as be}from"./index.bb23b2be.js";import{Q as L}from"./QTooltip.6c77570c.js";import{Q as Ie}from"./QExpansionItem.6cc6b3f7.js";import{_ as qe}from"./plugin-vue_export-helper.21dcd24c.js";const Se={class:"row no-wrap justify-between items-center"},$e={class:"row no-wrap items-center q-gutter-x-md"},ze=t("div",{class:"dialog-name"},"\uBC29\uC1A1\uC9C0\uC5ED\uC124\uC815",-1),Qe={class:"dialog-caption row no-wrap items-center cursor-pointer"},Ze={class:"row justify-end q-px-sm q-gutter-x-xs items-center"},Be=t("div",{class:"text-caption"},"\uB3D9\uC77C\uC9C0\uC5ED\uB9CC \uD45C\uC2DC",-1),Ve={__name:"setSigleChannel",props:["device","zone"],setup(m){const{fnNotiWarn:g,fnNotiError:h}=O(),{dialogRef:Z,onDialogCancel:I,onDialogOK:y}=se(),i=m,q=E(),x=C([]),k=C(null),S=C(!1),n=C(0),d=C(!1),s=C(""),w=(l,c,r)=>{c(()=>{x.value=P.value.filter(A=>A.name.indexOf(l)>-1)})},o=async l=>{const{data:c}=await U.get(l?`/devices/barix/ip?ip=${l}`:"/devices/barix");return c.devices},B=async()=>{const l=S.value?i.device.ipaddress.split(".").slice(0,3).join("."):null;x.value=await o(l)},V=async()=>{if(!$.value.isAdmin)return g("\uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.","\uAD00\uB9AC\uC790\uC5D0\uAC8C \uBB38\uC758\uD558\uC138\uC694.");q.dialog({component:_e,componentProps:{title:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD",caption:`${i.device.name} \uC9C0\uC5ED\uC758 ${s.value} \uC9C0\uC5ED \uC774\uB984\uC744 \uBCC0\uACBD\uD569\uB2C8\uB2E4.`,name:s}}).onOk(async l=>{try{q.loading.show(),await U.put("/devices/qsys/modifiedzonename",{deviceId:i.device.deviceId,zone:i.zone.Zone,name:l}),s.value=l,await j()}catch(c){console.error(c),h("\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{q.loading.hide()}})},F=async l=>{let c="",r=3030;if(l!==null){const A=P.value.findIndex(T=>T._id===l),{data:N}=await U.get("/devices/qsys/existszone",{params:{id:l}});if(N&&N.value&&N.value.length)return N.value[0].ZoneStatus.findIndex(ne=>ne.destination===l)===i.zone.Zone-1?void 0:(k.value=null,g("\uB2E4\uB978 \uBC29\uC1A1 \uAD6C\uAC04\uC5D0\uC11C \uC774\uBBF8 \uC0AC\uC6A9\uC911\uC785\uB2C8\uB2E4"));c=P.value[A].ipaddress,r=P.value[A].port}await he({deviceId:i.device.deviceId,zone:i.zone.Zone,destination:l,ipaddress:c,port:r}),Q("qsys:devices",{})},te=()=>{Q("zone:set:channel",{deviceId:i.device.deviceId,...i.zone,gain:n.value,mute:d.value,name:i.device.name})},ae=async()=>{try{d.value=!d.value,await ge({deviceId:i.device.deviceId,zone:i.zone.Zone,mute:d.value,name:i.device.name}),Q("qsys:devices",{})}catch(l){console.error(l),h("\uBCFC\uB968 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}};return oe(async()=>{var l;await Promise.all([j()]),x.value=await o(),n.value=i.zone.gain,d.value=i.zone.mute,s.value=i.zone.name,k.value=((l=i.zone.destination)==null?void 0:l._id)||null}),(l,c)=>(f(),D(ve,{ref_key:"dialogRef",ref:Z},{default:a(()=>[e(le,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"8px"}},{default:a(()=>[e(R,null,{default:a(()=>{var r;return[t("div",Se,[t("div",$e,[e(p,{name:"location_on",color:"primary",size:"1.5rem"}),t("div",null,[ze,t("div",Qe,[v(u(`${m.device.name} ${m.zone.Zone}. ${(r=s.value)!=null?r:"\uC774\uB984\uC5C6\uC74C"} \uCC44\uB110 `)+" ",1),e(p,{name:"edit",color:"primary",onClick:V})])])]),e(p,{class:"cursor-pointer",name:"refresh",size:"sm",color:"primary",onClick:te},{default:a(()=>[e(L,null,{default:a(()=>[v("\uC0C8\uB85C\uACE0\uCE68")]),_:1})]),_:1})])]}),_:1}),e(R,null,{default:a(()=>[e(ie,{filled:"",dense:"",clearable:"",modelValue:k.value,"onUpdate:modelValue":[c[0]||(c[0]=r=>k.value=r),F],options:x.value,label:"\uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30 \uC120\uD0DD","option-value":"_id","option-label":"name","hide-selected":"","use-input":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:w},{option:a(r=>[e(re,ce(de(r.itemProps)),{default:a(()=>[e(z,{avatar:""},{default:a(()=>[e(p,{name:"storage"})]),_:1}),e(z,null,{default:a(()=>[e(M,null,{default:a(()=>[v(u(r.opt.name),1)]),_:2},1024),e(M,{caption:""},{default:a(()=>[v(u(r.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),t("div",Ze,[Be,e(ue,{modelValue:S.value,"onUpdate:modelValue":[c[1]||(c[1]=r=>S.value=r),B],size:"xs","left-label":"",dense:""},null,8,["modelValue"])])]),_:1}),e(R,null,{default:a(()=>[t("div",null,[e(me,{modelValue:n.value,"onUpdate:modelValue":[c[2]||(c[2]=r=>n.value=r),c[3]||(c[3]=r=>b(fe)({deviceId:m.device.deviceId,zone:m.zone.Zone,volume:r,name:m.device.name}))],filled:"",dense:"",label:"\uBCFC\uB968",type:"number",hint:"\uAC00\uC6A9\uBC94\uC704: -50dB ~ 10dB"},{append:a(()=>[e(p,{class:"cursor-pointer",name:d.value?"volume_off":"volume_up",color:d.value?"red-10":"primary",onClick:ae},null,8,["name","color"])]),_:1},8,["modelValue"])])]),_:1}),e(pe,{align:"right"},{default:a(()=>[e(W,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:b(I)},null,8,["onClick"]),e(W,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:b(y)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},512))}};const ee=m=>(ke("data-v-6ff02d88"),m=m(),we(),m),Ae=["href"],Ne={key:1},Pe={class:"text-caption text-red-10"},De={key:0,class:"row no-wrap justify-start items-center q-gutter-x-sm header-font text-red-10"},Me=ee(()=>t("span",null,"\uC9C0\uC5ED \uBC29\uC1A1\uC911",-1)),Re={class:"row q-pa-md q-gutter-sm"},Ue={class:"floating-position q-gutter-x-xs row no-wrap items-center"},Ge={class:"floating-font"},je={class:""},Le={key:0},Oe={class:"column items-end text-caption"},Ee={class:"row q-gutter-x-xs cursor-pointer"},Fe=["href"],Te={key:1},We={class:"column items-end text-caption"},Ke=ee(()=>t("div",null,"Local",-1)),Xe={class:"row q-gutter-x-xs"},Ye={__name:"broadcastStatus",setup(m){const{fnNotiInfo:g}=O(),{fnBroadcastCancel:h}=ye(),Z=E(),I=n=>n.filter(d=>d.Active).length,y=n=>!!($.value.isAdmin||$.value.zones&&$.value.zones.includes(n)),i=n=>{g(`${n.name}\uC758 \uC0C1\uD0DC \uAC12 \uAC31\uC2E0\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4.`,"\uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694."),Q("zone:get:active",{...n})},q=n=>{const{storage:d}=n;let s="";if(d){const{total:w,free:o}=d;Math.round(o/w*100)<=10&&(s=`\uC800\uC7A5\uC18C\uAC00 ${Math.round(o/w*100)}% \uB0A8\uC558\uC2B5\uB2C8\uB2E4.`)}return s},x=n=>n&&n.status?n.streamurl?"green":"yellow":"red",k=n=>{switch(n){case 1:case 2:return"bg-red text-white";case 3:case 4:return"bg-green-2"}},S=(n,d)=>{Z.dialog({component:Ve,componentProps:{device:n,zone:d}})};return(n,d)=>(f(!0),_(Y,null,K(b(xe),(s,w)=>(f(),D(Ie,{key:w,"header-class":"bg-grey-1","default-opened":""},{header:a(()=>[e(z,{avatar:""},{default:a(()=>[e(p,{color:s.connected?"primary":"red-10",name:"location_on",size:"md"},null,8,["color"])]),_:2},1024),e(z,null,{default:a(()=>[e(M,null,{default:a(()=>[t("div",null,[v(u(s.name)+" ",1),y(s.deviceId)?(f(),D(p,{key:0,class:"q-ml-sm cursor-pointer",color:"grey",name:"refresh",onClick:X(o=>i(s),["prevent","stop"])},{default:a(()=>[e(L,null,{default:a(()=>[v("\uC804\uCCB4 \uAC31\uC2E0")]),_:1})]),_:2},1032,["onClick"])):G("",!0)])]),_:2},1024),e(M,{caption:""},{default:a(()=>[b($).isAdmin?(f(),_("a",{key:0,href:`https://${s.ipaddress}`,target:"_blank"},u(s.ipaddress),9,Ae)):(f(),_("div",Ne,u(s.ipaddress),1))]),_:2},1024)]),_:2},1024),e(z,{side:""},{default:a(()=>[t("div",Pe,u(q(s)),1),I(s.ZoneStatus)?(f(),_("div",De,[v(u(I(s.ZoneStatus))+" ",1),Me,e(p,{class:"cursor-pointer",name:"cancel",size:"xs",color:"red-10",onClick:X(o=>b(h)(s),["prevent","stop"])},{default:a(()=>[e(L,null,{default:a(()=>[v("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])])):G("",!0)]),_:2},1024)]),default:a(()=>[t("div",Re,[(f(!0),_(Y,null,K(s.ZoneStatus,(o,B)=>{var V;return f(),_("div",{key:B},[t("div",{class:H(["borderd q-pt-md q-px-sm q-pb-sm q-gutter-sx",o.Active?k(o.Priority):""]),style:{position:"relative","min-width":"100px"}},[t("div",Ue,[t("span",Ge,u(o.gain),1),o.mute?(f(),D(p,{key:0,name:"volume_off",color:"red-10"})):G("",!0),e(p,{class:"cursor-pointer",name:"settings",color:"primary",onClick:F=>S(s,o)},null,8,["onClick"])]),t("div",je,[t("span",null,u(o.Zone)+". ",1),t("span",{class:H(o.name?"text-black text-bold":"text-grey-5")},u((V=o.name)!=null?V:"\uC774\uB984\uC5C6\uC74C"),3)]),o.destination?(f(),_("div",Le,[t("div",null,[e(J,{class:"q-my-sm"})]),t("div",Oe,[t("div",Ee,[v(u(o.destination.name)+" ",1),e(p,{name:"circle",color:x(o.destination)},null,8,["color"])]),t("a",{href:`http://${o.destination.ipaddress}`,target:"_blank"},u(o.destination.ipaddress),9,Fe)])])):(f(),_("div",Te,[t("div",null,[e(J,{class:"q-my-sm"})]),t("div",We,[Ke,t("div",Xe,"Channel "+u(o.Zone),1)])]))],2)])}),128))])]),_:2},1024))),128))}};var nt=qe(Ye,[["__scopeId","data-v-6ff02d88"]]);const st=()=>{const{fnNotiInfo:m,fnNotiError:g}=O(),h=E();return{fnGetAllDevices:async()=>{try{h.loading.show({message:"\uAE30\uAE30 \uBAA9\uB85D\uC744 \uAC00\uC838\uC624\uB294 \uC911\uC785\uB2C8\uB2E4."}),await j(),await Ce()}catch{g("\uAE30\uAE30 \uBAA9\uB85D\uC744 \uAC00\uC838\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{h.loading.hide()}},fnAllGetRefresh:()=>{for(let y of be.value)Q("zone:get:active",y)}}};export{nt as B,st as u};

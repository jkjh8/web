import{aU as L,aV as oe,v as O,r as I,o as le,a1 as E,y as u,z as q,A as a,j as e,O as ie,P as U,B as t,R as p,H as v,C as m,D as y,I as g,K as Q,aW as re,V as ce,aX as de,aY as ue,W as Z,X as R,aZ as me,a_ as pe,a$ as fe,L as K,S as ve,a2 as G,N as M,b0 as _e,b1 as he,b2 as A,b3 as ye,b4 as ge,b5 as xe,J as h,b6 as X,aT as j,F as H,b7 as J,M as Y,b8 as ke,b9 as be,ba as we,a3 as Ce,a0 as Ie}from"./index.89909c9f.js";import{Q as F}from"./QTooltip.b9435621.js";import{Q as qe}from"./QExpansionItem.ef297835.js";import{_ as Se}from"./plugin-vue_export-helper.21dcd24c.js";const $e={class:"row no-wrap justify-between items-center"},ze={class:"row no-wrap items-center q-gutter-x-md"},Qe=t("div",{class:"dialog-name"},"\uBC29\uC1A1\uC9C0\uC5ED\uC124\uC815",-1),Ze={class:"dialog-caption row no-wrap items-center cursor-pointer"},Ae={class:"row justify-end q-px-sm q-gutter-x-xs items-center"},Ve=t("div",{class:"text-caption"},"\uB3D9\uC77C\uC9C0\uC5ED\uB9CC \uD45C\uC2DC",-1),Be={__name:"setSigleChannel",props:["device","zone"],setup(f){const{fnNotiWarn:x,fnNotiError:_}=L(),{dialogRef:V,onDialogCancel:S,onDialogOK:k}=oe(),o=f,$=O(),b=I([]),w=I(null),z=I(!1),s=I(0),d=I(!1),l=I(""),C=(n,r,c)=>{r(()=>{b.value=G.value.filter(D=>D.name.indexOf(n)>-1)})},i=async n=>{const{data:r}=await M.get(n?`/devices/barix/ip?ip=${n}`:"/devices/barix");return r.devices},B=async()=>{const n=z.value?o.device.ipaddress.split(".").slice(0,3).join("."):null;b.value=await i(n)},N=async()=>{if(!g.value.isAdmin)return x("\uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.","\uAD00\uB9AC\uC790\uC5D0\uAC8C \uBB38\uC758\uD558\uC138\uC694.");$.dialog({component:_e,componentProps:{title:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD",caption:`${o.device.name} \uC9C0\uC5ED\uC758 ${l.value} \uC9C0\uC5ED \uC774\uB984\uC744 \uBCC0\uACBD\uD569\uB2C8\uB2E4.`,name:l}}).onOk(async n=>{try{$.loading.show(),await M.put("/devices/qsys/modifiedzonename",{deviceId:o.device.deviceId,zone:o.zone.Zone,name:n}),l.value=n,await E()}catch(r){console.error(r),_("\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{$.loading.hide()}})},T=async n=>{try{let r="",c=3030;if(n!==null){const D=G.value.findIndex(W=>W._id===n),{data:P}=await M.get("/devices/qsys/existszone",{params:{id:n}});if(P&&P.value&&P.value.length)return P.value[0].ZoneStatus.findIndex(se=>se.destination===n)===o.zone.Zone-1?void 0:(w.value=null,x("\uB2E4\uB978 \uBC29\uC1A1 \uAD6C\uAC04\uC5D0\uC11C \uC774\uBBF8 \uC0AC\uC6A9\uC911\uC785\uB2C8\uB2E4"));r=G.value[D].ipaddress,c=G.value[D].port}await M.put("/devices/qsys/zoneupdate",{deviceId:o.device.deviceId,zone:o.zone.Zone,destination:n,ipaddress:r,port:c}),await he()}catch(r){console.error("fnSelecBarix",r)}},te=()=>{A("zone:set:channel",{deviceId:o.device.deviceId,...o.zone,gain:s.value,mute:d.value,name:o.device.name})},ae=async n=>{try{s.value=n,await ye({deviceId:o.device.deviceId,zone:o.zone.Zone,volume:n,name:o.device.name}),A("qsys:devices",{})}catch(r){console.error(r),_("\uBCFC\uB968 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}},ne=async()=>{try{d.value=!d.value,await ge({deviceId:o.device.deviceId,zone:o.zone.Zone,mute:d.value,name:o.device.name}),A("qsys:devices",{})}catch(n){console.error(n),_("\uBCFC\uB968 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}};return le(async()=>{var n;await Promise.all([E()]),b.value=await i(),s.value=o.zone.gain,d.value=o.zone.mute,l.value=o.zone.name,w.value=((n=o.zone.destination)==null?void 0:n._id)||null}),(n,r)=>(u(),q(ve,{ref_key:"dialogRef",ref:V},{default:a(()=>[e(ie,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"8px"}},{default:a(()=>[e(U,null,{default:a(()=>{var c;return[t("div",$e,[t("div",ze,[e(p,{name:"location_on",color:"primary",size:"1.5rem"}),t("div",null,[Qe,t("div",Ze,[v(m(`${f.device.name} ${f.zone.Zone}. ${(c=l.value)!=null?c:"\uC774\uB984\uC5C6\uC74C"} \uCC44\uB110 `)+" ",1),y(g).isAdmin?(u(),q(p,{key:0,class:"cursor-pointer",name:"edit",color:"primary",onClick:N})):Q("",!0)])])]),e(p,{class:"cursor-pointer",name:"refresh",size:"sm",color:"primary",onClick:te},{default:a(()=>[e(F,null,{default:a(()=>[v("\uC0C8\uB85C\uACE0\uCE68")]),_:1})]),_:1})])]}),_:1}),y(g).isAdmin?(u(),q(U,{key:0},{default:a(()=>[e(re,{filled:"",dense:"",clearable:"",modelValue:w.value,"onUpdate:modelValue":[r[0]||(r[0]=c=>w.value=c),T],options:b.value,label:"\uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30 \uC120\uD0DD","option-value":"_id","option-label":"name","hide-selected":"","use-input":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:C},{option:a(c=>[e(ce,de(ue(c.itemProps)),{default:a(()=>[e(Z,{avatar:""},{default:a(()=>[e(p,{name:"storage"})]),_:1}),e(Z,null,{default:a(()=>[e(R,null,{default:a(()=>[v(m(c.opt.name),1)]),_:2},1024),e(R,{caption:""},{default:a(()=>[v(m(c.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),t("div",Ae,[Ve,e(me,{modelValue:z.value,"onUpdate:modelValue":[r[1]||(r[1]=c=>z.value=c),B],size:"xs","left-label":"",dense:""},null,8,["modelValue"])])]),_:1})):Q("",!0),e(U,null,{default:a(()=>[t("div",null,[e(pe,{modelValue:s.value,"onUpdate:modelValue":[r[2]||(r[2]=c=>s.value=c),r[3]||(r[3]=c=>ae(c))],filled:"",dense:"",label:"\uBCFC\uB968",type:"number",hint:"\uAC00\uC6A9\uBC94\uC704: -50dB ~ 10dB"},{append:a(()=>[e(p,{class:"cursor-pointer",name:d.value?"volume_off":"volume_up",color:d.value?"red-10":"primary",onClick:ne},null,8,["name","color"])]),_:1},8,["modelValue"])])]),_:1}),e(fe,{align:"right"},{default:a(()=>[e(K,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:y(S)},null,8,["onClick"]),e(K,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:y(k)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},512))}};const ee=f=>(be("data-v-0b5e105e"),f=f(),we(),f),Ne=["href"],De={key:1},Pe={class:"text-caption text-red-10"},Ge={key:0,class:"row no-wrap justify-start items-center q-gutter-x-sm header-font text-red-10"},Me=ee(()=>t("span",null,"\uC9C0\uC5ED \uBC29\uC1A1\uC911",-1)),Re={class:"row q-pa-md q-gutter-sm"},Ue={class:"floating-position q-gutter-x-xs row no-wrap items-center"},je={class:"floating-font"},Ee={class:""},Fe={key:0},Le={class:"column items-end text-caption"},Oe={class:"row q-gutter-x-xs cursor-pointer"},Te=["href"],We={key:1},Ke={class:"column items-end text-caption"},Xe=ee(()=>t("div",null,"Local",-1)),He={class:"row q-gutter-x-xs"},Je={__name:"broadcastStatus",setup(f){const{fnNotiInfo:x}=L(),{fnBroadcastCancel:_}=xe(),V=O(),S=s=>s.filter(d=>d.Active).length,k=s=>!!(g.value.isAdmin||g.value.zones&&g.value.zones.includes(s)),o=s=>{x(`${s.name}\uC758 \uC0C1\uD0DC \uAC12 \uAC31\uC2E0\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4.`,"\uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694."),A("zone:get:active",{...s})},$=s=>{const{storage:d}=s;let l="";if(d){const{total:C,free:i}=d;Math.round(i/C*100)<=10&&(l=`\uC800\uC7A5\uC18C\uAC00 ${Math.round(i/C*100)}% \uB0A8\uC558\uC2B5\uB2C8\uB2E4.`)}return l},b=s=>s&&s.status?s.streamurl?"green":"yellow":"red",w=s=>{switch(s){case 1:case 2:return"bg-red text-white";case 3:case 4:return"bg-green-2"}},z=(s,d)=>{V.dialog({component:Be,componentProps:{device:s,zone:d}})};return(s,d)=>(u(!0),h(H,null,X(y(ke),(l,C)=>(u(),q(qe,{key:C,"header-class":"bg-grey-1","default-opened":""},{header:a(()=>[e(Z,{avatar:""},{default:a(()=>[e(p,{color:l.connected?"primary":"red-10",name:"location_on",size:"md"},null,8,["color"])]),_:2},1024),e(Z,null,{default:a(()=>[e(R,null,{default:a(()=>[t("div",null,[v(m(l.name)+" ",1),k(l.deviceId)?(u(),q(p,{key:0,class:"q-ml-sm cursor-pointer",color:"grey",name:"refresh",onClick:j(i=>o(l),["prevent","stop"])},{default:a(()=>[e(F,null,{default:a(()=>[v("\uC804\uCCB4 \uAC31\uC2E0")]),_:1})]),_:2},1032,["onClick"])):Q("",!0)])]),_:2},1024),e(R,{caption:""},{default:a(()=>[y(g).isAdmin?(u(),h("div",{key:0,onClick:d[0]||(d[0]=j(()=>{},["stop"]))},[t("a",{href:`https://${l.ipaddress}`,target:"_blank"},m(l.ipaddress),9,Ne)])):(u(),h("div",De,m(l.ipaddress),1))]),_:2},1024)]),_:2},1024),e(Z,{side:""},{default:a(()=>[t("div",Pe,m($(l)),1),S(l.ZoneStatus)?(u(),h("div",Ge,[v(m(S(l.ZoneStatus))+" ",1),Me,e(p,{class:"cursor-pointer",name:"cancel",size:"xs",color:"red-10",onClick:j(i=>y(_)(l),["prevent","stop"])},{default:a(()=>[e(F,null,{default:a(()=>[v("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])])):Q("",!0)]),_:2},1024)]),default:a(()=>[t("div",Re,[(u(!0),h(H,null,X(l.ZoneStatus,(i,B)=>{var N;return u(),h("div",{key:B},[t("div",{class:J(["borderd q-pt-md q-px-sm q-pb-sm q-gutter-sx",i.Active?w(i.Priority):""]),style:{position:"relative","min-width":"100px"}},[t("div",Ue,[t("span",je,m(i.gain),1),i.mute?(u(),q(p,{key:0,name:"volume_off",color:"red-10"})):Q("",!0),e(p,{class:"cursor-pointer",name:"settings",color:"primary",onClick:T=>z(l,i)},null,8,["onClick"])]),t("div",Ee,[t("span",null,m(i.Zone)+". ",1),t("span",{class:J(i.name?"text-black text-bold":"text-grey-5")},m((N=i.name)!=null?N:"\uC774\uB984\uC5C6\uC74C"),3)]),i.destination?(u(),h("div",Fe,[t("div",null,[e(Y,{class:"q-my-sm"})]),t("div",Le,[t("div",Oe,[v(m(i.destination.name)+" ",1),e(p,{name:"circle",color:b(i.destination)},null,8,["color"])]),t("a",{href:`http://${i.destination.ipaddress}`,target:"_blank"},m(i.destination.ipaddress),9,Te)])])):(u(),h("div",We,[t("div",null,[e(Y,{class:"q-my-sm"})]),t("div",Ke,[Xe,t("div",He,"Channel "+m(i.Zone),1)])]))],2)])}),128))])]),_:2},1024))),128))}};var st=Se(Je,[["__scopeId","data-v-0b5e105e"]]);const ot=()=>{const{fnNotiInfo:f,fnNotiError:x}=L(),_=O();return{fnGetAllDevices:async()=>{try{_.loading.show({message:"\uAE30\uAE30 \uBAA9\uB85D\uC744 \uAC00\uC838\uC624\uB294 \uC911\uC785\uB2C8\uB2E4."}),await E(),await Ce()}catch{x("\uAE30\uAE30 \uBAA9\uB85D\uC744 \uAC00\uC838\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{_.loading.hide()}},fnAllGetRefresh:()=>{for(let k of Ie.value)A("zone:get:active",k)}}};export{st as B,ot as u};

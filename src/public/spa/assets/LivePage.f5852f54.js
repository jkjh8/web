import{h as Q,a2 as se,y as r,z as h,A as a,B as t,j as e,R as c,C as y,aP as ne,D as k,G as p,J as C,b4 as le,r as $,bV as ce,N as R,az as L,aQ as Z,o as U,bW as O,O as F,P as b,b0 as de,I as f,bX as ue,F as V,b3 as D,bY as N,aA as E,K as I,S as ae,b1 as G,b2 as K,bZ as me,b_ as _e,b$ as Y,c0 as pe,v as oe,k as fe,c as ve,V as H,aS as J,aT as ee,W as T,X as te,H as ge,aU as ye,a0 as he,aR as we}from"./index.ef6cc54e.js";import{Q as xe,a as be}from"./useFiles.7452f1a4.js";import{Q as ke}from"./QPage.8a30b0ac.js";import{Q as B}from"./QTooltip.2b01887b.js";import{Q as W}from"./QBadge.39eeaedc.js";import{u as qe}from"./useQsysFunc.fae52eac.js";import{Q as A}from"./QSelect.ab11255d.js";import{_ as Pe,f as Ce,a as $e,D as Se,b as ze}from"./useZones.b947ab49.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{u as Qe}from"./usePlayer.05de20b8.js";import{u as Me}from"./useTts.5df46780.js";import"./position-engine.f054ac5e.js";import"./QSlideTransition.9f1f7899.js";import"./DialogInput.b54278bc.js";import"./DialogConfirm.31a7aded.js";import"./QMenu.31f50568.js";import"./QTable.18858d55.js";import"./QExpansionItem.0c9342e8.js";import"./QTr.fe5a3b85.js";import"./QBanner.c77e9333.js";import"./useRules.b587b0cd.js";const Ie=Q("div",{class:"q-space"});var je=se({name:"QSpace",setup(){return()=>Ie}});const Te={class:"row fit items-center q-gutter-x-sm"},Ve={style:{"font-size":"1rem","font-weight":"500"}},De={class:"text-grey-8"},Ne={class:"row items-center q-gutter-x-sm text-grey-7"},Be={__name:"statusTree",setup(i){const{fnBroadcastCancel:u}=qe(),d=m=>{let v=0;for(let o=0;o<m.length;o++)m[o].Active&&(v+=1);return v};return(m,v)=>(r(),h(xe,{class:"custom-q-tree",nodes:k(le),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":a(o=>[t("div",Te,[e(c,{color:o.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),t("div",Ve,y(o.node.name),1),e(je),t("div",De,y(d(o.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),d(o.node.ZoneStatus)?(r(),h(c,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:ne(s=>k(u)(o.node),["prevent","stop"])},{default:a(()=>[e(B,null,{default:a(()=>[p("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):C("",!0)])]),"default-header":a(o=>[t("div",Ne,[t("div",null,[p(y(o.node.name?o.node.name:"no name")+" ",1),o.node.Active?(r(),h(W,{key:0,color:"green"},{default:a(()=>[p(" ONAIR ")]),_:1})):C("",!0)])])]),_:1},8,["nodes"]))}};$("");const re=i=>new Promise(async(u,d)=>{try{const m=await ce(i);if((await R.put("/broadcast/active",{devices:m.map(s=>({deviceId:s.deviceId,Zones:s.params.Zones}))})).data.active.length)return d("active");let{data:o}=await R.put("/broadcast/live",{...i,devices:m,zones:i.zones});u(o.idx)}catch(m){d(m)}});const ie=i=>(G("data-v-60981718"),i=i(),K(),i),Ae={class:"q-dialog-plugin bg-trans broadcast-popup"},Re={key:0},Le={class:"row justify-center q-pt-md text-grey"},Oe={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ze={style:{"text-align":"right"}},Ue=ie(()=>t("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Fe={style:{"text-align":"right"}},Ee=ie(()=>t("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Ge={class:"fit row justify-end"},Ke={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},We={__name:"DialogPageLive",props:["live"],emits:[...L.emits],setup(i,{emit:u}){const d=i,{dialogRef:m,onDialogCancel:v,onDialogOK:o}=L(),{fnNotiError:s}=Z(),g=$(!1),x=$(0);let w=null;const P=$(""),S=$(!1),M=async()=>{S.value=!0,O();try{P.value=await re(d.live)}catch(l){if(l==="active"&&d.live.Priority!==1)return s("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),v()}w=setInterval(()=>{x.value++,x.value>d.live.MaxPageTime&&_()},1e3),g.value=!0},_=async()=>{if(P.value)try{await R.get("/broadcast/stop",{params:{idx:P.value}})}catch(l){console.error(l)}g.value=!1,clearInterval(w),w=null,x.value=0,setTimeout(()=>{o()},1e3)};return U(()=>{S.value=!1,g.value=!1,O()}),(l,n)=>(r(),h(ae,{ref_key:"dialogRef",ref:m,persistent:""},{default:a(()=>[t("div",Ae,[e(c,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red-13",size:"md",onClick:k(v)},{default:a(()=>[e(B,null,{default:a(()=>[p("Close")]),_:1})]),_:1},8,["onClick"]),e(F,{class:"transBG"},{default:a(()=>[e(b,null,{default:a(()=>[t("div",{class:de(["q-pa-md row no-wrap text-grey-2",g.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[g.value?(r(),f("div",Re,[e(ue,{color:"primary",size:"14rem",thickness:8}),t("div",Le," \uBC29\uC1A1\uC911 "+y(x.value)+"\uCD08 \uACBD\uACFC ",1)])):C("",!0),t("div",Oe,[t("div",Ze,[Ue,t("div",null,y(i.live.Mode),1)]),t("div",Fe,[Ee,t("div",Ge,[(r(!0),f(V,null,D(i.live.zones,(z,j)=>(r(),h(W,{key:j,class:"q-ml-xs"},{default:a(()=>[p(y(z),1)]),_:2},1024))),128))])]),t("div",null,[(r(!0),f(V,null,D(k(N),(z,j)=>(r(),f("div",{key:j,style:{"text-align":"right"}},y(k(N)[j]),1))),128))])])],2)]),_:1}),e(E,null,{default:a(()=>[t("div",Ke,[e(I,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:M,disabled:S.value},{default:a(()=>[p("\uC2DC\uC791")]),_:1},8,["disabled"]),e(I,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:_},{default:a(()=>[p("\uC911\uC9C0")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var Xe=X(We,[["__scopeId","data-v-60981718"]]);const Ye=[Q("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var He=se({name:"QSpinnerClock",props:me,setup(i){const{cSize:u,classes:d}=_e(i);return()=>Q("svg",{class:d.value,width:u.value,height:u.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Ye)}});const Je=i=>(G("data-v-ba7ca014"),i=i(),K(),i),et={class:"q-dialog-plugin bg-trans broadcast-popup"},tt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},st=Je(()=>t("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),at={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},ot={style:{"font-size":"2rem"}},rt={class:"text-white description q-pa-md"},it={class:"fit row no-wrap justify-center q-gutter-x-sm"},nt={__name:"DialogPageMessage",props:["live"],setup(i){const u=i,d=new AbortController,{fnNotiError:m}=Z(),{dialogRef:v,onDialogCancel:o,onDialogOK:s}=L(),g=$(3),x=$(!1);let w=null;const P=$(!1),S=()=>{w&&clearInterval(w),d.abort(),o()},M=async()=>{try{g.value=0,clearInterval(w),P.value=!0,await re(u.live),s()}catch(_){_==="active"&&u.live.Priority!==1&&m("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),o()}};return U(async()=>{try{P.value=!1,O(),Y({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${u.live.file.base}`}),await pe(u.live,d)}catch(_){console.error(_)}x.value=!0,Y({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),w=setInterval(async()=>{g.value>0?g.value-=1:(clearInterval(w),M())},1e3)}),(_,l)=>(r(),h(ae,{ref_key:"dialogRef",ref:v,persistent:""},{default:a(()=>[t("div",et,[e(F,{class:"transBG"},{default:a(()=>[e(b,null,{default:a(()=>[t("div",tt,[e(c,{name:"mic",color:"primary",size:"md"}),st])]),_:1}),e(b,{style:{"min-height":"200px"}},{default:a(()=>[x.value?(r(),f("div",at,[e(He,{size:"md"}),t("span",ot,y(g.value),1)])):C("",!0),t("div",rt,[(r(!0),f(V,null,D(k(N),(n,z)=>(r(),f("div",{key:z},y(k(N)[z]),1))),128))])]),_:1}),e(E,null,{default:a(()=>[t("div",it,[x.value?(r(),h(I,{key:0,style:{width:"8rem"},color:"primary",disabled:P.value,onClick:l[0]||(l[0]=n=>M())},{default:a(()=>[p("\uC2DC\uC791")]),_:1},8,["disabled"])):C("",!0),e(I,{style:{width:"8rem"},color:"red-10",onClick:S},{default:a(()=>[p("\uCDE8\uC18C")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var lt=X(nt,[["__scopeId","data-v-ba7ca014"]]);const q=i=>(G("data-v-1f4f4018"),i=i(),K(),i),ct={class:"q-pa-sm row justify-center"},dt={class:"row no-wrap items-center q-gutter-x-xs"},ut=q(()=>t("div",null,"\uBC29\uC1A1\uBAA8\uB4DC",-1)),mt={class:"row no-wrap items-center q-gutter-x-sm"},_t=q(()=>t("div",null,"\uC6B0\uC120\uC21C\uC704",-1)),pt={class:"row no-wrap justify-between items-center"},ft={class:"row no-wrap justify-start items-center q-gutter-x-sm"},vt=q(()=>t("div",null,"\uCC60\uC784",-1)),gt={class:"row no-wrap justify-between items-center"},yt={class:"row no-wrap items-center q-gutter-x-xs"},ht=q(()=>t("div",null,"\uBC29\uC1A1\uAD6C\uAC04",-1)),wt=q(()=>t("span",null," \uC120\uD0DD\uB41C \uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),xt=[wt],bt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},kt=q(()=>t("div",null,"\uBC29\uC1A1\uC2DC\uAC04(\uCD08)",-1)),qt=q(()=>t("div",{class:"text-caption text-red",style:{"text-align":"right"}}," \uCD5C\uB300 \uBC29\uC1A1 \uC2DC\uAC04\uC740 4\uBD84(240\uCD08)\uC73C\uB85C \uC81C\uD55C \uB429\uB2C8\uB2E4. ",-1)),Pt={class:"row no-wrap justify-between items-center"},Ct={class:"row no-wrap justify-start items-center q-gutter-x-sm"},$t=q(()=>t("div",null,"\uD30C\uC77C",-1)),St={key:0,class:"bg-grey-2 q-pa-sm q-gutter-x-sm row no-wrap justify-between items-center",style:{"border-radius":"2px","min-height":"40px"}},zt={key:1,class:"bg-grey-2 q-pa-sm row justify-start items-center",style:{"border-radius":"2px",height:"40px"}},Qt=q(()=>t("span",null," \uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),Mt=[Qt],It={class:"row no-wrap justify-between items-center"},jt={class:"row no-wrap justify-between items-center q-gutter-x-xs"},Tt=q(()=>t("div",null,"TTS (Text to Speech)",-1)),Vt={class:"row no-wrap justify-between items-center"},Dt={key:0,class:"row no-wrap justify-between items-center q-gutter-x-sm"},Nt={class:"full-width q-px-sm q-mb-md"},Bt={__name:"pageLive",setup(i){const{fnPlayStart:u,fnPlayerStopClose:d}=Qe(),{fnNotiError:m}=Z(),{fnDeleteFile:v}=Me(),o=oe(),s=fe({Mode:"message",Preamble:"",Priority:3,MaxPageTime:30,Station:1,Preamble:"",file:null,devices:[],zones:[],MessageDelete:!0}),g=()=>{o.dialog({component:Pe,componentProps:{selected:s.devices}}).onOk(_=>{s.devices=_,s.zones=Ce(_)})},x=()=>{o.dialog({component:$e,componentProps:{file:s.file}}).onOk(_=>{s.file=_[0]})},w=()=>{he.value.ttsMode==="sapi"?o.dialog({component:Se,componentProps:{file:s.file}}).onOk(_=>{s.file=_}):o.dialog({component:ze,componentProps:{file:s.file}}).onOk(_=>{s.file=_}).onCancel(()=>{})},P=async()=>{await d(),await v(),s.file=null},S=ve({get(){return s.Preamble==="Chime ascending triple.wav"},set(){return s.Preamble?s.Preamble="":s.Preamble="Chime ascending triple.wav"}}),M=()=>{if(s.devices===null||s.devices.length===0)return m("\uBC29\uC1A1\uAD6C\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");if(s.Mode!=="live"&&(s.file===null||Object.keys(s.file).length===0))return m("\uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");s.Mode==="live"?o.dialog({component:Xe,componentProps:{live:s}}):o.dialog({component:lt,componentProps:{live:s}})};return(_,l)=>(r(),f("div",ct,[e(F,{flat:"",style:{width:"450px"}},{default:a(()=>[e(b,null,{default:a(()=>[t("div",dt,[e(c,{name:"podcasts",color:"primary",size:"sm"}),ut]),e(A,{modelValue:s.Mode,"onUpdate:modelValue":l[0]||(l[0]=n=>s.Mode=n),options:[{value:"tts",label:"TTS",icon:"record_voice_over"},{value:"live",label:"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",icon:"live_tv"},{value:"message",label:"\uBA54\uC2DC\uC9C0 \uC1A1\uCD9C",icon:"message"}],dense:"",filled:"","map-options":"","emit-value":""},{option:a(n=>[e(H,J(ee(n.itemProps)),{default:a(()=>[e(T,{avatar:""},{default:a(()=>[e(c,{name:n.opt.icon},null,8,["name"])]),_:2},1024),e(T,null,{default:a(()=>[e(te,null,{default:a(()=>[p(y(n.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),k(ge).em?(r(),h(b,{key:0},{default:a(()=>[t("div",mt,[e(c,{name:"info",color:"lime-10",size:"sm"}),_t]),e(A,{modelValue:s.Priority,"onUpdate:modelValue":l[1]||(l[1]=n=>s.Priority=n),dense:"",filled:"",options:[{value:1,label:"\uAE34\uAE09\uBC29\uC1A1",icon:"priority_high"},{value:3,label:"\uC77C\uBC18\uBC29\uC1A1",icon:"low_priority"}],"emit-value":"","map-options":""},{option:a(n=>[e(H,J(ee(n.itemProps)),{default:a(()=>[e(T,{avatar:""},{default:a(()=>[e(c,{name:n.opt.icon},null,8,["name"])]),_:2},1024),e(T,null,{default:a(()=>[e(te,null,{default:a(()=>[p(y(n.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})):C("",!0),e(b,null,{default:a(()=>[t("div",pt,[t("div",ft,[e(c,{name:"notifications_none",color:"green-10",size:"sm"}),vt]),e(ye,{modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=n=>S.value=n)},null,8,["modelValue"])])]),_:1}),e(b,{class:"q-gutter-y-sm"},{default:a(()=>[t("div",gt,[t("div",yt,[e(c,{name:"location_on",color:"primary",size:"sm"}),ht]),e(c,{class:"cursor-pointer q-mr-xs",name:"add_circle",color:"primary",size:"sm",onClick:g},{default:a(()=>[e(B,null,{default:a(()=>[p("\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD")]),_:1})]),_:1})]),s.zones&&s.zones.length?(r(),f("div",{key:0,class:"panel cursor-pointer q-py-sm q-px-sm q-gutter-x-sm row justify-start items-center",onClick:g},[(r(!0),f(V,null,D(s.zones,(n,z)=>(r(),h(W,{key:z},{default:a(()=>[p(y(n),1)]),_:2},1024))),128))])):(r(),f("div",{key:1,class:"panel cursor-pointer q-pa-sm row justify-start items-center",onClick:g},xt))]),_:1}),s.Mode==="live"?(r(),h(b,{key:1,class:"q-gutter-y-sm"},{default:a(()=>[t("div",bt,[e(c,{name:"timer",color:"pink-8",size:"sm"}),kt]),e(A,{modelValue:s.MaxPageTime,"onUpdate:modelValue":l[3]||(l[3]=n=>s.MaxPageTime=n),dense:"",filled:"",options:[30,60,90,120,150,180,210,240]},null,8,["modelValue"]),qt]),_:1})):C("",!0),s.Mode==="message"?(r(),h(b,{key:2,class:"q-gutter-y-sm"},{default:a(()=>[t("div",Pt,[t("div",Ct,[e(c,{name:"save",color:"primary",size:"sm"}),$t]),e(c,{class:"cursor-pointer",name:"add_circle",color:"primary",size:"sm",onClick:x})]),s.file?(r(),f("div",St,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"xs",onClick:l[4]||(l[4]=n=>k(u)(s.file))}),p(" "+y(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:l[5]||(l[5]=n=>s.file=null)})])):(r(),f("div",zt,Mt))]),_:1})):C("",!0),s.Mode==="tts"?(r(),h(b,{key:3,class:"q-gutter-y-sm"},{default:a(()=>[t("div",It,[t("div",jt,[e(c,{name:"volume_up",color:"primary",size:"sm"}),Tt]),e(c,{class:"cursor-pointer",color:"primary",name:"mic",size:"sm",onClick:w},{default:a(()=>[e(B,null,{default:a(()=>[p("\uC74C\uC131\uD569\uC131")]),_:1})]),_:1})]),t("div",Vt,[s.file?(r(),f("div",Dt,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"sm",onClick:l[6]||(l[6]=n=>k(u)(s.file))}),p(" "+y(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:P})])):(r(),f("div",{key:1,class:"bg-grey-2 q-pa-sm row justify-between items-center cursor-pointer",style:{"border-radius":"2px",height:"40px",width:"100%"},onClick:w},[t("div",null,[e(c,{name:"warning"}),p(" \uD569\uC131\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ")])]))])]),_:1})):C("",!0),e(E,null,{default:a(()=>[t("div",Nt,[e(I,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:M})])]),_:1})]),_:1})]))}};var At=X(Bt,[["__scopeId","data-v-1f4f4018"]]);const Rt={class:"borderd"},Lt={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},Ot={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},Zt=t("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),Ut={class:"q-pa-xs"},ms={__name:"LivePage",setup(i){const u=oe(),d=$(40);return U(async()=>{u.loading.show(),await we(),u.loading.hide()}),(m,v)=>(r(),h(ke,{class:"page"},{default:a(()=>[t("div",Rt,[t("div",Lt,[t("div",Ot,[e(c,{name:"mic",color:"primary",size:"md"}),Zt])]),t("div",null,[e(be,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=o=>d.value=o)},{before:a(()=>[t("div",Ut,[e(Be)])]),after:a(()=>[e(At)]),_:1},8,["modelValue"])])])]),_:1}))}};export{ms as default};

import{h as Q,a7 as se,b3 as re,y as l,z as w,A as s,B as t,j as e,S as c,C as v,aR as ie,D as C,H as d,K as S,b6 as ce,aT as A,aS as U,r as q,o as Z,b_ as O,P as F,R as k,b5 as de,J as _,b$ as ue,F as D,b4 as N,c0 as B,aZ as E,L as j,U as ae,c1 as oe,O as me,b7 as G,b8 as K,c2 as _e,c3 as pe,c4 as Y,c5 as fe,bq as ve,v as le,k as ge,c as ye,aU as R,W as H,aV as J,aW as ee,X as V,Y as te,I as he,aX as we,c6 as xe,a5 as be,a1 as ke}from"./index.9fbc72cd.js";import{Q as qe,a as Ce}from"./QTree.86e37068.js";import{Q as Pe}from"./QPage.adf6b65b.js";import{Q as L}from"./QTooltip.997f9a12.js";import{Q as W}from"./QBadge.7050ffc5.js";import{_ as $e,a as Se,D as ze,b as Qe}from"./DialogTtsVoiceware.a89a41be.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{u as Me}from"./usePlayer.bf8de01d.js";import"./QSlideTransition.3910032f.js";import"./QTable.7e6a138a.js";import"./QExpansionItem.44c95379.js";import"./QTr.3554b94a.js";import"./useFiles.53b10cbc.js";import"./QCircularProgress.8b255109.js";import"./QBanner.0cda373f.js";const je=Q("div",{class:"q-space"});var Ie=se({name:"QSpace",setup(){return()=>je}});const Te={class:"row fit items-center q-gutter-x-sm"},Ve={style:{"font-size":"1rem","font-weight":"500"}},De={class:"text-grey-8"},Ne={class:"row items-center q-gutter-x-sm text-grey-7"},Be={__name:"statusTree",setup(r){const{fnBroadcastCancel:u}=re(),m=g=>{let y=0;for(let n=0;n<g.length;n++)g[n].Active&&(y+=1);return y};return(g,y)=>(l(),w(qe,{class:"custom-q-tree",nodes:C(ce),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":s(n=>[t("div",Te,[e(c,{color:n.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),t("div",Ve,v(n.node.name),1),e(Ie),t("div",De,v(m(n.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),m(n.node.ZoneStatus)?(l(),w(c,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:ie(a=>C(u)(n.node),["prevent","stop"])},{default:s(()=>[e(L,null,{default:s(()=>[d("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):S("",!0)])]),"default-header":s(n=>[t("div",Ne,[t("div",null,[d(v(n.node.name?n.node.name:"no name")+" ",1),n.node.Active?(l(),w(W,{key:0,color:"green"},{default:s(()=>[d(" ONAIR ")]),_:1})):S("",!0)])])]),_:1},8,["nodes"]))}};const ne=r=>(G("data-v-c72659ba"),r=r(),K(),r),Le={class:"q-dialog-plugin bg-trans broadcast-popup"},Re={key:0},Ae={class:"row justify-center q-pt-md text-grey"},Oe={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ue={style:{"text-align":"right"}},Ze=ne(()=>t("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Fe={style:{"text-align":"right"}},Ee=ne(()=>t("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Ge={class:"fit row justify-end"},Ke={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},We={__name:"DialogPageLive",props:["live"],emits:[...A.emits],setup(r,{emit:u}){const m=r,{dialogRef:g,onDialogCancel:y,onDialogOK:n}=A(),{fnNotiError:a}=U(),p=q(!1),b=q(!1),h=q(0);let $=null;const x=q(""),z=q(!1),f=async()=>{z.value=!0,b.value=!0,O();try{x.value=await oe(m.live)}catch(o){if(b.value=!1,o==="active"&&m.live.Priority!==1)return a("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),y()}b.value=!1,$=setInterval(()=>{h.value++,h.value>m.live.MaxPageTime&&i()},1e3),p.value=!0},i=async()=>{if(x.value)try{await me.get("/broadcast/stop",{params:{idx:x.value}})}catch(o){console.error(o)}p.value=!1,clearInterval($),$=null,h.value=0,setTimeout(()=>{n()},1e3)};return Z(()=>{z.value=!1,p.value=!1,O()}),(o,I)=>(l(),w(ae,{ref_key:"dialogRef",ref:g,persistent:""},{default:s(()=>[t("div",Le,[e(c,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red-13",size:"md",onClick:C(y)},{default:s(()=>[e(L,null,{default:s(()=>[d("Close")]),_:1})]),_:1},8,["onClick"]),e(F,{class:"transBG"},{default:s(()=>[e(k,null,{default:s(()=>[t("div",{class:de(["q-pa-md row no-wrap text-grey-2",p.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[p.value?(l(),_("div",Re,[e(ue,{color:"primary",size:"14rem",thickness:8}),t("div",Ae," \uBC29\uC1A1\uC911 "+v(h.value)+"\uCD08 \uACBD\uACFC ",1)])):S("",!0),t("div",Oe,[t("div",Ue,[Ze,t("div",null,v(r.live.Mode),1)]),t("div",Fe,[Ee,t("div",Ge,[(l(!0),_(D,null,N(r.live.zones,(M,T)=>(l(),w(W,{key:T,class:"q-ml-xs"},{default:s(()=>[d(v(M),1)]),_:2},1024))),128))])]),t("div",null,[(l(!0),_(D,null,N(C(B),(M,T)=>(l(),_("div",{key:T,style:{"text-align":"right"}},v(C(B)[T]),1))),128))])])],2)]),_:1}),e(E,null,{default:s(()=>[t("div",Ke,[e(j,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:f,disabled:z.value},{default:s(()=>[d("\uC2DC\uC791")]),_:1},8,["disabled"]),e(j,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:i,disabled:b.value},{default:s(()=>[d("\uC911\uC9C0")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var Xe=X(We,[["__scopeId","data-v-c72659ba"]]);const Ye=[Q("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var He=se({name:"QSpinnerClock",props:_e,setup(r){const{cSize:u,classes:m}=pe(r);return()=>Q("svg",{class:m.value,width:u.value,height:u.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Ye)}});const Je=r=>(G("data-v-417f4f43"),r=r(),K(),r),et={class:"q-dialog-plugin bg-trans broadcast-popup"},tt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},st=Je(()=>t("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),at={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},ot={style:{"font-size":"2rem"}},lt={class:"text-white description q-pa-md"},nt={class:"fit row no-wrap justify-center q-gutter-x-sm"},rt={__name:"DialogPageMessage",props:["live"],setup(r){const u=r,m=new AbortController,{fnNotiError:g}=U(),{dialogRef:y,onDialogCancel:n,onDialogOK:a}=A(),p=q(3),b=q(!1);let h=null;const $=q(!1),x=q(!1),z=()=>{h&&clearInterval(h),m.abort(),n()},f=async()=>{try{p.value=0,clearInterval(h),$.value=!0,x.value=!0,await oe(u.live),a()}catch(i){x.value=!1,i==="active"&&u.live.Priority!==1&&g("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),n()}};return Z(async()=>{try{$.value=!1,x.value=!1,O(),Y({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${u.live.file.base}`}),await fe(u.live,m)}catch(i){console.error(i)}b.value=!0,Y({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),h=setInterval(async()=>{p.value>0?p.value-=1:(clearInterval(h),f())},1e3)}),(i,o)=>(l(),w(ae,{ref_key:"dialogRef",ref:y,persistent:""},{default:s(()=>[t("div",et,[e(F,{class:"transBG"},{default:s(()=>[e(k,null,{default:s(()=>[t("div",tt,[e(c,{name:"mic",color:"primary",size:"md"}),st])]),_:1}),e(k,{style:{"min-height":"200px"}},{default:s(()=>[b.value?(l(),_("div",at,[e(He,{size:"md"}),t("span",ot,v(p.value),1)])):S("",!0),t("div",lt,[(l(!0),_(D,null,N(C(B),(I,M)=>(l(),_("div",{key:M},v(C(B)[M]),1))),128))])]),_:1}),e(E,null,{default:s(()=>[t("div",nt,[b.value?(l(),w(j,{key:0,style:{width:"8rem"},color:"primary",disabled:$.value,onClick:o[0]||(o[0]=I=>f())},{default:s(()=>[d("\uC2DC\uC791")]),_:1},8,["disabled"])):S("",!0),e(j,{style:{width:"8rem"},color:"red-10",disabled:x.value,onClick:z},{default:s(()=>[d("\uCDE8\uC18C")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var it=X(rt,[["__scopeId","data-v-417f4f43"]]);const P=r=>(G("data-v-08b2faee"),r=r(),K(),r),ct={class:"q-pa-sm row justify-center"},dt={class:"row no-wrap items-center q-gutter-x-xs"},ut=P(()=>t("div",null,"\uBC29\uC1A1\uBAA8\uB4DC",-1)),mt={class:"row no-wrap items-center q-gutter-x-sm"},_t=P(()=>t("div",null,"\uC6B0\uC120\uC21C\uC704",-1)),pt={class:"row no-wrap justify-between items-center"},ft={class:"row no-wrap justify-start items-center q-gutter-x-sm"},vt=P(()=>t("div",null,"\uCC60\uC784",-1)),gt={class:"row no-wrap justify-between items-center"},yt={class:"row no-wrap items-center q-gutter-x-xs"},ht=P(()=>t("div",null,"\uBC29\uC1A1\uAD6C\uAC04",-1)),wt=P(()=>t("span",null," \uC120\uD0DD\uB41C \uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),xt=[wt],bt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},kt=P(()=>t("div",null,"\uBC29\uC1A1\uC2DC\uAC04(\uCD08)",-1)),qt=P(()=>t("div",{class:"text-caption text-red",style:{"text-align":"right"}}," \uCD5C\uB300 \uBC29\uC1A1 \uC2DC\uAC04\uC740 4\uBD84(240\uCD08)\uC73C\uB85C \uC81C\uD55C \uB429\uB2C8\uB2E4. ",-1)),Ct={class:"row no-wrap justify-between items-center"},Pt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},$t=P(()=>t("div",null,"\uD30C\uC77C",-1)),St={key:0,class:"bg-grey-3 q-pa-sm q-gutter-x-sm row no-wrap justify-between items-center",style:{"border-radius":"2px","min-height":"40px"}},zt={key:1,class:"bg-grey-3 q-pa-sm row justify-start items-center",style:{"border-radius":"2px",height:"40px"}},Qt=P(()=>t("span",null," \uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),Mt=[Qt],jt={class:"row no-wrap justify-between items-center"},It={class:"row no-wrap justify-between items-center q-gutter-x-xs"},Tt=P(()=>t("div",null,"TTS (Text to Speech)",-1)),Vt={class:"row no-wrap justify-between items-center"},Dt={key:0,class:"row no-wrap justify-between items-center q-gutter-x-sm"},Nt={class:"full-width q-px-sm q-mb-md"},Bt={__name:"pageLive",setup(r){const{fnPlayStart:u,fnPlayerStopClose:m}=Me(),{fnNotiError:g}=U(),{fnDeleteFile:y}=ve(),n=le(),a=ge({Mode:"message",Preamble:"",Priority:3,MaxPageTime:30,Station:1,Preamble:"",file:null,devices:[],zones:[],MessageDelete:!0}),p=()=>{n.dialog({component:$e,componentProps:{selected:a.devices}}).onOk(async f=>{a.devices=f,a.zones=await xe(f)})},b=()=>{n.dialog({component:Se,componentProps:{file:a.file}}).onOk(f=>{a.file=f[0]})},h=()=>{be.ttsMode==="sapi"?n.dialog({component:ze,componentProps:{file:a.file}}).onOk(f=>{a.file=f}):n.dialog({component:Qe,componentProps:{file:a.file}}).onOk(f=>{a.file=f}).onCancel(()=>{})},$=async()=>{await m(),await y(),a.file=null},x=ye({get(){return a.Preamble==="Chime ascending triple.wav"},set(){return a.Preamble?a.Preamble="":a.Preamble="Chime ascending triple.wav"}}),z=()=>{if(a.devices===null||a.devices.length===0)return g("\uBC29\uC1A1\uAD6C\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");if(a.Mode!=="live"&&(a.file===null||Object.keys(a.file).length===0))return g("\uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");a.Mode==="live"?n.dialog({component:Xe,componentProps:{live:a}}):n.dialog({component:it,componentProps:{live:a}})};return(f,i)=>(l(),_("div",ct,[e(F,{flat:"",style:{width:"450px"}},{default:s(()=>[e(k,null,{default:s(()=>[t("div",dt,[e(c,{name:"podcasts",color:"primary",size:"sm"}),ut]),e(R,{modelValue:a.Mode,"onUpdate:modelValue":i[0]||(i[0]=o=>a.Mode=o),options:[{value:"tts",label:"TTS",icon:"record_voice_over"},{value:"live",label:"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",icon:"live_tv"},{value:"message",label:"\uBA54\uC2DC\uC9C0 \uC1A1\uCD9C",icon:"message"}],dense:"",filled:"","map-options":"","emit-value":""},{option:s(o=>[e(H,J(ee(o.itemProps)),{default:s(()=>[e(V,{avatar:""},{default:s(()=>[e(c,{name:o.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:s(()=>[e(te,null,{default:s(()=>[d(v(o.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),C(he).em?(l(),w(k,{key:0},{default:s(()=>[t("div",mt,[e(c,{name:"info",color:"lime-10",size:"sm"}),_t]),e(R,{modelValue:a.Priority,"onUpdate:modelValue":i[1]||(i[1]=o=>a.Priority=o),dense:"",filled:"",options:[{value:1,label:"\uAE34\uAE09\uBC29\uC1A1",icon:"priority_high"},{value:3,label:"\uC77C\uBC18\uBC29\uC1A1",icon:"low_priority"}],"emit-value":"","map-options":""},{option:s(o=>[e(H,J(ee(o.itemProps)),{default:s(()=>[e(V,{avatar:""},{default:s(()=>[e(c,{name:o.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:s(()=>[e(te,null,{default:s(()=>[d(v(o.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})):S("",!0),e(k,null,{default:s(()=>[t("div",pt,[t("div",ft,[e(c,{name:"notifications_none",color:"green-10",size:"sm"}),vt]),e(we,{modelValue:x.value,"onUpdate:modelValue":i[2]||(i[2]=o=>x.value=o)},null,8,["modelValue"])])]),_:1}),e(k,{class:"q-gutter-y-sm"},{default:s(()=>[t("div",gt,[t("div",yt,[e(c,{name:"location_on",color:"primary",size:"sm"}),ht]),e(c,{class:"cursor-pointer q-mr-xs",name:"add_circle",color:"primary",size:"sm",onClick:p},{default:s(()=>[e(L,null,{default:s(()=>[d("\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD")]),_:1})]),_:1})]),a.zones&&a.zones.length?(l(),_("div",{key:0,class:"panel cursor-pointer q-py-sm q-px-sm q-gutter-x-sm row justify-start items-center",onClick:p},[(l(!0),_(D,null,N(a.zones,(o,I)=>(l(),w(W,{key:I},{default:s(()=>[d(v(o),1)]),_:2},1024))),128))])):(l(),_("div",{key:1,class:"panel cursor-pointer q-pa-sm row justify-start items-center",onClick:p},xt))]),_:1}),a.Mode==="live"?(l(),w(k,{key:1,class:"q-gutter-y-sm"},{default:s(()=>[t("div",bt,[e(c,{name:"timer",color:"pink-8",size:"sm"}),kt]),e(R,{modelValue:a.MaxPageTime,"onUpdate:modelValue":i[3]||(i[3]=o=>a.MaxPageTime=o),dense:"",filled:"",options:[30,60,90,120,150,180,210,240]},null,8,["modelValue"]),qt]),_:1})):S("",!0),a.Mode==="message"?(l(),w(k,{key:2,class:"q-gutter-y-sm"},{default:s(()=>[t("div",Ct,[t("div",Pt,[e(c,{name:"save",color:"primary",size:"sm"}),$t]),e(c,{class:"cursor-pointer",name:"add_circle",color:"primary",size:"sm",onClick:b})]),a.file?(l(),_("div",St,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"xs",onClick:i[4]||(i[4]=o=>C(u)(a.file))}),d(" "+v(a.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:i[5]||(i[5]=o=>a.file=null)})])):(l(),_("div",zt,Mt))]),_:1})):S("",!0),a.Mode==="tts"?(l(),w(k,{key:3,class:"q-gutter-y-sm"},{default:s(()=>[t("div",jt,[t("div",It,[e(c,{name:"volume_up",color:"primary",size:"sm"}),Tt]),e(c,{class:"cursor-pointer",color:"primary",name:"mic",size:"sm",onClick:h},{default:s(()=>[e(L,null,{default:s(()=>[d("\uC74C\uC131\uD569\uC131")]),_:1})]),_:1})]),t("div",Vt,[a.file?(l(),_("div",Dt,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"sm",onClick:i[6]||(i[6]=o=>C(u)(a.file))}),d(" "+v(a.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:$})])):(l(),_("div",{key:1,class:"bg-grey-3 q-pa-sm row justify-between items-center cursor-pointer",style:{"border-radius":"2px",height:"40px",width:"100%"},onClick:h},[t("div",null,[e(c,{name:"warning"}),d(" \uD569\uC131\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ")])]))])]),_:1})):S("",!0),e(E,null,{default:s(()=>[t("div",Nt,[e(j,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:z})])]),_:1})]),_:1})]))}};var Lt=X(Bt,[["__scopeId","data-v-08b2faee"]]);const Rt={class:"borderd"},At={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},Ot={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},Ut=t("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),Zt={class:"q-pa-xs"},ns={__name:"LivePage",setup(r){const u=le(),m=q(40);return Z(async()=>{u.loading.show(),await ke(),u.loading.hide()}),(g,y)=>(l(),w(Pe,{class:"page"},{default:s(()=>[t("div",Rt,[t("div",At,[t("div",Ot,[e(c,{name:"mic",color:"primary",size:"md"}),Ut])]),t("div",null,[e(Ce,{modelValue:m.value,"onUpdate:modelValue":y[0]||(y[0]=n=>m.value=n)},{before:s(()=>[t("div",Zt,[e(Be)])]),after:s(()=>[e(Lt)]),_:1},8,["modelValue"])])])]),_:1}))}};export{ns as default};

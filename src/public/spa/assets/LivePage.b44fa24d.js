import{u as Z,M as C,x as d,y as f,z as o,A as s,j as e,S as x,B as y,aX as X,C as n,E as h,I as w,aY as ee,H as v,bA as a,bB as te,F as z,aE as F,bC as E,r as M,o as j,bD as V,N as A,O as g,aT as se,bE as ae,aW as B,bF as P,aF as U,J as S,P as L,bG as N,bH as T,aU as G,aV as K,h as Q,a0 as oe,bI as ne,bJ as re,bK as O,bL as ie,bM as R,aR as le}from"./index.568a708f.js";import{Q as ce,a as de}from"./useFiles.0809c561.js";import{Q as ue}from"./QPage.f67a53cb.js";import{Q as me}from"./QSpace.3f8de521.js";import{Q as H}from"./QTooltip.68db7ee9.js";import{Q as J}from"./QBadge.5582eafb.js";import{_ as _e}from"./DialogConfirm.923d0832.js";import{_ as pe}from"./editSingleName.880af898.js";import{Q as D}from"./QSelect.7a7901d8.js";import{_ as fe,a as ve,b as ge,c as ye}from"./pageTts.7918df12.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import"./QMenu.9f8c2a36.js";import"./QSlideTransition.836fe4ae.js";import"./DialogInput.b3fdee73.js";import"./QTable.d70111e5.js";import"./QLinearProgress.3dc43b88.js";import"./QExpansionItem.cf10792c.js";import"./QTr.8e799559.js";import"./usePlayer.f6e19d70.js";import"./useTts.d4db473e.js";import"./useNotify.2c7e2d4a.js";const he=()=>{const i=Z();return{fnBroadcastCancel:l=>{i.dialog({component:_e,componentProps:{title:"\uBC29\uC1A1 \uCDE8\uC18C",icon:"cancel",iconColor:"red-10",caption:`${l.name} \uC9C0\uC5ED \uBC29\uC1A1\uC744 \uCDE8\uC18C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).onOk(async()=>{try{i.loading.show(),await C.get("/devices/qsys/cancel",{params:{device:{name:l.name,deviceId:l.deviceId,ipaddress:l.ipaddress,pageId:l.pageId}}}),i.loading.hide()}catch(r){console.error(r)}})},fnEditZoneName:(l,r)=>{i.dialog({component:pe,componentProps:{title:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD",caption:`${l.name} \uC9C0\uC5ED\uC758 ${r.name} \uC9C0\uC5ED \uC774\uB984\uC744 \uBCC0\uACBD\uD569\uB2C8\uB2E4.`,name:r.name}}).onOk(async t=>{try{i.loading.show(),await C.put("/devices/qsys/modifiedzonename",{deviceId:l.deviceId,zone:r.Zone,name:t})}catch(p){console.error(p),i.notify({type:"negative",icon:"warning",message:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",capion:"\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",position:"top"})}finally{i.loading.hide()}})}}};const we={class:"row fit items-center q-gutter-x-sm"},xe={style:{"font-size":"1rem","font-weight":"500"}},ke={class:"text-grey-8"},$e={class:"row items-center q-gutter-x-sm text-grey-7"},be={__name:"statusTree",setup(i){const{fnBroadcastCancel:u}=he(),c=l=>{let r=0;for(let t=0;t<l.length;t++)l[t].Active&&(r+=1);return r};return(l,r)=>(d(),f(ce,{class:"custom-q-tree",nodes:n(ee),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":o(t=>[s("div",we,[e(x,{color:t.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),s("div",xe,y(t.node.name),1),e(me),s("div",ke,y(c(t.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),c(t.node.ZoneStatus)?(d(),f(x,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:X(p=>n(u)(t.node),["prevent","stop"])},{default:o(()=>[e(H,null,{default:o(()=>[h("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):w("",!0)])]),"default-header":o(t=>[s("div",$e,[s("div",null,[h(y(t.node.name?t.node.name:"no name")+" ",1),t.node.Active?(d(),f(J,{key:0,color:"green"},{default:o(()=>[h(" ONAIR ")]),_:1})):w("",!0)])])]),_:1},8,["nodes"]))}},Ce={class:"row no-wrap justify-start items-center q-gutter-x-sm"},qe=s("div",{class:"font-main"},"\uBC29\uC1A1\uBAA8\uB4DC",-1),Ie={__name:"pageMode",setup(i){return(u,c)=>(d(),v(z,null,[s("div",Ce,[e(x,{name:"list",color:"primary",size:"md"}),qe]),e(D,{class:"q-mt-xs",modelValue:n(a).Mode,"onUpdate:modelValue":c[0]||(c[0]=l=>n(a).Mode=l),options:n(te),filled:"","map-options":"","emit-value":""},null,8,["modelValue","options"])],64))}},Qe={class:"row no-wrap justify-start items-center q-gutter-x-sm"},ze=s("div",{class:"font-main"},"\uC6B0\uC120\uC21C\uC704",-1),Me={__name:"pagePriority",setup(i){return(u,c)=>(d(),v(z,null,[s("div",Qe,[e(x,{name:"priority_high",color:"primary",size:"md"}),ze]),e(D,{class:"q-mt-xs",modelValue:n(a).Priority,"onUpdate:modelValue":c[0]||(c[0]=l=>n(a).Priority=l),filled:"",options:[{value:1,label:"EM"},{value:3,label:"Nomal"}],"emit-value":"","map-options":""},null,8,["modelValue"])],64))}},Se={class:"row no-wrap justify-start items-center q-gutter-x-sm"},Pe=s("div",{class:"card-name"},"\uBC29\uC1A1\uC2DC\uAC04(\uCD08)",-1),Ve=s("div",{class:"text-caption text-red",style:{"text-align":"right"}}," \uCD5C\uB300 \uBC29\uC1A1 \uC2DC\uAC04\uC740 4\uBD84(240\uCD08)\uC73C\uB85C \uC81C\uD55C \uB429\uB2C8\uB2E4. ",-1),Be={__name:"pageLive",setup(i){return(u,c)=>(d(),v(z,null,[s("div",Se,[e(x,{name:"timer",color:"primary",size:"sm"}),Pe]),e(D,{modelValue:n(a).MaxPageTime,"onUpdate:modelValue":c[0]||(c[0]=l=>n(a).MaxPageTime=l),filled:"",options:[30,60,90,120,150,180,210,240]},null,8,["modelValue"]),Ve],64))}};const W=i=>(G("data-v-08f7dd34"),i=i(),K(),i),Ne={class:"q-dialog-plugin broadcast-popup"},Ze={key:0},je={class:"row justify-center q-pt-md text-grey"},Ae={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ue={style:{"text-align":"right"}},De=W(()=>s("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Te={style:{"text-align":"right"}},Oe=W(()=>s("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Re={class:"fit row justify-end"},Fe={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},Ee={__name:"pageLive",setup(i){const{dialogRef:u,onDialogCancel:c,onDialogOK:l}=F(),{fnZoneActive:r}=E(),t=M(!1),p=M(0);let _=null;const q=async()=>{t.value=!0;try{V();const m=await N(a.devices),I=await C.put("/broadcast/active",{devices:m.map(b=>({deviceId:b.deviceId,Zones:b.params.Zones}))});if(console.log(I),I&&I.active)return r();const $=await C.put("/broadcast/live",{...a,devices:m,zones:a.zones});T.value=$.data.idx}catch(m){console.error(m)}_=setInterval(()=>{p.value++},1e3)},k=async()=>{try{const m=await C.get("/broadcast/stop",{params:{idx:T.value}});console.log(m)}catch(m){console.error(m)}t.value=!1,clearInterval(_),_=null,p.value=0};return j(()=>{V()}),(m,I)=>(d(),f(L,{ref_key:"dialogRef",ref:u,persistent:""},{default:o(()=>[s("div",Ne,[e(x,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red",size:"md",onClick:n(c)},{default:o(()=>[e(H,null,{default:o(()=>[h("Close")]),_:1})]),_:1},8,["onClick"]),e(A,{class:"transBG"},{default:o(()=>[e(g,null,{default:o(()=>[s("div",{class:se(["q-pa-md row no-wrap text-grey-2",t.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[t.value?(d(),v("div",Ze,[e(ae,{color:"primary",size:"14rem",thickness:8}),s("div",je," \uBC29\uC1A1\uC911 "+y(p.value)+"\uCD08 \uACBD\uACFC ",1)])):w("",!0),s("div",Ae,[s("div",Ue,[De,s("div",null,y(n(a).Mode),1)]),s("div",Te,[Oe,s("div",Re,[(d(!0),v(z,null,B(n(a).zones,($,b)=>(d(),f(J,{key:b,class:"q-ml-xs"},{default:o(()=>[h(y($),1)]),_:2},1024))),128))])]),s("div",null,[(d(!0),v(z,null,B(n(P),($,b)=>(d(),v("div",{key:b,style:{"text-align":"right"}},y(n(P)[b]),1))),128))])])],2)]),_:1}),e(U,null,{default:o(()=>[s("div",Fe,[e(S,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:q},{default:o(()=>[h("\uC2DC\uC791")]),_:1}),e(S,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:k},{default:o(()=>[h("\uC911\uC9C0")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var Le=Y(Ee,[["__scopeId","data-v-08f7dd34"]]);const Ge=[Q("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),Q("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[Q("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var Ke=oe({name:"QSpinnerClock",props:ne,setup(i){const{cSize:u,classes:c}=re(i);return()=>Q("svg",{class:c.value,width:u.value,height:u.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},Ge)}});const He=i=>(G("data-v-4059b4d8"),i=i(),K(),i),Je={class:"q-dialog-plugin broadcast-popup"},Ye={class:"row no-wrap justify-start items-center q-gutter-x-sm"},We=He(()=>s("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),Xe={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},et={style:{"font-size":"2rem"}},tt={class:"text-white description q-pa-md"},st={class:"fit row no-wrap justify-center q-gutter-x-sm"},at={__name:"pageMessage",setup(i){const u=new AbortController,{dialogRef:c,onDialogCancel:l,onDialogOK:r}=F(),t=M(3),p=M(!1);let _=null;const q=()=>{_&&clearInterval(_),u.abort(),l()};return j(async()=>{try{V(),O({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${a.file.base}`}),await ie(u)}catch(k){console.error(k)}p.value=!0,O({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),_=setInterval(()=>{t.value>0?t.value-=1:(clearInterval(_),r(a))},1e3)}),(k,m)=>(d(),f(L,{ref_key:"dialogRef",ref:c,persistent:""},{default:o(()=>[s("div",Je,[e(A,{class:"transBG"},{default:o(()=>[e(g,null,{default:o(()=>[s("div",Ye,[e(x,{name:"mic",color:"primary",size:"md"}),We])]),_:1}),e(g,{style:{"min-height":"200px"}},{default:o(()=>[p.value?(d(),v("div",Xe,[e(Ke,{size:"md"}),s("span",et,y(t.value),1)])):w("",!0),s("div",tt,[(d(!0),v(z,null,B(n(P),(I,$)=>(d(),v("div",{key:$},y(n(P)[$]),1))),128))])]),_:1}),e(U,null,{default:o(()=>[s("div",st,[p.value?(d(),f(S,{key:0,style:{width:"8rem"},color:"primary",onClick:m[0]||(m[0]=I=>n(r)(n(a)))},{default:o(()=>[h("\uC2DC\uC791")]),_:1})):w("",!0),e(S,{style:{width:"8rem"},color:"red-10",onClick:q},{default:o(()=>[h("\uCDE8\uC18C")]),_:1})])]),_:1})]),_:1})])]),_:1},512))}};var ot=Y(at,[["__scopeId","data-v-4059b4d8"]]);const nt={class:"full-width q-px-sm q-mb-md"},rt={__name:"pageStart",props:["zones"],setup(i){const u=i,{fnNoZones:c,fnNoFile:l,fnZoneActive:r}=E(),t=Z(),p=()=>{if(a.devices===null||a.devices.length===0)return c();if(a.Mode!=="live"&&(a.file===null||Object.keys(a.file).length===0))return l();switch(a.Mode){case"live":t.dialog({component:Le,componentProps:{zones:u.zones}});break;case"message":case"tts":t.dialog({component:ot}).onOk(async _=>{const q=await N(_.devices),k=await C.put("/broadcast/active",{devices:q.map(m=>({deviceId:m.deviceId,Zones:m.params.Zones}))});k&&k.active&&(r(),await R()),await C.put("/broadcast/live/message",{..._,devices:await N(_.devices),zones:a.zones})}).onCancel(async()=>{await R()});break}};return(_,q)=>(d(),v("div",nt,[e(S,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:p})]))}},it={class:"borderd"},lt={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-2"},ct={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},dt=s("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),ut={class:"q-pa-xs"},mt={class:"q-pa-sm row justify-center"},Bt={__name:"LivePage",setup(i){const u=Z(),c=M(40);return j(async()=>{u.loading.show(),await le(),u.loading.hide()}),(l,r)=>(d(),f(ue,{class:"page"},{default:o(()=>[s("div",it,[s("div",lt,[s("div",ct,[e(x,{name:"mic",color:"primary",size:"md"}),dt])]),s("div",null,[e(de,{modelValue:c.value,"onUpdate:modelValue":r[5]||(r[5]=t=>c.value=t)},{before:o(()=>[s("div",ut,[e(be)])]),after:o(()=>[s("div",mt,[e(A,{flat:"",style:{width:"450px"}},{default:o(()=>[e(g,null,{default:o(()=>[e(Ie)]),_:1}),e(g,null,{default:o(()=>[e(Me)]),_:1}),e(g,null,{default:o(()=>[e(fe,{preamble:n(a).Preamble,"onUpdate:value":r[0]||(r[0]=t=>n(a).Preamble=t)},null,8,["preamble"])]),_:1}),e(g,null,{default:o(()=>[e(ve,{devices:n(a).devices,zones:n(a).zones,"onUpdate:devices":r[1]||(r[1]=t=>n(a).devices=t),"onUpdate:zones":r[2]||(r[2]=t=>n(a).zones=t)},null,8,["devices","zones"])]),_:1}),n(a).Mode==="live"?(d(),f(g,{key:0},{default:o(()=>[e(Be)]),_:1})):w("",!0),n(a).Mode==="message"?(d(),f(g,{key:1},{default:o(()=>[e(ge,{file:n(a).file,"onUpdate:value":r[3]||(r[3]=t=>n(a).file=t)},null,8,["file"])]),_:1})):w("",!0),n(a).Mode==="tts"?(d(),f(g,{key:2},{default:o(()=>[e(ye,{file:n(a).file,"onUpdate:value":r[4]||(r[4]=t=>n(a).file=t)},null,8,["file"])]),_:1})):w("",!0),e(U,null,{default:o(()=>[e(rt)]),_:1})]),_:1})])]),_:1},8,["modelValue"])])])]),_:1}))}};export{Bt as default};

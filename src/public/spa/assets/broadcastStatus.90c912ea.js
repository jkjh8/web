import{aF as ne,A as M,r as S,o as W,aO as Q,C as m,D as Z,E as n,j as t,S as ae,U as V,G as a,V as f,K as p,H as d,Y as oe,aP as se,aQ as ie,Z as I,_ as B,aR as le,I as w,aS as re,aT as de,aG as ce,O as E,W as ue,aU as O,aV as me,aW as D,M as h,N as A,aX as R,P as G,aY as K,aZ as Y,a_ as L,a$ as j,F as T,b0 as fe,L as P}from"./index.2e86d1d2.js";import{Q as F}from"./QTooltip.d2b37a52.js";import{Q as ve}from"./QExpansionItem.dc3c5772.js";import{Q as pe}from"./QSelect.a0078ef7.js";import{_ as _e,u as ge}from"./useQsysFunc.498b4464.js";import{f as H,b as q,u as he}from"./useBarix.7d19e255.js";import{u as X}from"./useNotify.8c96ffc8.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";const ze={class:"row no-wrap justify-between items-center"},ye={class:"row no-wrap items-center q-gutter-x-md"},xe=a("div",{class:"dialog-name"},"\uBC29\uC1A1\uC9C0\uC5ED\uC124\uC815",-1),we={class:"dialog-caption row no-wrap items-center cursor-pointer"},ke={__name:"setSigleChannel",props:["device","zone"],setup(e){const{fnNotiWarn:k,fnNotiError:b}=X(),{dialogRef:C,onDialogCancel:z,onDialogOK:r}=ne(),o=e,_=M(),y=S([]),l=S(null),v=S(0),s=S(""),x=(c,u,i)=>{u(()=>{y.value=q.value.filter(N=>N.name.indexOf(c)>-1)})},g=async()=>{try{const c=await _.dialog({component:_e,componentProps:{title:"\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD",caption:`${o.device.name} \uC9C0\uC5ED\uC758 ${s.value} \uC9C0\uC5ED \uC774\uB984\uC744 \uBCC0\uACBD\uD569\uB2C8\uB2E4.`,name:s}}).onOk();_.loading.show(),await O.put("/devices/qsys/modifiedzonename",{deviceId:o.device.deviceId,zone:o.zone.Zone,name:c}),s.value=c,await Q()}catch{b("\uC9C0\uC5ED \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}finally{_.loading.hide()}},$=async c=>{if(c!==null){const u=q.value.findIndex(U=>U._id===c),{data:i}=await O.get("/devices/qsys/existszone",{params:{id:c}});if(i&&i.value&&i.value.length)return i.value[0].ZoneStatus.findIndex(te=>te.destination===c)===o.zone.Zone-1?void 0:(l.value=null,k("\uB2E4\uB978 \uBC29\uC1A1 \uAD6C\uAC04\uC5D0\uC11C \uC774\uBBF8 \uC0AC\uC6A9\uC911\uC785\uB2C8\uB2E4"));const N=q.value[u].ipaddress;await me({deviceId:o.device.deviceId,zone:o.zone.Zone,destination:c,ipaddress:N}),await Q()}},ee=()=>{D("zone:set:channel",{deviceId:o.device.deviceId,...o.zone,gain:v.value})};return W(async()=>{await Promise.all([H(),Q()]),y.value=q.value,v.value=o.zone.gain,s.value=o.zone.name,o.zone.destination&&o.zone.destination._id&&(l.value=o.zone.destination._id)}),(c,u)=>(m(),Z(ue,{ref_key:"dialogRef",ref:C},{default:n(()=>[t(ae,{class:"q-dialog-plugin bg-trans",style:{"border-radius":"8px"}},{default:n(()=>[t(V,null,{default:n(()=>{var i;return[a("div",ze,[a("div",ye,[t(f,{name:"location_on",color:"primary",size:"1.5rem"}),a("div",null,[xe,a("div",we,[p(d(`${e.device.name} ${e.zone.Zone}. ${(i=s.value)!=null?i:"\uC774\uB984\uC5C6\uC74C"} \uCC44\uB110 `)+" ",1),t(f,{name:"edit",color:"primary",onClick:g})])])]),t(f,{class:"cursor-pointer",name:"refresh",size:"sm",color:"primary",onClick:ee},{default:n(()=>[t(F,null,{default:n(()=>[p("\uC0C8\uB85C\uACE0\uCE68")]),_:1})]),_:1})])]}),_:1}),t(V,null,{default:n(()=>[t(pe,{filled:"",dense:"",clearable:"",modelValue:l.value,"onUpdate:modelValue":[u[0]||(u[0]=i=>l.value=i),$],options:y.value,label:"\uB124\uD2B8\uC6CC\uD06C \uC218\uC2E0\uAE30 \uC120\uD0DD","option-value":"_id","option-label":"name","hide-selected":"","use-input":"","fill-input":"","input-debounce":"0","emit-value":"","map-options":"",onFilter:x},{option:n(i=>[t(oe,se(ie(i.itemProps)),{default:n(()=>[t(I,{avatar:""},{default:n(()=>[t(f,{name:"storage"})]),_:1}),t(I,null,{default:n(()=>[t(B,null,{default:n(()=>[p(d(i.opt.name),1)]),_:2},1024),t(B,{caption:""},{default:n(()=>[p(d(i.opt.ipaddress),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),_:1}),t(V,null,{default:n(()=>[a("div",null,[t(le,{modelValue:v.value,"onUpdate:modelValue":[u[2]||(u[2]=i=>v.value=i),u[3]||(u[3]=i=>w(re)({deviceId:e.device.deviceId,zone:e.zone.Zone,volume:i}))],filled:"",dense:"",label:"\uBCFC\uB968",type:"number",hint:"\uAC00\uC6A9\uBC94\uC704: -50dB ~ 10dB"},{append:n(()=>[t(f,{class:"cursor-pointer",name:e.zone.mute?"volume_off":"volume_up",color:e.zone.mute?"red-10":"primary",onClick:u[1]||(u[1]=i=>w(de)({deviceId:e.device.deviceId,zone:e.zone.Zone,mute:!e.zone.mute}))},null,8,["name","color"])]),_:1},8,["modelValue"])])]),_:1}),t(ce,{align:"right"},{default:n(()=>[t(E,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:w(z)},null,8,["onClick"]),t(E,{round:"",flat:"","no-caps":"",color:"primary",icon:"check_circle",onClick:w(r)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},512))}};const Ce=e=>(K("data-v-64061b9c"),e=e(),Y(),e),Ie={class:"floating-position q-gutter-x-xs row no-wrap items-center"},be={class:"floating-font"},$e={class:""},Se={key:0},qe={class:"column items-end text-caption"},Qe={class:"row q-gutter-x-xs cursor-pointer"},Ze=["href"],Be={key:1},Ne={class:"column items-end text-caption"},Ve=Ce(()=>a("div",null,"Local",-1)),Pe={class:"row q-gutter-x-xs"},De={__name:"statusDevice",props:["zone","device"],setup(e){he();const k=M(),b=r=>r&&r.status?r.streamurl?"green":"yellow":"red",C=r=>{switch(r){case 1:case 2:return"bg-red text-white";case 3:case 4:return"bg-green-2"}},z=(r,o)=>{k.dialog({component:ke,componentProps:{device:r,zone:o}})};return(r,o)=>{var _;return m(),h("div",{class:R(["borderd q-pt-md q-px-sm q-pb-sm q-gutter-sx",e.zone.Active?C(e.zone.Priority):""]),style:{position:"relative","min-width":"100px"}},[a("div",Ie,[a("span",be,d(e.zone.gain),1),e.zone.mute?(m(),Z(f,{key:0,name:"volume_off",color:"red-10"})):A("",!0),t(f,{class:"cursor-pointer",name:"settings",color:"primary",onClick:o[0]||(o[0]=y=>z(e.device,e.zone))})]),a("div",$e,[a("span",null,d(e.zone.Zone)+". ",1),a("span",{class:R(e.zone.name?"text-black text-bold":"text-grey-5")},d((_=e.zone.name)!=null?_:"\uC774\uB984\uC5C6\uC74C"),3)]),e.zone.destination?(m(),h("div",Se,[a("div",null,[t(G,{class:"q-my-sm"})]),a("div",qe,[a("div",Qe,[p(d(e.zone.destination.name)+" ",1),t(f,{name:"circle",color:b(e.zone.destination)},null,8,["color"])]),a("a",{href:`http://${e.zone.destination.ipaddress}`,target:"_blank"},d(e.zone.destination.ipaddress),9,Ze)])])):(m(),h("div",Be,[a("div",null,[t(G,{class:"q-my-sm"})]),a("div",Ne,[Ve,a("div",Pe,"Channel "+d(e.zone.Zone),1)])]))],2)}}};var Ae=J(De,[["__scopeId","data-v-64061b9c"]]);const Fe=e=>(K("data-v-c18dfba6"),e=e(),Y(),e),Me={class:"text-caption text-red-10"},Ue={key:0,class:"row no-wrap justify-start items-center q-gutter-x-sm header-font text-red-10"},Ee=Fe(()=>a("span",null,"\uC9C0\uC5ED \uBC29\uC1A1\uC911",-1)),Oe={class:"row q-pa-md q-gutter-sm"},Re={__name:"broadcastStatus",setup(e){const{fnNotiInfo:k,fnNotiError:b}=X(),{fnBroadcastCancel:C}=ge(),z=M(),r=l=>l.filter(v=>v.Active).length,o=l=>!!(P.value.isAdmin||P.value.zones&&P.value.zones.includes(l)),_=l=>{k(`${l.name}\uC758 \uC804\uCCB4 \uC124\uC815 \uAC12 \uAC31\uC2E0\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4.`,"\uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694."),D("zone:set:device",l.deviceId)},y=l=>{const{storage:v}=l;let s="";if(v){const{total:x,free:g}=v;Math.round(g/x*100)<=10&&(s=`\uC800\uC7A5\uC18C\uAC00 ${Math.round(g/x*100)}% \uB0A8\uC558\uC2B5\uB2C8\uB2E4.`)}return s};return W(async()=>{try{z.loading.show(),await Q(),await H()}catch{D("\uB370\uC774\uD130 \uCD08\uAE30\uD654 \uC624\uB958","\uC7A0\uC2DC\uD6C4\uC5D0 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694.")}finally{z.loading.hide()}}),(l,v)=>(m(!0),h(T,null,L(w(fe),(s,x)=>(m(),Z(ve,{key:x,"header-class":"bg-grey-1"},{header:n(()=>[t(I,{avatar:""},{default:n(()=>[t(f,{color:s.connected?"primary":"red-10",name:"location_on",size:"md"},null,8,["color"])]),_:2},1024),t(I,null,{default:n(()=>[t(B,null,{default:n(()=>[a("div",null,[p(d(s.name)+" ",1),o(s.deviceId)?(m(),Z(f,{key:0,class:"q-ml-sm cursor-pointer",color:"grey",name:"refresh",onClick:j(g=>_(s),["prevent","stop"])},{default:n(()=>[t(F,null,{default:n(()=>[p("\uC804\uCCB4 \uAC31\uC2E0")]),_:1})]),_:2},1032,["onClick"])):A("",!0)])]),_:2},1024),t(B,{caption:""},{default:n(()=>[p(d(s.ipaddress),1)]),_:2},1024)]),_:2},1024),t(I,{side:""},{default:n(()=>[a("div",Me,d(y(s)),1),r(s.ZoneStatus)?(m(),h("div",Ue,[p(d(r(s.ZoneStatus))+" ",1),Ee,t(f,{class:"cursor-pointer",name:"cancel",size:"xs",color:"red-10",onClick:j(g=>w(C)(s),["prevent","stop"])},{default:n(()=>[t(F,null,{default:n(()=>[p("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])])):A("",!0)]),_:2},1024)]),default:n(()=>[a("div",Oe,[(m(!0),h(T,null,L(s.ZoneStatus,(g,$)=>(m(),h("div",{key:$},[t(Ae,{zone:g,device:s},null,8,["zone","device"])]))),128))])]),_:2},1024))),128))}};var Je=J(Re,[["__scopeId","data-v-c18dfba6"]]);export{Je as B};

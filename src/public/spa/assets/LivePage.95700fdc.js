import{b2 as ce,y as l,z as h,A as a,B as t,j as e,R as c,C as f,aQ as de,D as q,H as u,K as S,b5 as ue,aS as L,aR as O,r as k,o as U,bX as R,O as Z,P,b4 as me,J as p,bY as _e,F as D,b3 as N,bZ as B,aY as F,L as j,S as oe,b_ as le,N as ne,b6 as E,b7 as G,h as M,a6 as pe,b$ as fe,c0 as ve,c1 as Y,c2 as ge,bl as ye,v as ie,k as he,c as W,aT as H,V as J,aU as ee,aV as te,W as V,X as se,I as ae,aW as we,aX as xe,c3 as be,a4 as ke,a0 as qe}from"./index.3535e791.js";import{Q as Ce,a as Pe}from"./QTree.1d5ea6e1.js";import{Q as $e}from"./QPage.0ec50633.js";import{Q as Se,_ as ze,a as Qe,D as Ie,b as Me}from"./DialogTtsVoiceware.cea82b83.js";import{Q as A}from"./QTooltip.0f044c76.js";import{Q as K}from"./QBadge.dfd8839f.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{u as je}from"./usePlayer.ebe93981.js";import"./QSlideTransition.df74d3f7.js";import"./QTable.4b2e221f.js";import"./QExpansionItem.e093cf34.js";import"./QTr.5eb54d59.js";import"./useFiles.21deda8c.js";import"./QCircularProgress.944eb9ff.js";import"./QBanner.228cd6cc.js";const Te={class:"row fit items-center q-gutter-x-sm"},Ve={style:{"font-size":"1rem","font-weight":"500"}},De={class:"text-grey-8"},Ne={class:"row items-center q-gutter-x-sm text-grey-7"},Be={__name:"statusTree",setup(r){const{fnBroadcastCancel:m}=ce(),_=v=>{let g=0;for(let o=0;o<v.length;o++)v[o].Active&&(g+=1);return g};return(v,g)=>(l(),h(Ce,{class:"custom-q-tree",nodes:q(ue),"node-key":"_id","children-key":"ZoneStatus","no-node-label":"\uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},{"header-root":a(o=>[t("div",Te,[e(c,{color:o.node.connected?"primary":"red-10",name:"location_on",size:"sm"},null,8,["color"]),t("div",Ve,f(o.node.name),1),e(Se),t("div",De,f(_(o.node.ZoneStatus))+"\uAC1C \uC9C0\uC5ED \uBC29\uC1A1\uC911 ",1),_(o.node.ZoneStatus)?(l(),h(c,{key:0,class:"cursor-pointer",name:"cancel",color:"red-10",onClick:de(s=>q(m)(o.node),["prevent","stop"])},{default:a(()=>[e(A,null,{default:a(()=>[u("\uBC29\uC1A1\uCDE8\uC18C")]),_:1})]),_:2},1032,["onClick"])):S("",!0)])]),"default-header":a(o=>[t("div",Ne,[t("div",null,[u(f(o.node.name?o.node.name:"no name")+" ",1),o.node.Active?(l(),h(K,{key:0,color:"green"},{default:a(()=>[u(" ONAIR ")]),_:1})):S("",!0)])])]),_:1},8,["nodes"]))}};const re=r=>(E("data-v-0d127fe6"),r=r(),G(),r),Ae={class:"q-dialog-plugin bg-trans broadcast-popup"},Le={key:0},Re={class:"row justify-center q-pt-md text-grey"},Oe={class:"fit column q-gutter-y-sm",style:{width:"50%"}},Ue={style:{"text-align":"right"}},Ze=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uBAA8\uB4DC",-1)),Fe={style:{"text-align":"right"}},Ee=re(()=>t("div",{class:"name"},"\uBC29\uC1A1\uAD6C\uAC04",-1)),Ge={class:"fit row justify-end"},Ke={class:"fit row no-wrap justify-center items-center q-mb-md q-gutter-x-sm"},Xe={__name:"DialogPageLive",props:["live"],emits:[...L.emits],setup(r,{emit:m}){const _=r,{dialogRef:v,onDialogCancel:g,onDialogOK:o}=L(),{fnNotiError:s}=O(),y=k(!1),w=k(!1),x=k(0);let b=null;const C=k(""),z=k(!1),I=async()=>{z.value=!0,w.value=!0,R();try{C.value=await le(_.live)}catch(n){if(w.value=!1,n==="active"&&_.live.Priority!==1)return s("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),g()}w.value=!1,b=setInterval(()=>{x.value++,x.value>_.live.MaxPageTime&&(clearInterval(b),o())},1e3),y.value=!0},d=async()=>{if(C.value)try{await ne.get("/broadcast/stop",{params:{idx:C.value}})}catch(n){console.error(n)}y.value=!1,clearInterval(b),b=null,x.value=0,setTimeout(()=>{o()},1e3)};return U(()=>{z.value=!1,y.value=!1,R()}),(n,i)=>(l(),h(oe,{ref_key:"dialogRef",ref:v,persistent:""},{default:a(()=>[t("div",Ae,[e(c,{class:"floatingIcon cursor-pointer",name:"cancel",color:"red-13",size:"md",onClick:q(g)},{default:a(()=>[e(A,null,{default:a(()=>[u("Close")]),_:1})]),_:1},8,["onClick"]),e(Z,{class:"transBG"},{default:a(()=>[e(P,null,{default:a(()=>[t("div",{class:me(["q-pa-md row no-wrap text-grey-2",y.value?"justify-between":"justify-end"]),style:{height:"90%","min-height":"400px","font-family":"'NanumSquare'"}},[y.value?(l(),p("div",Le,[e(_e,{color:"primary",size:"14rem",thickness:8}),t("div",Re," \uBC29\uC1A1\uC911 "+f(x.value)+"\uCD08 \uACBD\uACFC ",1)])):S("",!0),t("div",Oe,[t("div",Ue,[Ze,t("div",null,f(r.live.Mode),1)]),t("div",Fe,[Ee,t("div",Ge,[(l(!0),p(D,null,N(r.live.zones,(Q,T)=>(l(),h(K,{key:T,class:"q-ml-xs"},{default:a(()=>[u(f(Q),1)]),_:2},1024))),128))])]),t("div",null,[(l(!0),p(D,null,N(q(B),(Q,T)=>(l(),p("div",{key:T,style:{"text-align":"right"}},f(q(B)[T]),1))),128))])])],2)]),_:1}),e(F,null,{default:a(()=>[t("div",Ke,[e(j,{style:{width:"10rem"},unelevated:"",color:"primary",onClick:I,disabled:z.value},{default:a(()=>[u("\uC2DC\uC791")]),_:1},8,["disabled"]),e(j,{style:{width:"10rem"},unelevated:"",color:"red-10",onClick:d,disabled:w.value},{default:a(()=>[u("\uC911\uC9C0")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var Ye=X(Xe,[["__scopeId","data-v-0d127fe6"]]);const We=[M("circle",{cx:"50",cy:"50",r:"48",fill:"none","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor"}),M("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"85",y2:"50.5"},[M("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"2s",repeatCount:"indefinite"})]),M("line",{"stroke-linecap":"round","stroke-width":"4","stroke-miterlimit":"10",stroke:"currentColor",x1:"50",y1:"50",x2:"49.5",y2:"74"},[M("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"15s",repeatCount:"indefinite"})])];var He=pe({name:"QSpinnerClock",props:fe,setup(r){const{cSize:m,classes:_}=ve(r);return()=>M("svg",{class:_.value,width:m.value,height:m.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},We)}});const Je=r=>(E("data-v-338e0629"),r=r(),G(),r),et={class:"q-dialog-plugin bg-trans broadcast-popup"},tt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},st=Je(()=>t("div",{class:"font-main text-grey-2"},"\uBA54\uC2DC\uC9C0 \uBC29\uC1A1",-1)),at={key:0,class:"text-grey-5 row no-wrap items-center q-gutter-x-sm q-px-md"},ot={style:{"font-size":"2rem"}},lt={class:"text-white description q-pa-md"},nt={class:"fit row no-wrap justify-center q-gutter-x-sm"},it={__name:"DialogPageMessage",props:["live"],setup(r){const m=r,_=new AbortController,{fnNotiError:v}=O(),{dialogRef:g,onDialogCancel:o,onDialogOK:s}=L(),y=k(3),w=k(!1);let x=null;const b=k(!1),C=k(!1),z=()=>{x&&clearInterval(x),_.abort(),o()},I=async()=>{try{y.value=0,clearInterval(x),b.value=!0,C.value=!0,await le(m.live),s()}catch(d){C.value=!1,d==="active"&&m.live.Priority!==1&&v("\uBC29\uC1A1 \uAD6C\uAC04\uC774 \uC911\uBCF5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uC120\uD0DD\uB41C \uBC29\uC1A1 \uAD6C\uAC04\uC5D0 \uC774\uBBF8 \uBC29\uC1A1\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4."),o()}};return U(async()=>{try{b.value=!1,C.value=!1,R(),Y({deviceId:"all",message:`\uD30C\uC77C \uC774\uB984: ${m.live.file.base}`}),await ge(m.live,_)}catch(d){console.error(d)}w.value=!0,Y({deviceId:"all",message:"\uBC29\uC1A1\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4."}),x=setInterval(async()=>{y.value>0?y.value-=1:(clearInterval(x),I())},1e3)}),(d,n)=>(l(),h(oe,{ref_key:"dialogRef",ref:g,persistent:""},{default:a(()=>[t("div",et,[e(Z,{class:"transBG"},{default:a(()=>[e(P,null,{default:a(()=>[t("div",tt,[e(c,{name:"mic",color:"primary",size:"md"}),st])]),_:1}),e(P,{style:{"min-height":"200px"}},{default:a(()=>[w.value?(l(),p("div",at,[e(He,{size:"md"}),t("span",ot,f(y.value),1)])):S("",!0),t("div",lt,[(l(!0),p(D,null,N(q(B),(i,Q)=>(l(),p("div",{key:Q},f(q(B)[Q]),1))),128))])]),_:1}),e(F,null,{default:a(()=>[t("div",nt,[w.value?(l(),h(j,{key:0,style:{width:"8rem"},color:"primary",disabled:b.value,onClick:n[0]||(n[0]=i=>I())},{default:a(()=>[u("\uC2DC\uC791")]),_:1},8,["disabled"])):S("",!0),e(j,{style:{width:"8rem"},color:"red-10",disabled:C.value,onClick:z},{default:a(()=>[u("\uCDE8\uC18C")]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},512))}};var rt=X(it,[["__scopeId","data-v-338e0629"]]);const $=r=>(E("data-v-e05a9df6"),r=r(),G(),r),ct={class:"q-pa-sm row justify-center"},dt={class:"row no-wrap items-center q-gutter-x-xs"},ut=$(()=>t("div",null,"\uBC29\uC1A1\uBAA8\uB4DC",-1)),mt={class:"row no-wrap items-center q-gutter-x-sm"},_t=$(()=>t("div",null,"\uC6B0\uC120\uC21C\uC704",-1)),pt={class:"row no-wrap justify-between items-center"},ft={class:"row no-wrap justify-start items-center q-gutter-x-sm"},vt=$(()=>t("div",null,"\uCC60\uC784",-1)),gt={class:"row no-wrap justify-between items-center"},yt={class:"row no-wrap items-center q-gutter-x-xs"},ht=$(()=>t("div",null,"\uBC29\uC1A1\uAD6C\uAC04",-1)),wt=$(()=>t("span",null," \uC120\uD0DD\uB41C \uBC29\uC1A1\uAD6C\uAC04\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),xt=[wt],bt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},kt=$(()=>t("div",null,"\uBC29\uC1A1\uC2DC\uAC04(\uBD84)",-1)),qt=$(()=>t("div",{class:"text-caption text-red",style:{"text-align":"right"}}," 0\uBD84\uC740 \uBC29\uC1A1\uC2DC\uAC04\uC774 \uBB34\uC81C\uD55C\uC785\uB2C8\uB2E4. ",-1)),Ct={class:"row no-wrap justify-between items-center"},Pt={class:"row no-wrap justify-start items-center q-gutter-x-sm"},$t=$(()=>t("div",null,"\uD30C\uC77C",-1)),St={key:0,class:"bg-grey-3 q-pa-sm q-gutter-x-sm row no-wrap justify-between items-center",style:{"border-radius":"2px","min-height":"40px"}},zt={key:1,class:"bg-grey-3 q-pa-sm row justify-start items-center",style:{"border-radius":"2px",height:"40px"}},Qt=$(()=>t("span",null," \uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ",-1)),It=[Qt],Mt={class:"row no-wrap justify-between items-center"},jt={class:"row no-wrap justify-between items-center q-gutter-x-xs"},Tt=$(()=>t("div",null,"TTS (Text to Speech)",-1)),Vt={class:"row no-wrap justify-between items-center"},Dt={key:0,class:"row no-wrap justify-between items-center q-gutter-x-sm"},Nt={class:"full-width q-px-sm q-mb-md"},Bt={__name:"pageLive",setup(r){const{fnPlayStart:m,fnPlayerStopClose:_}=je(),{fnNotiError:v}=O(),{fnDeleteFile:g}=ye(),o=ie(),s=he({Mode:"message",Preamble:"",Priority:3,MaxPageTime:60,Station:1,Preamble:"",file:null,devices:[],zones:[],retry:0,duration:0,MessageDelete:!0});k(!1);const y=W({get(){return s.MaxPageTime/60},set(d){s.MaxPageTime=d*60}}),w=()=>{o.dialog({component:ze,componentProps:{selected:s.devices}}).onOk(async d=>{s.devices=d,s.zones=await be(d)})},x=()=>{o.dialog({component:Qe,componentProps:{file:s.file}}).onOk(async d=>{s.file=d[0];const{data:n}=await ne.get("/files/duration",{params:{file:s.file.fullpath}});s.duration=n.duration})},b=()=>{ke.ttsMode==="sapi"?o.dialog({component:Ie,componentProps:{file:s.file}}).onOk(d=>{s.file=d}):o.dialog({component:Me,componentProps:{file:s.file}}).onOk(d=>{s.file=d}).onCancel(()=>{})},C=async()=>{await _(),await g(),s.file=null},z=W({get(){return s.Preamble==="Chime ascending triple.wav"},set(){return s.Preamble?s.Preamble="":s.Preamble="Chime ascending triple.wav"}}),I=()=>{if(s.devices===null||s.devices.length===0)return v("\uBC29\uC1A1\uAD6C\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");if(s.Mode!=="live"&&(s.file===null||Object.keys(s.file).length===0))return v("\uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");s.Mode==="live"?o.dialog({component:Ye,componentProps:{live:s}}):o.dialog({component:rt,componentProps:{live:s}})};return(d,n)=>(l(),p("div",ct,[e(Z,{flat:"",style:{width:"450px"}},{default:a(()=>[e(P,null,{default:a(()=>[t("div",dt,[e(c,{name:"podcasts",color:"primary",size:"sm"}),ut]),e(H,{modelValue:s.Mode,"onUpdate:modelValue":n[0]||(n[0]=i=>s.Mode=i),options:[{value:"tts",label:"TTS",icon:"record_voice_over"},{value:"live",label:"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",icon:"live_tv"},{value:"message",label:"\uBA54\uC2DC\uC9C0 \uC1A1\uCD9C",icon:"message"}],dense:"",filled:"","map-options":"","emit-value":""},{option:a(i=>[e(J,ee(te(i.itemProps)),{default:a(()=>[e(V,{avatar:""},{default:a(()=>[e(c,{name:i.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:a(()=>[e(se,null,{default:a(()=>[u(f(i.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),q(ae).em||q(ae).isAdmin?(l(),h(P,{key:0},{default:a(()=>[t("div",mt,[e(c,{name:"info",color:"lime-10",size:"sm"}),_t]),e(H,{modelValue:s.Priority,"onUpdate:modelValue":n[1]||(n[1]=i=>s.Priority=i),dense:"",filled:"",options:[{value:1,label:"\uAE34\uAE09\uBC29\uC1A1",icon:"priority_high"},{value:3,label:"\uC77C\uBC18\uBC29\uC1A1",icon:"low_priority"}],"emit-value":"","map-options":""},{option:a(i=>[e(J,ee(te(i.itemProps)),{default:a(()=>[e(V,{avatar:""},{default:a(()=>[e(c,{name:i.opt.icon},null,8,["name"])]),_:2},1024),e(V,null,{default:a(()=>[e(se,null,{default:a(()=>[u(f(i.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})):S("",!0),e(P,null,{default:a(()=>[t("div",pt,[t("div",ft,[e(c,{name:"notifications_none",color:"green-10",size:"sm"}),vt]),e(we,{modelValue:z.value,"onUpdate:modelValue":n[2]||(n[2]=i=>z.value=i)},null,8,["modelValue"])])]),_:1}),e(P,{class:"q-gutter-y-sm"},{default:a(()=>[t("div",gt,[t("div",yt,[e(c,{name:"location_on",color:"primary",size:"sm"}),ht]),e(c,{class:"cursor-pointer q-mr-xs",name:"add_circle",color:"primary",size:"sm",onClick:w},{default:a(()=>[e(A,null,{default:a(()=>[u("\uBC29\uC1A1\uAD6C\uAC04\uC120\uD0DD")]),_:1})]),_:1})]),s.zones&&s.zones.length?(l(),p("div",{key:0,class:"panel cursor-pointer q-py-sm q-px-sm q-gutter-x-sm row justify-start items-center",onClick:w},[(l(!0),p(D,null,N(s.zones,(i,Q)=>(l(),h(K,{key:Q},{default:a(()=>[u(f(i),1)]),_:2},1024))),128))])):(l(),p("div",{key:1,class:"panel cursor-pointer q-pa-sm row justify-start items-center",onClick:w},xt))]),_:1}),s.Mode==="live"?(l(),h(P,{key:1,class:"q-gutter-y-sm"},{default:a(()=>[t("div",bt,[e(c,{name:"timer",color:"pink-8",size:"sm"}),kt]),e(xe,{modelValue:y.value,"onUpdate:modelValue":n[3]||(n[3]=i=>y.value=i),type:"number",filled:"",dense:"",label:"\uBC29\uC1A1\uC2DC\uAC04\uC81C\uD55C",min:"0",max:"120"},null,8,["modelValue"]),qt]),_:1})):S("",!0),s.Mode==="message"?(l(),h(P,{key:2,class:"q-gutter-y-sm"},{default:a(()=>[t("div",Ct,[t("div",Pt,[e(c,{name:"save",color:"primary",size:"sm"}),$t]),e(c,{class:"cursor-pointer",name:"add_circle",color:"primary",size:"sm",onClick:x})]),s.file?(l(),p("div",St,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"xs",onClick:n[4]||(n[4]=i=>q(m)(s.file))}),u(" "+f(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:n[5]||(n[5]=i=>s.file=null)})])):(l(),p("div",zt,It))]),_:1})):S("",!0),s.Mode==="tts"?(l(),h(P,{key:3,class:"q-gutter-y-sm"},{default:a(()=>[t("div",Mt,[t("div",jt,[e(c,{name:"volume_up",color:"primary",size:"sm"}),Tt]),e(c,{class:"cursor-pointer",color:"primary",name:"mic",size:"sm",onClick:b},{default:a(()=>[e(A,null,{default:a(()=>[u("\uC74C\uC131\uD569\uC131")]),_:1})]),_:1})]),t("div",Vt,[s.file?(l(),p("div",Dt,[t("div",null,[e(c,{class:"cursor-pointer",name:"play_arrow",color:"primary",size:"sm",onClick:n[6]||(n[6]=i=>q(m)(s.file))}),u(" "+f(s.file.base),1)]),e(c,{class:"cursor-pointer q-mr-sm",name:"cancel",color:"red-10",size:"sm",onClick:C})])):(l(),p("div",{key:1,class:"bg-grey-3 q-pa-sm row justify-between items-center cursor-pointer",style:{"border-radius":"2px",height:"40px",width:"100%"},onClick:b},[t("div",null,[e(c,{name:"warning"}),u(" \uD569\uC131\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. ")])]))])]),_:1})):S("",!0),e(F,null,{default:a(()=>[t("div",Nt,[e(j,{class:"full-width",color:"primary",label:"\uBC29\uC1A1\uC2DC\uC791",onClick:I})])]),_:1})]),_:1})]))}};var At=X(Bt,[["__scopeId","data-v-e05a9df6"]]);const Lt={class:"borderd"},Rt={class:"q-px-lg q-py-sm row no-wrap justify-between items-center bg-grey-3"},Ot={class:"row no-wrap items-center q-gutter-x-sm q-py-xs"},Ut=t("div",{class:"font-main"},"\uC2E4\uC2DC\uAC04 \uBC29\uC1A1",-1),Zt={class:"q-pa-xs"},ns={__name:"LivePage",setup(r){const m=ie(),_=k(40);return U(async()=>{m.loading.show(),await qe(),m.loading.hide()}),(v,g)=>(l(),h($e,{class:"page"},{default:a(()=>[t("div",Lt,[t("div",Rt,[t("div",Ot,[e(c,{name:"mic",color:"primary",size:"md"}),Ut])]),t("div",null,[e(Pe,{modelValue:_.value,"onUpdate:modelValue":g[0]||(g[0]=o=>_.value=o)},{before:a(()=>[t("div",Zt,[e(Be)])]),after:a(()=>[e(At)]),_:1},8,["modelValue"])])])]),_:1}))}};export{ns as default};
